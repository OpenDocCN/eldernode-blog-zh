<html>
<head>
<title>4 Ways to enable remote desktop in windows 10 - Eldernode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在windows 10中启用远程桌面的4种方法- Eldernode</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/4-ways-to-enable-remote-desktop/#0001-01-01">https://blog.eldernode.com/4-ways-to-enable-remote-desktop/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/0310a179de3cc9ecf57ad8eccb9e1aba.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="4 Ways to enable remote desktop in windows 10" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/06/4-Ways-to-enable-remote-desktop-in-windows-10.png"/><p>您肯定处于这样一种情况:您需要在一台计算机上检查、安装软件、支持和各种服务，而该系统离您很远，甚至可能在另一个城市。因此，您没有对它的物理访问权。在这篇文章中，我们想向您介绍在windows 10中启用远程桌面的4种方法，其中包括<strong>组策略</strong>、<strong> PowerShell </strong>、<strong>T5、 </strong>等等。</p><p>即使是Windows操作系统中最专家和所谓的极客，有时也需要到远程桌面系统进行管理。作为专业使用Windows操作系统的人，您肯定知道可以通过系统属性在Windows中启用远程桌面。事实上，这是最简单和最容易的方法。但是，如果您想在远程桌面网络上运行远程系统，您必须首先在该系统上启用远程桌面，因为出于安全原因，默认情况下在Windows中禁用此功能。在Eldernode市场上有几个<a href="https://eldernode.com/buy-rdp/"> RDP管理服务器</a>服务。你可以选择其中一个计划。</p><h2><span class="ez-toc-section" id="4_Ways_to_enable_remote_desktop_in_windows_10"/>在windows 10中启用远程桌面的4种方式<span class="ez-toc-section-end"/></h2><p>远程桌面功能是Windows的功能特性之一。远程桌面的目的是使人们能够远程连接到其他计算机。如果你是Windows 10用户，想使用这个功能，就加入我们吧。要学习Windows 10中的远程桌面，您需要对电脑设置进行更改。这里有四种方法允许您的计算机接受此连接。</p><h3><span class="ez-toc-section" id="1_Enable_Remote_Desktop_via_Group_Policy_Object_or_GPO"/> 1。通过组策略对象或GPO启用远程桌面<span class="ez-toc-section-end"/></h3><p>为此，请打开组策略管理控制台并转到以下路径:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt;Remote Desktop Services &gt; Remote Desktop Session Host &gt; Connections  </code></pre><p>双击<strong>允许用户使用远程桌面服务</strong>远程连接并启用它。</p><p>现在，您需要指定可以访问远程桌面远程系统的IP地址范围。</p><p>首先转到以下路径:</p><p> </p><pre class="brush: text; toolbar: false;"><code class="language-bash">Computer Configuration &gt; Policies &gt; Administrative Templates &gt; Network &gt; Network Connections &gt; Windows Firewall &gt; Domain Profile  </code></pre><p>双击<strong> Windows防火墙:允许入站远程桌面例外</strong> <span> <span>策略</span> </span>并启用。然后在IP范围框中输入所需的IP地址。</p><p> </p><h3><span class="ez-toc-section" id="2_Activate_Remote_Desktop_via_PowerShell"/> 2。通过PowerShell激活远程桌面<span class="ez-toc-section-end"/></h3><p>通过PowerShell激活远程桌面有点困难。</p><p>首先，<strong> PowerShell Remoting </strong>必须在目标系统上启用，以便能够通过<strong> PowerShell </strong>管理客户端和服务器系统。我们假设PowerShell远程处理在目标系统上是活动的。现在，您可以通过执行以下命令在目标系统上激活远程桌面:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Invoke-Command -Computername  -ScriptBlock {Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" –Value 0 }  </code></pre><p>您需要输入目标计算机名，而不是<strong>计算机名</strong>。我们使用了<strong>调用命令</strong>来使用<strong>设置项目属性</strong>命令。该命令将注册表项<strong> fDenyTSConnections </strong>的值更改为零。</p><p>最有可能的是，<a href="https://eldernode.com/open-a-port-on-a-windows-firewall/"> Windows防火墙</a>将阻止<strong> RDP流量</strong>，因此您必须使用以下命令来允许RDP流量进入目标系统:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Invoke-Command -Computername  -ScriptBlock {Enable-NetFirewallRule -DisplayGroup "Remote Desktop"}  </code></pre><h3><span class="ez-toc-section" id="3_Enable_Remote_Desktop_via_WMI"/> 3。通过WMI启用远程桌面<span class="ez-toc-section-end"/></h3><p>如果目标系统上没有启用PowerShell Remoting，您仍然可以通过WMI 使用<strong> PowerShell。当您希望在大量客户端上启用RDP时，此方法会很有用。使用以下脚本，您可以在目标系统上管理PowerShell远程处理，而无需激活它。</strong></p><pre class="brush: text; toolbar: false;"><code class="language-bash">[cmdletbinding()]  param(      [parameter(ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)]      [string[]]$ComputerName = $env:computername,      [ValidateScript({Test-Path $_})]      [string]$OutFolder = "c:\"  )     begin {  $SuccessComps = Join-Path $OutFolder "Successcomps.txt"  $FailedComps = Join-Path $OutFolder "FailedComps.txt"  }     process {      foreach($Computer in $ComputerName) {             try {              $RDP = Get-WmiObject -Class Win32_TerminalServiceSetting `                                  -Namespace root\CIMV2\TerminalServices `                                  -Computer $Computer `                                  -Authentication 6 `                                  -ErrorAction Stop                                            } catch {              Write-Host "$Computer : WMIQueryFailed"              "$Computer : WMIQueryFailed" | Out-File -FilePath $FailedComps -Append              continue          }                    if($RDP.AllowTSConnections -eq 1) {              Write-Host "$Computer : RDP Already Enabled"              "$Computer : RDP Already Enabled" | Out-File -FilePath $SuccessComps -Append              continue          } else {              try {                  $result = $RDP.SetAllowTsConnections(1,1)                  if($result.ReturnValue -eq 0) {                      Write-Host "$Computer : Enabled RDP Successfully"                      "$Computer : RDP Enabled Successfully" | Out-File -FilePath $SuccessComps -Append                  } else {                      Write-Host "$Computer : Failed to enabled RDP"                      "$Computer : Failed to enable RDP" | Out-File -FilePath $FailedComps -Append                     }                            } catch {                  Write-Host "$computer : Failed to enabled RDP"                  "$Computer : Failed to enable RDP" | Out-File -FilePath $FailedComps -Append              }          }      }     }     end {}  </code></pre><p>将该脚本保存在后缀为<strong> ps1 </strong>的文件中。</p><p><em> <strong>例如</strong> </em>，我们将这个文件命名为Enable-RDPAccess.ps1 .现在运行以下命令:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">.\Enable-RDPAccess.ps1 -ComputerName   </code></pre><p>您需要输入目标计算机名，而不是<strong>计算机名</strong>。如果要在大量客户端系统上启用RDP，请将系统的计算机名称保存在文本文件中，并运行以下命令:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Get-Content  | Enable-RDPAccess.ps1  </code></pre><p>通过执行以下命令，您还可以<strong>允许RDP流量</strong>进入目标系统:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">wmic /node: process call create "cmd.exe /c netsh firewall set service RemoteDesktop enable"  </code></pre><p>您也可以使用<strong> wmic工具</strong>在客户端 <span> : </span>上启用远程桌面<strong/></p><pre class="brush: text; toolbar: false;"><code class="language-bash">wmic /node: process call create 'cmd.exe /c reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f'  </code></pre><p>请注意，在远程系统的防火墙设置中，您必须允许<strong> WMI流量</strong>进入。您可以使用组策略来做到这一点。要在<strong>组策略</strong>中执行此操作，请转到以下路径:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Windows Firewall with Advanced Security  </code></pre><p>右键点击<strong>入站规则</strong>，选择<strong>预定义</strong>，从<strong>下拉菜单</strong>中选择<strong> Windows管理规范</strong>或<strong> WMI </strong>。</p><h3><span class="ez-toc-section" id="4_Activate_Remote_Desktop_via_PsExec"/> 4。通过PsExec <span class="ez-toc-section-end"/>激活远程桌面</h3><p>另一个可以用来在客户端系统上启用远程桌面的选项是使用免费的<strong> PsExec工具</strong> <span>。</span>使用该工具不需要在远程系统上激活<strong> PowerShell Remoting </strong>。这个工具唯一的缺点是不像PowerShell中的<strong> Invoke-Command </strong>那么容易使用。要使用PsExec，远程系统中的文件和打印机共享必须对入站开放。这可能比WMI端口或PowerShell Remoting更开放。如果它未激活，您可以从以下路径在组策略中激活它:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">Computer Configuration &gt; Policies &gt; Administrative Templates &gt; Network &gt; Network Connections &gt; Windows Firewall &gt; Domain Profile &gt; Windows Firewall: Allow inbound file and printer sharing exception  </code></pre><p>现在转到<strong>psexec.exe</strong>工具所在的文件夹，然后在命令提示符下运行以下命令:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">psexec.exe \\ reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f  </code></pre><p>使用以下命令，您必须允许<a href="https://eldernode.com/buy-rdp/"> RDP </a>流量进入目标系统:</p><pre class="brush: text; toolbar: false;"><code class="language-bash">psexec.exe \\ netsh firewall set service RemoteDesktop enable  </code></pre><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>RDP协议允许用户远程访问桌面和其中的应用程序。事实上，您可以远程访问远程桌面组织内的服务器，并使用其中的应用程序。在本文中，我们教你如何在Windows 10中用4种方法激活远程桌面，分别是GPO、PowerShell、WMI和PsExec。</p></div></div>    
</body>
</html>