<html>
<head>
<title>How To Install The Apache Web Server On Ubuntu 20.04 - Eldernode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu 20.04 - Eldernode上安装Apache Web服务器</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/apache-web-server-ubuntu-20/#0001-01-01">https://blog.eldernode.com/apache-web-server-ubuntu-20/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/6e2abebe1a916f89831e9cd41e2d6265.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to install the Apache Web Server on Ubuntu 20.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2070.png"/><p>教程如何在Ubuntu 20.04上安装Apache Web服务器。Apache HTTP服务器是世界上使用最广泛的web服务器。它提供了许多强大的功能，包括可动态加载的模块、强大的媒体支持以及与其他流行软件的广泛集成。不要浪费时间，买你自己的<a href="https://eldernode.com/ubuntu-vps/" target="_blank" rel="noopener noreferrer"> Ubuntu Vps </a>来进行一次真正的安装。</p><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p/><h2><span class="ez-toc-section" id="How_To_Install_The_Apache_Web_Server_On_Ubuntu_2004"/>如何在Ubuntu 20.04上安装Apache Web服务器<span class="ez-toc-section-end"/></h2><p>如果你正确地遵循这个指南的步骤，学习如何在<a href="https://eldernode.com/how-to-install-lamp-on-ubuntu-20-04/" target="_blank" rel="noopener noreferrer"> <strong> Ubuntu 20.04 </strong> </a>上安装<strong> Apache Web服务器</strong>会很容易。</p><h3 id="step-1-—-installing-apache"><span class="ez-toc-section" id="1-_How_To_Install_Apache"/> <span> 1-如何安装Apache </span> <span class="ez-toc-section-end"/></h3><p>虽然Apache在<a href="https://blog.eldernode.com/tag/linux/" target="_blank" rel="noopener noreferrer"> Linux </a> Ubuntu的默认软件仓库中可用，但您可以从更新本地包索引开始，以反映最新的上游变化。使得使用传统的<a href="https://en.wikipedia.org/wiki/List_of_software_package_management_systems" target="_blank" rel="noopener noreferrer">包管理</a>工具来安装它成为可能。</p><pre><code class="language-bash">sudo apt update</code></pre><p>然后安装<span> apache2 </span>包:</p><pre><code class="language-bash">sudo apt install apache2</code></pre><h3 id="step-2-—-adjusting-the-firewall"><span class="ez-toc-section" id="2-_How_To_Adjust_The_Firewall"/> <span> 2-如何调整防火墙</span> <span class="ez-toc-section-end"/></h3><p>在这一步中，在测试Apache之前，有必要修改防火墙设置，以允许外部访问默认的web端口。假设您遵循了先决条件中的说明，那么您应该配置一个UFW防火墙来限制对您的服务器的访问。</p><p>注意，在安装过程中，Apache向UFW注册，以提供一些应用程序配置文件，这些文件可用于启用或禁用通过防火墙对Apache的访问。</p><p>要列出<span> ufw </span>应用配置文件，请运行以下命令:</p><pre><code class="language-bash">sudo ufw app list</code></pre><p title="Output"><span>输出</span></p><pre><code class="language-bash">Available applications:    Apache    Apache Full    Apache Secure    OpenSSH    </code></pre><p>从输出可以清楚地看出，Apache有三个可用的概要文件:</p><ul><li><span> <strong> Apache </strong> </span>:此配置文件仅打开端口80(正常、未加密的web流量)</li><li><span> <strong> Apache Full </strong> </span>:此配置文件同时打开端口80(正常的未加密web流量)和端口443 (TLS/SSL加密流量)</li><li><span> <strong> Apache Secure </strong> </span>:此配置文件仅打开端口443 (TLS/SSL加密流量)</li></ul><p><strong> <span>注意</span> </strong>:另外，建议您启用最严格的配置文件，该文件仍将允许您配置的流量。由于我们还没有在本指南中为我们的服务器配置SSL，我们只需要允许端口80上的流量:</p><pre><code class="language-bash">sudo ufw allow 'Apache'</code></pre><p>接下来，使用以下命令验证更改。</p><pre><code class="language-bash">sudo ufw status</code></pre><p title="Output"><span>输出</span></p><pre><code class="language-bash">Status: active    To                         Action      From  --                         ------      ----  OpenSSH                    ALLOW       Anywhere                    <span>Apache                     ALLOW       Anywhere                  OpenSSH (v6)               ALLOW       Anywhere (v6)               Apache (v6)                ALLOW       Anywhere (v6)</span></code></pre><p><span class="ez-toc-section" id="3-_How_To_Check_Your_Web_Server"/> 3-如何检查您的网络服务器<span class="ez-toc-section-end"/></p><h3 id="step-3-—-checking-your-web-server">安装过程结束时，Ubuntu 20.04会启动Apache。web服务器应该已经启动并运行。</h3><p>您可以通过键入以下命令来确保服务正在运行:</p><p><span>输出</span></p><pre><code class="language-bash">sudo systemctl status apache2</code></pre><p title="Output">由于此输出确认，服务已成功启动。然而，测试这一点的最好方法是从Apache请求一个页面。</p><pre><code class="language-bash">● apache2.service - The Apache HTTP Server       Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled)       Active: active (running) since Thu 2020-04-23 22:36:30 UTC; 20h ago         Docs: https://httpd.apache.org/docs/2.4/     Main PID: 29435 (apache2)        Tasks: 55 (limit: 1137)       Memory: 8.0M       CGroup: /system.slice/apache2.service               ├─29435 /usr/sbin/apache2 -k start               ├─29437 /usr/sbin/apache2 -k start               └─29438 /usr/sbin/apache2 -k start    </code></pre><p>您可以通过您的IP地址访问默认的Apache登录页面，以确认软件运行正常。如果您不知道您的服务器的IP地址，您可以从命令行以几种不同的方式获得它。</p><p>在服务器的命令提示符下键入以下内容:</p><p>您将得到几个用空格分隔的地址。您可以在web浏览器中尝试每一种方法，以确定它们是否有效。</p><pre><code class="language-bash">hostname -I</code></pre><p>另一种选择是使用Icanhazip工具，该工具会提供从互联网上的另一个位置读取的公共ip地址:</p><p>在浏览器的地址栏中输入服务器的IP地址:</p><pre><code class="language-bash">url -4 icanhazip.com</code></pre><p>然后你会看到默认的Ubuntu 20.04 Apache网页:</p><pre><code class="language-bash">http://<span>your_server_ip</span></code></pre><p><img data-lazyloaded="1" src="../Images/36d0e408fb8a7b5b1cc1235014663131.png" decoding="async" loading="lazy" class="aligncenter wp-image-10818 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/small_apache_default.jpg" alt="Apache ubuntu default page" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/small_apache_default.jpg 745w, https://blog.eldernode.com/wp-content/uploads/2020/08/small_apache_default-216x300.jpg 216w, https://blog.eldernode.com/wp-content/uploads/2020/08/small_apache_default-738x1024.jpg 738w" data-sizes="(max-width: 745px) 100vw, 745px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/small_apache_default.jpg"/></p><p> </p><p>一旦看到这个页面，就意味着Apache工作正常。它还包括一些关于重要的Apache文件和目录位置的基本信息。</p><p>Once you can see this page, it means that Apache is working correctly. It also includes some basic information about important Apache files and directory locations.</p><h3><span class="ez-toc-section" id="4-_How_To_Manage_The_Apache_Process"/> <span> 4-如何管理Apache进程</span> <span class="ez-toc-section-end"/></h3><h3 id="step-4-—-managing-the-apache-process">您已经准备好学习一些基本的管理命令，因为web服务器已经启动并正在运行。</h3><p>要停止您的web服务器:</p><p>通过运行下面的命令，在web服务器停止时启动它。</p><pre><code class="language-bash">sudo systemctl stop apache2</code></pre><p>使用以下命令停止并再次启动该服务。</p><pre><code class="language-bash">sudo systemctl start apache2</code></pre><p>如果只是简单地修改配置，Apache通常可以在不中断连接的情况下重新加载。</p><pre><code class="language-bash">sudo systemctl restart apache2</code></pre><p>为此，请使用以下命令:</p><p>默认情况下，Apache被配置为在服务器启动时自动启动。如果这不是您想要的，请通过键入以下命令禁用此行为:</p><pre><code class="language-bash">sudo systemctl reload apache2</code></pre><p>键入以下命令以重新启用该服务，使其在引导时启动。</p><pre><code class="language-bash">sudo systemctl disable apache2</code></pre><p>Type the command below to re-enable the service to start up at boot.</p><pre><code class="language-bash">sudo systemctl enable apache2</code></pre><h3><span class="ez-toc-section" id="5-_How_To_Set_Up_Virtual_Hosts_Recommended"/> <span> 5-如何设置虚拟主机(推荐)</span> <span class="ez-toc-section-end"/></h3><h3 id="step-5-—-setting-up-virtual-hosts-recommended">当使用Apache web服务器时，您可以使用虚拟主机来封装配置细节，并从单个服务器托管多个域。你将建立一个名为<strong> your_domain </strong>的域名，但是你应该<strong>用你自己的域名</strong>替换它。</h3><p>Ubuntu 20.04上的Apache有一个默认启用的服务器块，它被配置为提供来自<span> /var/www/html </span>目录的文档。虽然这对于单个站点来说效果很好，但是如果你托管多个站点的话，这可能会变得很笨拙。让我们不要修改<span> /var/www/html </span>，而是在<span> /var/www </span>中为<strong> your_domain </strong>站点创建一个目录结构，保留<span> /var/www/html </span>作为缺省目录，以便在客户端请求与任何其他站点不匹配时提供服务。</p><p>为<strong> your_domain: </strong>创建目录</p><p>现在，使用<span> $USER </span>环境变量分配目录的所有权:</p><pre><code class="language-bash">sudo mkdir /var/www/<span class="highlight">your_domain</span></code></pre><p>如果您没有修改设置默认文件权限的umask值，那么您的web根目录的权限应该是正确的。为了确保您的权限是正确的，并允许所有者读取、写入和执行文件，同时只授予组和其他人读取和执行权限，您可以输入以下命令:</p><pre><code class="language-bash">sudo chown -R $USER:$USER /var/www/<span class="highlight">your_domain</span></code></pre><p>然后，使用<span> nano </span>或您喜欢的编辑器创建一个示例<span>index.html</span>页面:</p><pre><code class="language-bash">sudo chmod -R 755 /var/www/<span class="highlight">your_domain</span></code></pre><p>在内部，添加以下示例HTML:</p><pre><code class="language-bash">sudo nano /var/www/<span class="highlight">your_domain</span>/index.html</code></pre><p><span>/var/www/your _ domain/index . html</span></p><p class="code-label" title="/var/www/your_domain/index.html">您现在可以保存并关闭文件。</p><pre><code class="language-bash">&lt;html&gt;      &lt;head&gt;          &lt;title&gt;Welcome to <span>Your_domain</span>!&lt;/title&gt;      &lt;/head&gt;      &lt;body&gt;          &lt;h1&gt;Success!  The <span>your_domain</span> virtual host is working!&lt;/h1&gt;      &lt;/body&gt;  &lt;/html&gt;</code></pre><p>为了让Apache提供这些内容，有必要用正确的指令创建一个虚拟主机文件。与其直接修改位于<span><strong>/etc/Apache 2/sites-available/000-default . conf</strong></span>的默认配置文件，不如在<strong/><span><strong><span>/etc/Apache 2/sites-available</span>/</strong><span>your _ domain<strong>新建一个。conf </strong> </span> </span> <span> : </span></p><p>粘贴以下配置块，该配置块与默认配置块相似，但针对我们的新目录和域名进行了更新:</p><pre><code class="language-bash">sudo nano /etc/apache2/sites-available/<span class="highlight">your_domain</span>.conf</code></pre><p><span>/etc/Apache 2/sites-available/your _ domain . conf</span></p><p class="code-label" title="/etc/apache2/sites-available/your_domain.conf"><strong>注意</strong>:您已经将<strong>文档根目录</strong>更新到我们的新目录，将<strong>服务器管理员</strong>更新到一个<strong> your_domain </strong>站点管理员可以访问的电子邮件。我们还添加了两个指令:<span> <strong> ServerName </strong> </span>，它为这个虚拟主机定义建立了应该匹配的基本域，以及<span> <strong> ServerAlias </strong> </span>，它定义了应该匹配的更多名称，就像它们是基本名称一样。</p><div><pre><code class="language-bash">&lt;VirtualHost *:80&gt;      ServerAdmin <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="681f0d0a05091b1c0d1a2804070b090400071b1c">[email protected]</a>      ServerName <span>your_domain      ServerAlias www.your_domain      DocumentRoot /var/www/your_domain</span>      ErrorLog ${APACHE_LOG_DIR}/error.log      CustomLog ${APACHE_LOG_DIR}/access.log combined  &lt;/VirtualHost&gt;</code></pre></div><p>您现在可以保存并关闭文件。</p><p>使用以下命令通过<span> <strong> a2ensite </strong> </span>工具启用文件:</p><p>禁用<span> <strong> 000-default.conf </strong> </span>中定义的默认站点:</p><pre><code class="language-bash">sudo a2ensite <span class="highlight">your_domain</span>.conf</code></pre><p>并测试配置错误:</p><pre><code class="language-bash">sudo a2dissite 000-default.conf</code></pre><p><span>输出</span></p><pre><code class="language-bash">sudo apache2ctl configtest</code></pre><p title="Output">接下来，重新启动Apache来实现您的更改:</p><pre><code class="language-bash">Syntax OK</code></pre><p>到目前为止，Apache应该已经在为你的域名服务了。您可以通过导航到<span><strong>http://your _ domain</strong></span>来测试这一点，您应该会看到类似这样的内容:</p><pre><code class="language-bash">sudo systemctl restart apache2</code></pre><p><img data-lazyloaded="1" src="../Images/a3b4d39178e3dbce2e6624bdef21f985.png" decoding="async" loading="lazy" class="aligncenter wp-image-10819 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/vhost_your_domain.jpg" alt="The vhost of your domain" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/vhost_your_domain.jpg 795w, https://blog.eldernode.com/wp-content/uploads/2020/08/vhost_your_domain-300x21.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/vhost_your_domain-768x54.jpg 768w" data-sizes="(max-width: 795px) 100vw, 795px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/vhost_your_domain.jpg"/></p><p> </p><p><span class="ez-toc-section" id="6-_How_To_Get_Familiar_With_Important_Apache_Files_And_Directories"/> <span> 6-如何熟悉重要的Apache文件和目录</span> <span class="ez-toc-section-end"/></p><h3 id="step-6-–-getting-familiar-with-important-apache-files-and-directories">至此，您已经知道如何管理Apache服务本身，所以应该花几分钟时间熟悉一些重要的目录和文件。</h3><p><span class="ez-toc-section" id="Content"/> <span>内容</span> <span class="ez-toc-section-end"/></p><h3 id="content"><span> /var/www/html </span>:实际的web内容，默认情况下只包含您之前看到的默认Apache页面，从<span> /var/www/html </span>目录提供。这可以通过修改Apache配置文件来改变。</h3><ul><li><span class="ez-toc-section" id="Server_Configuration"/> <span>服务器配置</span> <span class="ez-toc-section-end"/></li></ul><h3 id="server-configuration"><span><span>/</span><strong><span>etc/Apache 2</span></strong></span>:Apache配置目录。所有的Apache配置文件都在这里。</h3><ul><li><span><strong>/etc/apache 2/Apache 2 . conf</strong></span>:主Apache配置文件。可以对其进行修改，以更改Apache全局配置。这个文件负责加载配置目录中的许多其他文件。</li><li><span><strong>/etc/apache 2/ports . conf</strong></span>:这个文件指定了Apache将要监听的端口。默认情况下，Apache监听端口80，当启用了提供SSL功能的模块时，还会监听端口443。</li><li><strong><span>/etc/Apache 2/sites-available/</span></strong>:可以存放每个站点虚拟主机的目录。Apache不会使用在这个目录中找到的配置文件，除非它们被链接到<span> <span> <strong>站点启用的</strong> </span> </span>目录。通常，所有服务器块配置都在该目录中完成，然后通过使用<span> <strong> a2ensite </strong> </span>命令链接到另一个目录来启用。</li><li><strong><span>/etc/Apache 2/sites-enabled/</span></strong>:存放已启用的每站点虚拟主机的目录。通常情况下，它们是通过链接到<span> <strong>站点可用</strong> </span>目录中的配置文件来创建的，带有<span> <strong> a2ensite </strong> </span>。Apache在启动或重新加载以编译一个完整的配置时，会读取这个目录中的配置文件和链接。</li><li><span><strong>/etc/Apache 2/conf-available/</strong></span>、<span><span><strong>/etc/Apache 2/conf-enabled/</strong></span></span>:这些目录与<span><strong>sites-available</strong></span>和<span><strong>sites-enabled</strong></span>目录的关系相同，但用于存储不属于虚拟主机的配置片段。<strong><span>conf-available</span></strong>目录下的文件可以用<span> <strong> a2enconf </strong> </span>命令启用，用<span> <strong> a2disconf </strong> </span>命令禁用。</li><li><span><strong>/etc/Apache 2/MODS-available/、/etc/Apache 2/MODS-enabled/</strong></span>:这些目录分别包含可用和启用的模块。文件以<span>结尾<strong>。load </strong> </span>包含加载特定模块的片段，而文件以<span>结尾。conf </span>包含这些模块的配置。可以使用<strong> <span> a2enmod </span> </strong>和<span> <strong> a2dismod </strong> </span>命令启用和禁用模块</li><li><span class="ez-toc-section" id="Server_Logs"/> <span>服务器日志</span> <span class="ez-toc-section-end"/></li></ul><h3 id="server-logs"><strong>/var/log/apache 2/access . log</strong>:默认情况下，对web服务器的每个请求都记录在这个日志文件中，除非Apache被配置为不这样做。</h3><ul><li><strong>/var/log/Apache 2/error . log</strong>:默认情况下，所有错误都记录在这个文件中。Apache配置中的<span> <strong> LogLevel </strong> </span>指令指定了错误日志将包含多少细节。</li><li> </li></ul><p> </p><p><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></p><h2>在本文中，您了解了如何在Ubuntu 20.04上安装Apache Web服务器。既然您已经安装了web服务器，那么您就有了许多选择，包括可以提供的内容类型和可以用来创建更丰富体验的技术。如果你对这个主题感兴趣，可以找到更多关于<a href="https://blog.eldernode.com/install-apache-web-server-debian/" target="_blank" rel="noopener noreferrer">如何在Debian 10 </a> <strong>上安装Apache Web Server和</strong> <a href="https://blog.eldernode.com/install-wordpress-apache-ubuntu-20/" target="_blank" rel="noopener noreferrer">如何在Ubuntu 20.04 </a>上安装带有Apache的WordPress的文章。</h2><p>In this article, you learned How To Install The Apache Web Server On Ubuntu 20.04. Now that you have your web server installed, you have many options for the type of content you can serve and the technologies you can use to create a richer experience. In case you are interested in this subject, find more articles on <a href="https://blog.eldernode.com/install-apache-web-server-debian/" target="_blank" rel="noopener noreferrer">How to install Apache Web Server on Debian 10</a> <strong>AND</strong> <a href="https://blog.eldernode.com/install-wordpress-apache-ubuntu-20/" target="_blank" rel="noopener noreferrer">How to install WordPress with Apache in Ubuntu 20.04</a>.</p></div></div>    
</body>
</html>