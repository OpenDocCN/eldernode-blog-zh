<html>
<head>
<title>How to Configure Caddy for Effective Load Balancing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何配置Caddy以实现有效的负载平衡</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/configure-caddy-for-effective-load-balancing/#0001-01-01">https://blog.eldernode.com/configure-caddy-for-effective-load-balancing/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/afc574d9a51b48601f54d382f8b393cc.png" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Configure Caddy for Effective Load Balancing" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Configure-Caddy-for-Effective-Load-Balancing.webp"/><p>在某些情况下，您会遇到这样的情况:您必须在尽可能短的时间内建立并运行一个静态网站。Caddy是一款注重简单性和安全性的现代web服务器，可以在整个过程中为您提供帮助。本文将教你如何配置Caddy来实现有效的负载平衡。我们提供经济实惠的Linux VPS服务器，这是想购买的人的最佳选择。</p><h2><span class="ez-toc-section" id="Tutorial_Configure_Caddy_for_Load_Balancing"/> <strong>教程为负载均衡配置Caddy</strong><span class="ez-toc-section-end"/></h2><h3><span class="ez-toc-section" id="Introduvtion_to_Caddy"/> <strong>球童介绍</strong> <span class="ez-toc-section-end"/></h3><p>Caddy 是一个开源的、跨平台的、可扩展的web服务器，默认情况下自动使用HTTPS。它是用Go编写的，没有依赖性，因此可以在容器中完美运行。该web服务器负责TLS证书更新、OCSP装订、静态文件服务、反向代理、Kubernetes入口等，并简化您的基础架构。它的模块化架构允许您使用一个可在任何平台上编译的静态二进制文件完成更多工作。</p><h2><span class="ez-toc-section" id="Installing_Caddy_for_Effective_Load_Balancing"/> <strong>安装Caddy进行有效负载均衡</strong> <span class="ez-toc-section-end"/></h2><p>首先，导航到<a href="https://github.com/caddyserver/caddy/releases">官方GitHub网站</a>并下载Caddy:</p><p> </p><p><img data-lazyloaded="1" src="../Images/54bc2ac48807472fba049169ee2b0db1.png" decoding="async" loading="lazy" class="aligncenter wp-image-42952 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download.webp" alt="Caddy-download" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download.webp 1113w, https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download-300x168.webp 300w, https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download-1024x574.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download-768x431.webp 768w" data-sizes="(max-width: 1113px) 100vw, 1113px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/Caddy-download.webp"/></p><p> </p><p>或者，您可以使用以下命令之一下载Caddy:</p><pre><code class="language-bash">curl -OL "https://github.com/caddyserver/caddy/releases/latest/download/Filename"</code></pre><pre><code class="language-bash">wget "https://github.com/caddyserver/caddy/releases/latest/download/Filename"</code></pre><p><em> <strong>注意:</strong> </em>为你的平台替换文件名而不是“文件名”。</p><p>您可以使用下面的命令在Ubuntu、Debian和Raspbian上安装Caddy:</p><pre><code class="language-bash">echo "deb [trusted=yes] https://apt.fury.io/caddy/ /" \</code></pre><pre><code class="language-bash">sudo tee -a /etc/apt/sources.list.d/caddy-fury.list</code></pre><h3><span class="ez-toc-section" id="Configuring_Caddy_Load_Balancer_in_Docker_Compose"/> <strong>在Docker Compose </strong>中配置Caddy负载平衡器<span class="ez-toc-section-end"/></h3><p>首先，您应该使用服务器容器，它将打印出当前容器的主机名以及请求细节。</p><p>Caddy的死简单配置文件的设置如下:</p><pre><code class="language-bash">:80 {        encode zstd gzip        reverse_proxy www01:8080 www02:8080 {            health_uri /          health_interval 5s          health_timeout 3s          health_status 200        }  }</code></pre><p>这两个工作负载在端口8080上运行，Caddy负载平衡器在端口80上向您的本地机器公开。现在将这些容器隔离在一个名为instance的网络中:</p><pre><code class="language-bash">version: "3.9"  services:    caddy-lb:      networks:        - instance      image: caddy:2-alpine      volumes:        - ./caddy/data:/data        - ./caddy/config/Caddyfile:/etc/caddy/Caddyfile      depends_on:        - www01        - www02      ports:        - "80:80"    www01:      image: jmalloc/echo-server      hostname: www01      networks:        - instance      ports:        - "8080"    www02:      image: jmalloc/echo-server      hostname: www02      networks:        - instance      ports:        - "8080"    networks:    instance:</code></pre><p>您可以运行该实例，如下所示:</p><pre><code class="language-bash">docker-compose up --build --remove-orphans</code></pre><p>现在，在您想要的浏览器中单击localhost。</p><p>然后刷新几次。请求在上游目地之间切换，不同的容器为其服务。在此阶段，借助以下命令终止其中一个容器:</p><pre><code class="language-bash">docker kill ID</code></pre><p><em> <strong>注意:</strong> </em>记得用浏览器中的一个ID替换ID。</p><p>如果您再刷新几次，您将看到Caddy不再为来自该容器的流量提供服务。</p><p>就是这样！</p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>Caddy web server负责TLS证书更新、OCSP装订、静态文件服务、反向代理、Kubernetes入口等，并简化您的基础架构。在本文中，我们向您介绍了如何配置Caddy来实现有效的负载平衡。我希望本教程对您有用，并帮助您配置Caddy以实现有效的负载平衡。如果你遇到任何问题或者有任何疑问，可以在评论区联系我们。</p></div></div>    
</body>
</html>