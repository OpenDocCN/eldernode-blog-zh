<html>
<head>
<title>How to Create a user in Windows with PowerShell - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何用PowerShell在Windows中创建用户- Eldernode Blog</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/create-a-user-in-windows-with-powershell/#0001-01-01">https://blog.eldernode.com/create-a-user-in-windows-with-powershell/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/f9146b6c3c5eeab6b752f02b55c3c807.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Create a user in Windows with PowerShell" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/06/How-to-Create-a-user-in-Windows-with-PowerShell-1.png"/><p>了解如何使用PowerShell 一步步在Windows中创建用户。通常大多数Windows用户至少有过一次与CMD或命令提示符斗争的经历，并且知道CMD或命令提示符是用来执行Windows命令的。但是很少有人知道PowerShell是什么，它是如何工作的。在本文中，我们将教你如何用PowerShell在Windows中创建用户。PowerShell是一个类似于命令提示符的工具，比命令提示符复杂和强大得多，并且应该完全取代命令提示符。因为PowerShell对Windows的能力和控制远大于命令提示符。</p><p><em> <strong>注意:</strong></em>CMD或者<strong>命令提示符</strong>命令在<a href="https://blog.eldernode.com/introduction-to-windows-powershell/" target="_blank" rel="noopener noreferrer"> PowerShell </a>环境下工作，你也可以使用<a href="https://en.wikipedia.org/wiki/Cmd.exe"> CMD </a>用户命令创建PowerShell用户。</p><p>本<a href="https://eldernode.com/category/tutorial/">教程</a>基于<strong> PowerShell版本5.1及以上</strong>，默认安装在<strong> Windows 10 </strong>和<strong> Windows Server 2016 </strong>及以上。要在旧版本中使用此命令，您必须将相关模块添加到PowerShell中，或者使用命令提示符命令来创建用户。立即加入我们，了解如何使用PowerShell在Windows中创建用户。</p><h2><span class="ez-toc-section" id="Tutorial_create_a_user_with_PowerShell_commands"/>教程使用PowerShell命令创建用户<span class="ez-toc-section-end"/></h2><p>Windows PowerShell遵循一个全面的结构，了解您使用过PowerShell将使您非常容易学习如何在PowerShell中创建用户版本。</p><p><strong> 1- </strong>首先在Windows中用<strong>管理员权限</strong>打开<strong> PowerShell </strong>。</p><p><strong> 2- </strong>在PowerShell中创建一个用户，使用<strong> New-localuser </strong>命令，其结构类似如下。</p><pre><code class="language-bash">New-LocalUser -Name [username] [Option]  </code></pre><p><strong> New-LocalUser命令</strong>的结构是这样的，它有一个名为Name的主要部分，实际上是<strong>用户名</strong>和其他参数，我们将在下面解释。</p><h3><span class="ez-toc-section" id="Example_to_create_a_user_in_Windows_with_PowerShell"/>使用PowerShell在Windows中创建用户的示例<span class="ez-toc-section-end"/></h3><p>在解释各种参数之前，请注意下面的<strong>两个例子</strong>以更熟悉在PowerShell中创建的用户命令的结构。</p><p><em> <strong>例1: </strong> </em></p><p>在下面的例子中，创建了一个名为<strong> Michael </strong>的用户，没有为其分配密码，并且在Description部分中，为该用户编写了一个描述，您可以根据需要对其进行定制。</p><pre><code class="language-bash">New-LocalUser -Name “Michael” -Description “Test User” -NoPassword  </code></pre><p><em> <strong>例二:</strong> </em></p><p>在下面的示例中，与第一个示例一样，将创建一个具有特定用户名<strong> Michael </strong>和描述的用户，并为其分配一个密码。本例中重要的一点是，PowerShell不接受简单类型或明文形式的密码，您必须首先创建一个变量并在其中输入密码，然后在命令之间使用该变量。</p><p>输入以下命令创建一个名为Password的变量，并从您那里秘密接收它。</p><pre><code class="language-bash">$password = Read-Host -AsSecureString  </code></pre><p>输入上述命令后，您将收到一个密码。按Enter键后，还可以使用以下命令。</p><pre><code class="language-bash">New-LocalUser -Name “Michael” -Description “Test User with Password” -Password $password  </code></pre><p>这将允许您在PowerShell中创建用户。我们现在将继续描述提到的其他实用参数。</p><h3><span class="ez-toc-section" id="New-LocalUser_command_parameters_in_PowerShell"/>PowerShell中的New-LocalUser命令参数<span class="ez-toc-section-end"/></h3><p><strong> AccountExpires: </strong>用户的到期日期由该参数指定</p><p><strong>帐户永不过期:</strong>用户帐户是否过期</p><p><strong>禁用:</strong>用户帐户是活动的还是不活动的</p><p><strong> FullName: </strong> Full username</p><p><strong>密码永不过期:</strong>用户密码是否过期</p><p><strong>usermaynnotchangepassword:</strong>用户可以更改或不更改密码</p><p>提到的项目是该命令的重要参数，它们与第一个和第二个示例中提到的参数一起构成了该命令的实际和特定参数。</p><p>下面是创建用户的完整示例。在此示例中，请参见参数的使用。</p><pre><code class="language-bash">New-LocalUser -Name “Michael” -Description “IT Manager” -Password $password -FullName “Michael Jordan-Disabled -PasswordNeverExpires –UserMayNotChangePassword  </code></pre><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>我们试图用实际例子教你如何在Windows中用PowerShell创建一个用户。还提到了PowerShell中的New-LocalUser <a href="https://blog.eldernode.com/important-powershell-commands/" target="_blank" rel="noopener noreferrer">命令</a>参数。</p></div></div>    
</body>
</html>