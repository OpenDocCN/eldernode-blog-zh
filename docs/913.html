<html>
<head>
<title>Tutorial Configure Samba on Debian - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>教程在Debian - Eldernode博客上配置Samba</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/configure-samba-on-debian/#0001-01-01">https://blog.eldernode.com/configure-samba-on-debian/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/5b9c22e04646a39037e0ae36b47bcfae.png" data-src="https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial Configure Samba on Debian" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/05/configure-samba-on-debian.webp"/><p>如果您从Windows客户端连接到Windows文件服务器，由于两个操作系统之间的通信协议相同，您的通信将会顺利建立。但是要将Windows客户机连接到来自Linux或Unix操作系统的服务器文件，您将需要一个通信协议。Samba是Linux和Windows之间的通信协议。在本文中，我们将教你如何在Debian上配置Samba。另外，如果你想购买一个<a href="https://eldernode.com/linux-vps/" target="_blank" rel="noopener"> <strong> Linux VPS </strong> </a>主机，你可以访问<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>中可用的软件包。</p><h2><span class="ez-toc-section" id="What_is_Samba"/> <strong>什么是桑巴？</strong>T3】</h2><p>Samba是一个协议、网络工具和标准的Windows互操作性程序套件，适用于Linux和Unix。Samba这个名称来源于SMB，SMB代表服务器消息块，是Microsoft Windows网络文件系统使用的标准协议的名称。Samba允许Windows共享Unix主机上的文件和打印机，还允许Unix用户访问Windows系统上的共享资源。Samba是重新实现SMB/CIFS网络协议的免费软件。Andrew Tridgell在1991年12月和1992年1月开发了Samba Unix的第一个版本。</p><h3><span class="ez-toc-section" id="Samba_Features"/> <strong>桑巴特色</strong> <span class="ez-toc-section-end"/></h3><ul><li>在重负载下提供良好的性能</li><li>提供安全的数据传输</li><li>支持NT风格的打印服务(SPOOLSS)</li><li>支持CIFS/中小企业的POSIX扩展</li><li>支持TCP/IP上的NetBIOS(NBT)</li><li>易于快速部署</li><li>允许并发操作</li><li>多通道技术</li></ul><h2><span class="ez-toc-section" id="How_to_Install_Samba_on_Debian"/> <strong>如何在Debian上安装Samba</strong><span class="ez-toc-section-end"/></h2><p>在执行任何操作之前，使用以下命令更新您的软件包列表:</p><pre><code class="language-bash">sudo apt update</code></pre><p>Samba可以在Debian默认仓库中获得。您可以通过运行以下命令来安装Samba:</p><pre><code class="language-bash">sudo apt install samba smbclient cifs-utils</code></pre><p>以下依赖项也将随Samba一起安装:</p><pre><code class="language-bash">The following additional packages will be installed:  attr ibverbs-providers keyutils libcephfs2 libgfapi0 libgfrpc0 libgfxdr0  libglusterfs0 libibverbs1 librados2 librdmacm1 python3-cffi-backend  python3-cryptography python3-dnspython python3-gpg python3-markdown  python3-pygments python3-requests-toolbelt python3-samba python3-tdb  python3-yaml samba-common samba-common-bin samba-dsdb-modules  samba-vfs-modules tdb-tools</code></pre><p>建议的软件包:</p><pre><code class="language-bash">winbind python-cryptography-doc python3-cryptography-vectors python3-sniffio  python3-trio python-markdown-doc python-pygments-doc ttf-bitstream-vera  bind9 bind9utils ctdb ldb-tools ntp | chrony smbldap-tools ufw  heimdal-clients</code></pre><p>将安装以下新软件包:</p><pre><code class="language-bash">attr cifs-utils ibverbs-providers keyutils libcephfs2 libgfapi0 libgfrpc0  libgfxdr0 libglusterfs0 libibverbs1 librados2 librdmacm1  python3-cffi-backend python3-cryptography python3-dnspython python3-gpg  python3-markdown python3-pygments python3-requests-toolbelt python3-samba  python3-tdb python3-yaml samba samba-common samba-common-bin  samba-dsdb-modules samba-vfs-modules smbclient tdb-tools</code></pre><h2><span class="ez-toc-section" id="How_to_Configure_Samba_on_Debian"/> <strong>如何在Debian上配置Samba</strong><span class="ez-toc-section-end"/></h2><p>此时，您需要更改Samba全局设置。Samba配置文件位于/etc/samba/smb.conf中。为此，您应该使用您喜欢的文本编辑器打开该文件，并更改您想要的设置:</p><pre><code class="language-bash">nano /etc/samba/smb.conf</code></pre><p>现在是时候创建一个共享的Samba目录了，您可以在其中共享公共和私有目录:</p><pre><code class="language-bash">sudo mkdir /public  sudo mkdir /private</code></pre><p>然后，您需要向Samba conf添加两个目录。为此，请在文本编辑器中打开文件并编辑它:</p><pre><code class="language-bash">nano /etc/samba/smb.conf</code></pre><p>请记住在文件末尾添加共享和身份验证方法，以便进行访问:</p><pre><code class="language-bash">[public]  comment = Public Folder  path = /public  writable = yes  guest ok = yes  guest only = yes  force create mode = 775  force directory mode = 775  [private]  comment = Private Folder  path = /private  writable = yes  guest ok = no  valid users = @smbshare  force create mode = 770  force directory mode = 770  inherit permissions = yes</code></pre><p>在这一步中，您应该创建Samba共享用户和用户组来访问私有共享。您可以通过输入以下命令来创建该组:</p><pre><code class="language-bash">sudo groupadd smbshare</code></pre><p>接下来，您应该为私有共享添加必要的权限:</p><pre><code class="language-bash">sudo chgrp -R smbshare /private/  sudo chgrp -R smbshare /public</code></pre><p>要设置适当的目录权限，请运行以下命令:</p><pre><code class="language-bash">sudo chmod 2770 /private/  sudo chmod 2775 /public</code></pre><p>上述命令开头的值2代表SGID位，它允许新创建的文件继承父组。</p><p>要访问私有共享，您需要创建一个不登录的本地用户。为此，请运行以下命令:</p><pre><code class="language-bash">sudo useradd -M -s /sbin/nologin sambauser</code></pre><p>然后，您应该将用户添加到Samba共享组，如下所示:</p><pre><code class="language-bash">sudo usermod -aG smbshare sambauser</code></pre><p>请记住使用以下命令为用户创建SMB密码:</p><pre><code class="language-bash">sudo smbpasswd -a sambauser</code></pre><p>最后，通过输入以下命令启用创建的帐户:</p><pre><code class="language-bash">sudo smbpasswd -e sambauser</code></pre><h2><span class="ez-toc-section" id="How_to_Verify_the_Samba_configuration"/> <strong>如何验证桑巴配置</strong> <span class="ez-toc-section-end"/></h2><p>您可以在以下命令的帮助下测试配置文件:</p><pre><code class="language-bash">sudo testparm</code></pre><p>现在您需要在Samba共享中创建演示文件。为此，请运行以下命令:</p><pre><code class="language-bash">sudo mkdir /private/demo-private /public/demo-public  sudo touch /private/demo1.txt /public/demo2.txt</code></pre><p>您应该通过执行以下命令来应用更改，从而重新启动该服务:</p><pre><code class="language-bash">sudo systemctl restart nmbd</code></pre><p>如果您运行了防火墙，您可以使用以下命令从指定的IP范围启用远程访问:</p><pre><code class="language-bash">sudo ufw allow from IP-range to any app Samba</code></pre><p>请注意，您应该在上面的命令中输入您的IP，而不是IP-range。</p><h2><span class="ez-toc-section" id="How_to_Access_the_Shares_from_the_Client"/> <strong>如何从客户端访问股票</strong> <span class="ez-toc-section-end"/></h2><p>首先，您应该能够从本地设备访问共享。您可以使用以下命令来完成此操作:</p><pre><code class="language-bash">$ smbclient '\\localhost\private' -U sambauser  Enter WORKGROUP\sambauser's password:   Try "help" to get a list of possible commands.  smb: \&gt; ls  .                                     D        0  Tue Apr  26 02:10:34 2022  ..                                    D        0  Tue Apr  26 02:04:41 2022  demo1.txt                             N        0  Tue Apr  26 02:10:34 2022  demo-private                          D        0  Tue Apr  26 02:10:24 2022                   39987708 blocks of size 1024. 32647972 blocks available  smb: \&gt; exit</code></pre><h3><span class="ez-toc-section" id="Setting_up_a_Windows_Client"/> <strong>设置Windows客户端</strong> <span class="ez-toc-section-end"/></h3><p>您可以使用Samba共享系统的IP地址从Windows访问共享。</p><p>首先，你应该通过按<strong> Win+R </strong>打开一个run框，然后输入你的IP。</p><p> </p><p><img data-lazyloaded="1" src="../Images/bca960177d97e7610d09f4c8b269242b.png" decoding="async" loading="lazy" class="aligncenter wp-image-35778 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/04/1.-Run-box.png" alt="1. Run-box" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/04/1.-Run-box.png 497w, https://blog.eldernode.com/wp-content/uploads/2022/04/1.-Run-box-300x155.png 300w" data-sizes="(max-width: 497px) 100vw, 497px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/04/1.-Run-box.png"/></p><p> </p><p>然后你会看到共享文件夹。在其中一个共享文件夹中创建文件。</p><p>应该可以在Samba服务器设备上查看创建的文件。</p><p>接下来，您需要在您的Windows系统上安装Samba共享。为此，右击<strong>这台电脑</strong>并选择<strong>映射网络驱动器</strong>。</p><p> </p><p><img data-lazyloaded="1" src="../Images/aed5e0e22b361144543e0512c7d63313.png" decoding="async" loading="lazy" class="aligncenter wp-image-35780 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/04/2.-Click-map-network-drive.png" alt="2. Click-map-network-drive" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/04/2.-Click-map-network-drive.png 537w, https://blog.eldernode.com/wp-content/uploads/2022/04/2.-Click-map-network-drive-259x300.png 259w" data-sizes="(max-width: 537px) 100vw, 537px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/04/2.-Click-map-network-drive.png"/></p><p> </p><p>现在您需要填写路径细节。</p><p> </p><p><img data-lazyloaded="1" src="../Images/7ca5d31efde5a77791f3c89645ec3018.png" decoding="async" loading="lazy" class="aligncenter wp-image-35785 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/04/3.-what-network-folder-would-you-like-to-map-1.png" alt="3. what-network-folder-would-you-like-to-map" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/04/3.-what-network-folder-would-you-like-to-map-1.png 564w, https://blog.eldernode.com/wp-content/uploads/2022/04/3.-what-network-folder-would-you-like-to-map-1-300x211.png 300w" data-sizes="(max-width: 564px) 100vw, 564px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/04/3.-what-network-folder-would-you-like-to-map-1.png"/></p><p> </p><p>然后，您应该输入Samba用户凭证。</p><p> </p><p><img data-lazyloaded="1" src="../Images/814301669a4bd0bd12c43a80b9ed6474.png" decoding="async" loading="lazy" class="aligncenter wp-image-35786 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/04/4.-Samba-user-credentials.png" alt="4. Samba-user-credentials" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/04/4.-Samba-user-credentials.png 416w, https://blog.eldernode.com/wp-content/uploads/2022/04/4.-Samba-user-credentials-300x231.png 300w" data-sizes="(max-width: 416px) 100vw, 416px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/04/4.-Samba-user-credentials.png"/></p><p> </p><p>最后，您将可以使用该共享。</p><h3><span class="ez-toc-section" id="Setting_up_a_Linux_Client"/> <strong>设置Linux客户端</strong> <span class="ez-toc-section-end"/></h3><p>要设置Linux客户机，您应该使用以下命令安装Samba包:</p><pre><code class="language-bash">sudo apt install samba-client cifs-utils</code></pre><p>安装完成后，进入<strong>文件管理器</strong>，选择<strong>其他位置</strong>。然后，您可以使用以下语法添加您的共享:</p><figure class="wp-block-image size-full"/><pre><code class="language-bash">smb://servername/Share_name</code></pre><p>现在您应该输入Samba用户凭证。</p><p> </p><p><img data-lazyloaded="1" src="../Images/36a76137a30541a36ff1bd2a1b9f0f96.png" decoding="async" loading="lazy" class="aligncenter wp-image-35790 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/04/5.-Linux-client-Samba-user-credentials-1.png" alt="5. Linux-client-Samba-user-credentials" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/04/5.-Linux-client-Samba-user-credentials-1.png 425w, https://blog.eldernode.com/wp-content/uploads/2022/04/5.-Linux-client-Samba-user-credentials-1-300x264.png 300w" data-sizes="(max-width: 425px) 100vw, 425px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/04/5.-Linux-client-Samba-user-credentials-1.png"/></p><p> </p><p>最后，您将有Samba共享可用。</p><h2><span class="ez-toc-section" id="How_to_Uninstall_Samba_on_Debian"/> <strong>如何在Debian上卸载Samba</strong><span class="ez-toc-section-end"/></h2><p>您可以使用以下命令删除Samba:</p><pre><code class="language-bash">apt-get remove samba</code></pre><p>以下命令可以删除整个samba包和配置文件:</p><pre><code class="language-bash">sudo apt-get purge samba</code></pre><p>Purge与remove相同，只是前者会删除软件包。就是这样！</p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，我们教你如何在Debian上配置和卸载Samba。安装Samba后，您可以通过网络在Windows和Linux系统之间共享文件。我希望这篇文章对你有用。你可以在评论里提出你的问题。</p></div></div>    
</body>
</html>