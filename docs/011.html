<html>
<head>
<title>Tutorial install and use PostgreSQL on Ubuntu 18.04 - Eldernode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>教程在Ubuntu 18.04上安装和使用PostgreSQL-elder node</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-postgresq-ubuntu-18-04/#0001-01-01">https://blog.eldernode.com/install-postgresq-ubuntu-18-04/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/774e310faf41db8244041559cea8341a.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial install and use PostgreSQL on Ubuntu 18.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1992.png"/><p>PostgreSQL(简称Postgres)是一个开源的、强大的、先进的、高性能的、稳定的关系文档数据库系统。它使用并增强了SQL语言以及大量用于安全数据存储和管理的功能。</p><p>它高效、可靠、可扩展，可用于处理大量复杂的数据，建立企业级容错环境，同时确保高度的数据完整性。Postgres也是高度可扩展的，具有API附带的索引等特性，因此您可以开发自己的解决方案来解决您的数据存储挑战。</p><p>关系数据库管理系统是许多网站和应用程序的关键组件。它们提供了一种结构化的方式来存储、组织和访问信息。PostgreSQL或Postgres是一个关系数据库管理系统，它提供了SQL查询语言的实现。对于许多小型和大型项目来说，这是一个受欢迎的选择，它的优点是符合标准，并具有许多高级功能，如可靠的事务和无读锁的并发性。</p><p>为了让你的学习更好地进行，选择你自己的<a href="https://eldernode.com/ubuntu-vps/" target="_blank" rel="noopener noreferrer"> Ubuntu VPS服务器</a>并立即激活。</p><p> </p><p> </p><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p>按照本教程，你将需要一个已经按照我们的<span><a href="https://eldernode.com/initial-setup-ubuntu-18/" target="_blank" rel="noopener noreferrer">Ubuntu 18.04</a></span>初始服务器设置指南配置的<strong> Ubuntu 18.04 </strong>服务器。</p><p>完成这个先决教程后，你的服务器应该有一个非<strong> root </strong>用户，拥有<strong> <span> sudo </span> </strong>权限和一个基本防火墙。</p><p> </p><p> </p><p> </p><h2><span class="ez-toc-section" id="Tutorial_install_and_Use_PostgreSQL_on_Ubuntu_1804"/>教程在Ubuntu 18.04上安装和使用PostgreSQL<span class="ez-toc-section-end"/></h2><p>在本文中，您将学习如何在一个<strong> Ubuntu 18.04 </strong> VPS实例上安装Postgres，并且还提供了基本的<span> <a href="https://nl.wikipedia.org/wiki/Database_administrator" target="_blank" rel="noopener noreferrer">数据库管理</a> </span>的说明。</p><p> </p><p> </p><p> </p><h3 id="step-1-—-installing-postgresql"><span class="ez-toc-section" id="Step_1_-_How_To_Install_PostgreSQL"/>步骤1–如何安装PostgreSQL <span class="ez-toc-section-end"/></h3><p>Ubuntu的默认库包含Postgres包，所以你可以使用<span> <strong> apt </strong> </span>打包系统来安装这些包。</p><p>由于这是您第一次在此会话中使用<span> <strong> apt </strong> </span>，请刷新您的本地包索引。然后，安装Postgres包以及一个<span> <strong> -contrib </strong> </span>包，该包添加了一些额外的实用程序和功能:</p><pre><code class="language-bash">sudo apt update  sudo apt install postgresql postgresql-contrib</code></pre><p>现在软件已经安装好了，你可以回顾一下它是如何工作的，以及它与你用过的类似的数据库管理系统有什么不同。</p><p> </p><p> </p><p> </p><h3 id="step-2-—-using-postgresql-roles-and-databases"><span class="ez-toc-section" id="Step_2_-_How_To_Use_PostgreSQL_Roles_and_Databases"/>步骤2–如何使用PostgreSQL角色和数据库<span class="ez-toc-section-end"/></h3><p>默认情况下，Postgres使用一个叫做“角色”的概念来处理认证和授权。在某些方面，这些类似于常规的Unix风格的帐户，但是Postgres不区分用户和组，而是更喜欢更灵活的术语“角色”。</p><p>安装时，Postgres被设置为使用ident身份验证，这意味着它将Postgres角色与匹配的Unix/Linux系统帐户相关联。如果Postgres中存在一个角色，则具有相同名称的Unix/Linux用户名可以作为该角色登录。</p><p>安装过程创建了一个名为<strong> postgres </strong>的用户帐户，该帐户与默认postgres角色相关联。为了使用Postgres，您可以登录该帐户。</p><p>有几种方法可以利用这个帐户访问Postgres。</p><p> </p><p> </p><h3 id="switching-over-to-the-postgres-account"><span class="ez-toc-section" id="How_To_Switch_Over_to_the_postgres_Account"/> <span>如何切换到postgres账户</span> <span class="ez-toc-section-end"/></h3><p>通过键入以下命令切换到服务器上的<strong> postgres </strong>帐户:</p><pre><code class="language-bash">sudo -i -u postgres</code></pre><p>现在，您可以通过键入以下命令来立即访问Postgres提示符:</p><pre><code class="language-bash">psql</code></pre><p>这将使您登录到<span> PostgreSQL </span>提示符，从这里您可以立即与数据库管理系统进行交互。</p><p>通过键入以下命令退出PostgreSQL提示符:</p><pre><code class="language-bash">postgres=# \q</code></pre><p>这将把你带回<span> <strong> postgres </strong> </span> Linux命令提示符。</p><p> </p><p> </p><p> </p><h3 id="accessing-a-postgres-prompt-without-switching-accounts"><span class="ez-toc-section" id="How_To_Access_a_Postgres_Prompt_Without_Switching_Accounts"/> <span>不切换账号如何进入Postgres提示</span> <span class="ez-toc-section-end"/></h3><p>你也可以用<span> <strong> sudo </strong> </span>直接用<strong> postgres </strong>账号运行你喜欢的命令。</p><p>例如，在最后一个例子中，首先切换到<strong> postgres </strong>用户，然后运行<span> <strong> psql </strong> </span>来打开Postgres提示符。您可以通过使用<span> <strong> sudo </strong> </span>作为<strong> postgres </strong>用户运行单个命令<span> <strong> psql </strong> </span>来一步完成，如下所示:</p><pre><code class="language-bash">sudo -u postgres psql</code></pre><p>这将使你直接登录Postgres，中间没有中介<span> <strong> bash </strong> </span> shell。</p><p>同样，您可以通过键入以下命令退出交互式Postgres会话:</p><pre><code class="language-bash">postgres=# \q</code></pre><p> </p><p> </p><p> </p><h3 id="step-3-—-creating-a-new-role"><span class="ez-toc-section" id="Step_3_-_How_To_Create_a_New_Role"/>步骤3–如何创建新角色<span class="ez-toc-section-end"/></h3><p>目前，您只是在数据库中配置了<strong> postgres </strong>角色。您可以从命令行使用<strong> <span> createrole </span> </strong>命令创建新角色。<span><strong>–交互式</strong> </span>标志将提示您输入新角色的名称，并询问它是否应该具有超级用户权限。</p><p>如果您以<strong> postgres </strong>帐户登录，您可以通过键入以下命令创建一个新用户:</p><pre><code class="language-bash"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="88f8e7fbfceffaedfbc8fbedfafeedfa">[email protected]</a>:~$  createuser --interactive</code></pre><p>相反，如果您更喜欢使用<span> <strong> sudo </strong> </span>来执行每个命令，而不切换您的普通帐户，请键入:</p><pre><code class="language-bash">sudo -u postgres createuser --interactive</code></pre><p>该脚本将提示您一些选择，并根据您的回答，执行正确的Postgres命令来创建符合您的规范的用户。</p><p title="Output"><span>输出</span></p><pre><code class="language-bash">Enter name of role to add: noodi  Shall the new role be a superuser? (y/n) <span>y</span></code></pre><p>您可以通过传递一些额外的标志来获得更多的控制。通过查看<span> <strong> man </strong> </span>页面查看选项:</p><pre><code class="language-bash">man createuser</code></pre><p><em> <strong>注</strong> </em>:我们选择noodi作为用户名。<strong>不要忘记在命令行提示中替换你考虑的名字或电子邮件。</strong></p><p>您的Postgres安装现在有了一个新用户，但是您还没有添加任何数据库。下一节将描述这个过程。</p><p> </p><p> </p><p> </p><h3 id="step-4-—-creating-a-new-database"><span class="ez-toc-section" id="Step_4_-_How_To_Create_A_New_Database"/>步骤4–如何创建新数据库<span class="ez-toc-section-end"/></h3><p>Postgres身份验证系统默认做出的另一个假设是，对于用于登录的任何角色，该角色都将拥有一个其可以访问的同名数据库。</p><p>这意味着，如果您在上一节中创建的用户名为<strong> noodi </strong>，该角色将尝试连接到一个默认情况下也称为“noodi”的数据库。你可以用<span> <strong> createdb </strong> </span>命令创建合适的数据库。</p><p>如果您以<strong> postgres </strong>帐户的身份登录，您应该键入如下内容:</p><pre><code class="language-bash"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d2a2bda1a6b5a0b7a192a1b7a0a4b7a0">[email protected]</a>:~$ createdb <span class="highlight">noodi</span></code></pre><p><span class="highlight">如果您更喜欢使用</span> <span> <strong> sudo </strong> </span> <span class="highlight">来执行每个命令，而不切换您的普通帐户，您可以键入:</span></p><pre><code class="language-bash">sudo -u postgres createdb <span>noodi</span></code></pre><p>这种灵活性为根据需要创建数据库提供了多种途径。</p><pre><code class="language-bash"/></pre><pre><code class="language-bash"/></pre><p> </p><h3 id="step-5-—-opening-a-postgres-prompt-with-the-new-role"><span class="ez-toc-section" id="Step_5_-_How_To_Open_A_Postgres_Prompt_With_The_New_Role"/>步骤5–如何使用新角色<span class="ez-toc-section-end"/>打开Postgres提示</h3><p>要使用基于<span> <strong> ident </strong> </span>的认证登录，您需要一个与您的Postgres角色和数据库同名的Linux用户。</p><p>如果没有匹配的Linux用户，可以用<span> <strong> adduser </strong> </span>命令创建一个。你必须从你的非<strong> root </strong>帐户使用<span> <strong> sudo </strong> </span>权限(意思是，不是以<strong> postgres </strong>用户身份登录)来完成这项工作:</p><pre><code class="language-bash">sudo adduser <span>noodi</span></code></pre><p>一旦这个新帐户可用，您可以通过键入以下命令切换并连接到数据库:</p><pre><code class="language-bash">sudo -i -u <span>noodi</span>  psql</code></pre><p>或者，您可以内联执行此操作:</p><pre><code class="language-bash">sudo -u <span>noodi</span> psql</code></pre><p>假设所有组件都已正确配置，此命令将自动让您登录。</p><p>如果希望用户连接到不同的数据库，可以通过如下方式指定数据库:</p><pre><code class="language-bash">psql -d postgres</code></pre><p>登录后，您可以通过键入以下命令来检查您当前的连接信息:</p><pre><code class="language-bash">noodi=# \conninfo</code></pre><p class="secondary-code-label" title="Output"><span>输出</span></p><pre><code class="language-bash">You are connected to database "noodi" as user "noodi" via socket in "/var/run/postgresql" at port "5432".</code></pre><p>如果您连接到非默认数据库或非默认用户，这将非常有用。</p><p> </p><p> </p><p> </p><h3 id="step-6-—-creating-and-deleting-tables"><span class="ez-toc-section" id="Step_6_-_How_To_Create_And_Deleting_Tables"/>步骤6–如何创建和删除表格<span class="ez-toc-section-end"/></h3><p>现在您已经知道了如何连接到PostgreSQL数据库系统，您可以学习一些基本的Postgres管理任务。</p><p>首先，创建一个表来存储一些数据。举个例子，一个描述一些操场设备的表格。</p><p>该命令的基本语法如下:</p><pre><code class="language-bash">CREATE TABLE table_name (      column_name1 col_type (field_length) column_constraints,      column_name2 col_type (field_length),      column_name3 col_type (field_length)  );</code></pre><p>如您所见，这些命令为表命名，然后定义列、列类型和字段数据的最大长度。您还可以选择为每列添加表约束。</p><p>出于演示目的，创建一个简单的表，如下所示:</p><pre><code class="language-bash">CREATE TABLE playground (      equip_id serial PRIMARY KEY,      type varchar (50) NOT NULL,      color varchar (25) NOT NULL,      location varchar(25) check (location in ('north', 'south', 'west', 'east', 'northeast', 'southeast', 'southwest', 'northwest')),      install_date date  );</code></pre><p>这些命令将创建一个盘点操场设备的表。这从一个设备ID开始，它是<span> <strong>序列号</strong> </span>类型的。此数据类型是自动递增的整数。您还为该列赋予了<span> <strong>主键</strong> </span>的约束，这意味着值必须是惟一的并且不为空。</p><p>对于两列(<span><strong/></span>和<span> <strong>安装日期</strong> </span>)，命令不指定字段长度。这是因为有些列类型不需要固定长度，因为长度是由类型决定的。</p><p>接下来的两个命令分别为设备<span> <strong>类型</strong> </span>和<span> <strong>颜色</strong> </span>创建列，每个列都不能为空。之后的命令创建了一个<span> <strong>位置</strong> </span>列，并创建了一个要求该值为八个可能值之一的约束。最后一个命令创建一个日期列，记录设备的安装日期。</p><p>您可以通过键入以下命令来查看新表:</p><pre><code class="language-bash">noodi=# \d</code></pre><p title="Output"><span>输出</span></p><pre><code class="language-bash">                  List of relations   Schema |          Name           |   Type   | Owner   --------+-------------------------+----------+-------   public | playground              | table    | noodi   public | playground_equip_id_seq | sequence | noodi  (2 rows)</code></pre><p>你的游戏桌在这里，但是还有一个名为<span> <strong>的游戏桌_装备_ id _序列</strong> </span>是类型<span> <strong>序列</strong> </span>。这是你给你的<span> <strong> equip_id </strong> </span>列的<span> <strong>序列号</strong> </span>类型的表示。这将跟踪序列中的下一个数字，并为此类型的列自动创建。</p><p>如果您只想查看没有序列的表格，可以键入:</p><p><span>输出</span></p><pre><code class="language-bash">noodi=# \d</code></pre><p title="Output"><span class="ez-toc-section" id="Step_7_-_Adding_Querying_and_Deleting_Data_in_a_Table"/>第7步-表中数据的增加、查询、删除<span class="ez-toc-section-end"/></p><pre class="code-pre"><code class="language-bash">          List of relations   Schema |    Name    | Type  | Owner   --------+------------+-------+-------   public | playground | table | noodi  (1 row)          </code></pre><pre><code class="language-bash"/></pre><h3 id="step-7-—-adding-querying-and-deleting-data-in-a-table">现在您有了一个表，您可以向其中插入一些数据。</h3><p>例如，通过调用要添加的表，命名列，然后为每列提供数据，来添加幻灯片和swing，如下所示:</p><p>输入数据时应该小心，以避免一些常见的问题。首先，不要用引号将列名括起来，但是输入的列值需要引号。</p><pre><code class="language-bash">noodi=# INSERT INTO playground (type, color, location, install_date) VALUES ('slide', 'blue', 'south', '2017-04-28');</code></pre><pre><code class="language-bash">noodi=# INSERT INTO playground (type, color, location, install_date) VALUES ('swing', 'yellow', 'northwest', '2018-08-16');</code></pre><pre><code class="language-bash"/></pre><pre><code class="language-bash"/></pre><p>另一件要记住的事情是，不要为<span> <strong> equip_id </strong> </span>列输入值。这是因为每当在表中创建新行时都会自动生成。</p><p>通过键入以下内容检索您添加的信息:</p><p><span>输出</span></p><pre><code class="language-bash">noodi=# SELECT * FROM playground;</code></pre><p title="Output">在这里，您可以看到您的<span> <strong> equip_id </strong> </span>已经成功填写，并且您的所有其他数据都已正确组织。</p><pre><code class="language-bash"> equip_id | type  | color  | location  | install_date   ----------+-------+--------+-----------+--------------          1 | slide | blue   | south     | 2017-04-28          2 | swing | yellow | northwest | 2018-08-16  (2 rows)</code></pre><p>如果操场上的滑梯坏了，您必须移除它，您也可以通过键入以下命令从表格中移除该行:</p><p>再次查询该表:</p><pre><code class="language-bash">noodi=# DELETE FROM playground WHERE type = 'slide';</code></pre><p><span>输出</span></p><pre><code class="language-bash">noodi=# SELECT * FROM playground;</code></pre><p title="Output">您注意到您的幻灯片不再是表格的一部分。</p><pre><code class="language-bash"> equip_id | type  | color  | location  | install_date   ----------+-------+--------+-----------+--------------          2 | swing | yellow | northwest | 2018-08-16  (1 row)</code></pre><p><span class="ez-toc-section" id="Step_8_-_How_To_Add_and_Delete_Columns_From_A_Table"/>步骤8–如何在表格中添加和删除列<span class="ez-toc-section-end"/></p><pre><code class="language-bash"/></pre><pre><code class="language-bash"/></pre><pre><code class="language-bash"/></pre><h3 id="step-8-—-adding-and-deleting-columns-from-a-table">创建表后，您可以修改它，以便相对容易地添加或删除列。通过键入以下内容，添加一列以显示每台设备的最后一次维护访问:</h3><p>如果再次查看您的表信息，您将看到新列已被添加(但没有输入任何数据):</p><pre><code class="language-bash">noodi=# ALTER TABLE playground ADD last_maint date;</code></pre><p><span>输出</span></p><pre><code class="language-bash">noodi=# SELECT * FROM playground;</code></pre><p title="Output">删除列也一样简单。如果您发现您的工作团队使用单独的工具来跟踪维护历史，您可以通过键入以下内容来删除该列:</p><pre><code class="language-bash"> equip_id | type  | color  | location  | install_date | last_maint   ----------+-------+--------+-----------+--------------+------------          2 | swing | yellow | northwest | 2018-08-16   |   (1 row)</code></pre><p>这将删除<span> <strong> last_maint </strong> </span>列以及在其中找到的任何值，但保留所有其他数据不变。</p><pre><code class="language-bash">noodi=# ALTER TABLE playground DROP last_maint;</code></pre><p> </p><p> </p><p><span class="ez-toc-section" id="Step_9_-_How_To_Update_Data_in_a_Table"/>步骤9–如何更新表格中的数据<span class="ez-toc-section-end"/></p><h3 id="step-9-—-updating-data-in-a-table">到目前为止，您已经学习了如何向表中添加记录以及如何删除记录，但是本教程还没有介绍如何修改现有的条目。</h3><p>您可以通过查询所需的记录并将该列设置为您希望使用的值来更新现有条目的值。您可以查询“swing”记录(这将匹配表中每个 swing的<em>)并将其颜色更改为“红色”。如果您给秋千一个油漆工作，这可能是有用的:</em></p><p>您可以通过再次查询数据来验证操作是否成功:</p><pre><code class="language-bash">noodi=# UPDATE playground SET color = 'red' WHERE type = 'swing';</code></pre><p><span>输出</span></p><pre><code class="language-bash">noodi=# SELECT * FROM playground;</code></pre><p title="Output">如您所见，您的幻灯片现在显示为红色。</p><pre><code class="language-bash"> equip_id | type  | color | location  | install_date   ----------+-------+-------+-----------+--------------          2 | swing | red   | northwest | 2010-08-16  (1 row)</code></pre><p> </p><p> </p><p> </p><p><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></p><h2><span> <span>在本文中，完成本指南的步骤后，您成功地<span>学会了如何在Ubuntu 18.04 </span> </span> </span>上安装和使用PostgreSQL。现在你已经在你的Ubuntu 18.04服务器上设置了<strong> PostgreSQL </strong>。然而，Postgres<strong>还有很多东西要学。如果有兴趣阅读更多相关教程，可以找我们的文章<a href="https://blog.eldernode.com/tutorial-postgresql-installation-ubuntu-20/" target="_blank" rel="noopener noreferrer">教程PostgreSQL安装Ubuntu 20.04 </a> <strong>和</strong> <a href="https://blog.eldernode.com/install-postgresql-debian10/" target="_blank" rel="noopener noreferrer">如何在Debian 10中安装PostgreSQL数据库</a>。</strong></h2><p><span> <span>在本文中，完成本指南的步骤后，您成功地<span>学会了如何在Ubuntu 18.04 </span> </span> </span>上安装和使用PostgreSQL。现在你已经在你的Ubuntu 18.04服务器上设置了<strong> PostgreSQL </strong>。然而，Postgres<strong>还有很多东西要学。如果有兴趣阅读更多相关教程，可以找我们的文章<a href="https://blog.eldernode.com/tutorial-postgresql-installation-ubuntu-20/" target="_blank" rel="noopener noreferrer">教程PostgreSQL安装Ubuntu 20.04 </a> <strong>和</strong> <a href="https://blog.eldernode.com/install-postgresql-debian10/" target="_blank" rel="noopener noreferrer">如何在Debian 10中安装PostgreSQL数据库</a>。</strong></p></div></div>    
</body>
</html>