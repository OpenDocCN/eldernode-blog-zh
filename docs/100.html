<html>
<head>
<title>How to install Nginx on Debian 10 - how to Adjust the Firewall</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Debian 10上安装Nginx如何调整防火墙</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-nginx-debian-10/#0001-01-01">https://blog.eldernode.com/install-nginx-debian-10/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/e402451332d85d725441ebcc5c712c7f.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to install Nginx on Debian 10" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_2085.png"/><p>在接下来的<span> <a href="https://eldernode.com/install-nginx-on-ubuntu-20-04-lts/" target="_blank" rel="noopener noreferrer"> Nginx </a> </span>教程中，在这篇文章中，我们将学习<strong>如何在Debian 10 </strong>上安装Nginx。但是首先，Nginx基本上是什么？Nginx是世界上最受欢迎的网络服务器之一，负责托管互联网上一些最大、流量最高的网站。在大多数情况下，它比Apache更加资源友好，可以用作web服务器或反向代理服务器。</p><p> </p><p><strong>先决条件</strong></p><p>如果您知道以下内容，本教程可能会更有用:</p><p> </p><h2><span class="ez-toc-section" id="How_to_install_Nginx_on_Debian_10"/> <span>如何在Debian 10上安装Nginx</span>T3】</h2><p>让我们浏览本教程的步骤，并讨论如何在Debian 10上安装<strong> Nginx。</strong></p><p><strong>不要错过相关文章:</strong></p><p class="fjpost-title px-0"><span> <a href="https://eldernode.com/installation-nginx-on-centos-8/" target="_blank" rel="noopener noreferrer">教程CentOS 8上安装Nginx</a>T3】</span></p><p class="fjpost-title px-0"><span> <a href="https://eldernode.com/wordpress-installation-nginx-ubuntu20/" target="_blank" rel="noopener noreferrer">教程Ubuntu 20.04中用Nginx安装WordPress</a></span></p><p class="fjpost-title px-0"><span> <a href="https://eldernode.com/secure-nginx-encrypt-ubuntu/" target="_blank" rel="noopener noreferrer">如何在Ubuntu 20.04上用Let's Encrypt保护Nginx</a></span></p><p class="fjpost-info"/><h3/><h3 id="step-1-–-installing-nginx"><span class="ez-toc-section" id="1-_Installing_Nginx"/> <span> 1-安装Nginx </span> <span class="ez-toc-section-end"/></h3><p class="fjpost-info">因为Debian的默认库已经是Nginx，所以可以使用<span> apt </span>打包系统从这些库中安装它。</p><div><p>因此，因为这是您在本次会议中第一次与<span> apt </span>打包系统进行交互，所以让我们首先更新我们的本地包索引，以便我们可以访问最新的包列表:</p><pre><code class="language-bash">sudo apt update</code></pre><p>现在，您可以安装Nginx:</p><pre><code class="language-bash">sudo apt install nginx</code></pre></div><p>然后，当系统询问您时，点击<span>输入</span>继续。之后，<span> apt </span>将把Nginx和任何需要的依赖项安装到你的服务器上。</p><p> </p><h3 id="step-2-–-adjusting-the-firewall"><span class="ez-toc-section" id="2-_Adjusting_the_Firewall"/> <span> 2-调整防火墙</span> <span class="ez-toc-section-end"/></h3><p>由于防火墙软件要求，您需要在测试Nginx之前对其进行调整，以允许访问该服务。</p><p>键入以下内容，列出<span> ufw </span>知道如何使用的应用程序配置:</p><pre><code class="language-bash">sudo ufw app list</code></pre><p title="Output"><span>输出</span></p><pre><code class="language-bash">Available applications:  ...    Nginx Full    Nginx HTTP    Nginx HTTPS  ...</code></pre><p>如您所见，Nginx有三个可用的概要文件:</p><ul><li><span> <strong> Nginx Full </strong> </span>:此配置文件同时打开端口<span> 80 </span>(正常、未加密的web流量)和端口<span> 443 </span> (TLS/SSL加密流量)</li><li><span> <strong> Nginx HTTP </strong> </span>:此配置文件仅打开端口<span> 80 </span>(正常、未加密的网络流量)</li><li><span> <strong> Nginx HTTPS </strong> : </span>此配置文件仅打开端口<span> 443 </span> (TLS/SSL加密流量)</li></ul><p> </p><p><span> <strong>注意</strong> </span>:建议您启用最严格的配置文件，该文件仍将允许您已配置的流量。由于您还没有在本指南中为我们的服务器配置SSL，您只需要允许端口<span> 80 </span>上的HTTP流量。</p><p>您可以通过键入以下命令来启用它:</p><pre><code class="language-bash">sudo ufw allow 'Nginx HTTP</code></pre><p>并验证这些更改:</p><pre><code class="language-bash">sudo ufw status</code></pre><p title="Output"><span>输出</span></p><pre><code class="language-bash">Status: active    To                         Action      From  --                         ------      ----  OpenSSH                    ALLOW       Anywhere                    Nginx HTTP                 ALLOW       Anywhere                    OpenSSH (v6)               ALLOW       Anywhere (v6)               Nginx HTTP (v6)            ALLOW       Anywhere (v6)</code></pre><p><strong> <span> <a href="https://eldernode.com/bitcoin-vps/" target="_blank" rel="noopener noreferrer">用比特币购买虚拟机</a> </span> </strong></p><p> </p><p><span class="ez-toc-section" id="3-_Checking_your_Web_Server"/> <span> 3-检查你的网络服务器</span> <span class="ez-toc-section-end"/></p><h3 id="step-3-–-checking-your-web-server">一旦安装完成，Debian 10就启动Nginx。web服务器应该已经启动并运行。</h3><p>您可以通过键入以下命令来检查<span> systemd </span> init系统，以确保服务正在运行:</p><p><span>输出</span></p><pre><code class="language-bash">systemctl status nginx</code></pre><p title="Output">通过接收上述输出，这意味着服务似乎已经成功启动。然而，最好的测试方法是从Nginx实际请求一个页面。</p><pre><code class="language-bash">● nginx.service - A high performance web server and a reverse proxy server     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)     Active: active (running) since Wed 2019-07-03 12:52:54 UTC; 4min 23s ago       Docs: man:nginx(8)   Main PID: 3942 (nginx)      Tasks: 3 (limit: 4719)     Memory: 6.1M     CGroup: /system.slice/nginx.service             ├─3942 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;             ├─3943 nginx: worker process             └─3944 nginx: worker process</code></pre><p>您可以通过导航到服务器的IP地址来访问默认的Nginx登录页面，以确认软件运行正常。如果您不知道服务器的IP地址，请尝试在服务器的命令提示符下键入以下内容:</p><p>你会得到几行。你可以在你的网络浏览器中尝试每一种方法，看看它们是否有效。</p><pre><code class="language-bash">ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\/.*$//'</code></pre><p>获得服务器的IP地址后，将其输入浏览器的地址栏:</p><p>然后，应该会显示默认的Nginx登录页面。</p><pre><code class="language-bash">http://<span>your_server_ip</span></code></pre><p><img data-lazyloaded="1" src="../Images/7e4c906ac073cfa73d2ae8a2eca0676e.png" decoding="async" loading="lazy" class="aligncenter wp-image-10649 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/default_page.jpg" alt="default Nginx landing page" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/default_page.jpg 577w, https://blog.eldernode.com/wp-content/uploads/2020/08/default_page-300x110.jpg 300w" data-sizes="(max-width: 577px) 100vw, 577px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/default_page.jpg"/></p><p>通过此页面，您将看到服务器正在正确运行。</p><p><span class="ez-toc-section" id="4-_Managing_the_Nginx_Process"/> <span> 4-管理Nginx进程</span> <span class="ez-toc-section-end"/></p><h3 id="step-4-–-managing-the-nginx-process">由于web服务器已经启动并运行，您可以查看一些基本的管理命令。</h3><p>使用下面的命令停止您的web服务器。</p><p>此外，您可以在web服务器停止时启动它:</p><pre><code class="language-bash">sudo systemctl stop nginx</code></pre><p>要停止然后再次启动该服务:</p><pre><code class="language-bash">sudo systemctl start nginx</code></pre><p>如果只是简单地修改配置，Nginx通常可以在不中断连接的情况下重新加载。为此，请键入:</p><pre><code class="language-bash">sudo systemctl restart nginx</code></pre><p><strong>默认</strong>，Nginx配置为服务器启动时自动启动。如果这不是您想要的，您可以通过键入以下命令来禁用此行为:</p><pre><code class="language-bash">sudo systemctl reload nginx</code></pre><p>要重新启用服务以在引导时启动，您可以键入:</p><pre><code class="language-bash">sudo systemctl disable nginx</code></pre><p> </p><pre><code class="language-bash">sudo systemctl enable nginx</code></pre><p><span class="ez-toc-section" id="5-_Setting_Up_Server_Blocks"/> <span> 5-设置服务器块</span> <span class="ez-toc-section-end"/></p><h3 id="step-5-–-setting-up-server-blocks">要了解更多关于设置服务器块的信息，让我们这样解释:当使用Nginx web服务器时，服务器块可用于封装配置细节，并在一台服务器上托管多个域。您将建立一个名为<strong> your_domain </strong>的域。要了解更多关于使用DigitalOcean设置域名的信息，请参阅我们的DigitalOcean DNS简介。</h3><p>Debian 10 上的Nginx有一个默认启用的服务器块，它被配置为从位于<span> /var/www/html </span>的目录中提供文档。虽然这对于单个站点来说很有效，但是如果你托管多个站点，这就变得难以管理了。不要修改<span> /var/www/html </span>，让我们在<span> /var/www </span>中为<strong> your_domain </strong>网站创建一个目录结构，保留<span> /var/www/html </span>作为缺省目录，如果一个客户端请求与任何其他站点都不匹配，就提供这个目录。</p><p>为<strong> your_domain </strong>创建目录，如下所示，使用<span> -p </span>标志创建任何必要的父目录:</p><p>现在，使用<span> $USER </span>环境变量分配目录的所有权，该变量应该引用您当前的系统用户:</p><pre><code class="language-bash">sudo mkdir -p /var/www/<span>your_domain</span>/html</code></pre><p>如果您没有修改您的<span> umask </span>值，您的webroot权限应该是正确的，但是您可以通过键入以下命令来确保:</p><pre><code class="language-bash">sudo chown -R $USER:$USER /var/www/<span class="highlight">your_domain</span>/html</code></pre><p>然后，使用<span> nano </span>或您喜欢的编辑器创建一个示例<span>index.html</span>页面:</p><pre><code class="language-bash">sudo chmod -R 755 /var/www/<span class="highlight">your_domain</span></code></pre><p>在内部添加以下示例HTML:</p><pre><code class="language-bash">nano /var/www/<span class="highlight">your_domain</span>/html/index.html</code></pre><p><span>/var/www/your _ domain/html/index . html</span></p><p class="code-label" title="/var/www/your_domain/html/index.html">完成后，现在您可以保存并关闭文件。</p><pre><code class="language-bash">&lt;html&gt;      &lt;head&gt;          &lt;title&gt;Welcome to <span>your_domain</span>&lt;/title&gt;      &lt;/head&gt;      &lt;body&gt;          &lt;h1&gt;Success! Your Nginx server is successfully configured for &lt;em&gt;<span>your_domain</span>&lt;/em&gt;. &lt;/h1&gt;  &lt;p&gt;This is a sample page.&lt;/p&gt;      &lt;/body&gt;  &lt;/html&gt;</code></pre><p>您需要创建一个服务器块，其中包含指向我们的自定义webroot的正确指令，以便为Nginx提供这些内容。与其直接修改默认配置文件，不如在<span>/etc/nginx/sites-available/<span>your _ domain</span></span>新建一个:</p><p>粘贴以下配置块，该配置块与默认配置块相似，但针对新目录和域名进行了更新:</p><pre><code class="language-bash">sudo nano /etc/nginx/sites-available/<span>your_domain</span></code></pre><p><span>/etc/nginx/sites-available/your _ domain</span></p><p class="code-label" title="/etc/nginx/sites-available/your_domain"><strong>请注意</strong>您已经将<span>根</span>配置更新到我们的新目录，并将<span>服务器名称</span>更新到我们的域名。</p><pre><code class="language-bash">server {          listen 80;          listen [::]:80;            root /var/www/<span>your_domain</span>/html;          index index.html index.htm index.nginx-debian.html;            server_name <span>your_domain</span> www.<span>your_domain</span>;            location / {                  try_files $uri $uri/ =404;          }  }</code></pre><p>接下来，让我们通过在启用了<span>站点的</span>目录中创建一个到我们的定制配置文件的符号链接来启用这个服务器块，Nginx在启动时从这个目录中读取数据。</p><p>两个服务器块现在被启用并配置为基于它们的<span> listen </span>和<span> server_name </span>指令来响应请求。</p><pre><code class="language-bash">sudo ln -s /etc/nginx/sites-available/<span class="highlight">your_domain</span> /etc/nginx/sites-enabled/</code></pre><p><span> your_domain </span>:将响应<span> your_domain </span>和<span> www.your_domain </span>的请求。</p><ul><li><span>默认</span>:将响应端口<span> 80 </span>上与其他两个块不匹配的任何请求。</li><li>为了避免在您的配置中添加额外的服务器名称可能导致的哈希桶内存问题，有必要在<span> /etc/nginx/nginx.conf文件</span>中调整一个值。打开文件:</li></ul><p>现在，找到<span>server _ names _ hash _ bucket _ size</span>指令，并删除<span> # </span>符号以取消对该行的注释:</p><pre><code class="language-bash">sudo nano /etc/nginx/nginx.conf</code></pre><p><span>/etc/engine x/engine x . conf</span></p><p class="code-label" title="/etc/nginx/nginx.conf">完成后，现在您可以保存并关闭文件。</p><pre><code class="language-bash">...  http {      ...      server_names_hash_bucket_size 64;      ...  }  ...</code></pre><p>您还可以进行测试，以确保您的任何Nginx文件中没有语法错误:</p><p><span>输出</span></p><pre><code class="language-bash">sudo nginx -t</code></pre><p title="Output">当您通过配置测试后，重新启动Nginx以使您的更改生效。</p><pre><code class="language-bash">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok  nginx: configuration file /etc/nginx/nginx.conf test is successful</code></pre><p><strong>请注意【Nginx现在应该为您的域名提供服务。您可以通过导航到<span> http://your_domain </span>来测试这一点，您应该会看到类似这样的内容:</strong></p><pre><code class="language-bash">sudo systemctl restart nginx</code></pre><p><span class="ez-toc-section" id="6-_Getting_Familiar_with_Important_Nginx_Files_and_Directories"/> <span> 6-熟悉重要Nginx文件和目录</span> <span class="ez-toc-section-end"/></p><pre><code class="language-bash"/></pre><pre><code class="language-bash"><img data-lazyloaded="1" src="../Images/31a43fcbc486faac25993d331823582c.png" decoding="async" loading="lazy" class="aligncenter wp-image-10655 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/nginx_serverblock.jpg" alt="the serverblock of Nginx" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/nginx_serverblock.jpg 983w, https://blog.eldernode.com/wp-content/uploads/2020/08/nginx_serverblock-300x34.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/nginx_serverblock-768x88.jpg 768w" data-sizes="(max-width: 983px) 100vw, 983px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/nginx_serverblock.jpg"/></code></pre><pre><code class="language-bash"/></pre><h3 id="step-6-–-getting-familiar-with-important-nginx-files-and-directories">既然您知道如何管理Nginx服务本身，那么您应该花几分钟时间熟悉一些重要的目录和文件。</h3><p><span class="ez-toc-section" id="Content"/> <span>内容</span> <span class="ez-toc-section-end"/></p><h4 id="content"><span> /var/www/html </span>:实际的web内容，默认情况下只包含您之前看到的默认Nginx页面，是在<span> /var/www/html </span>目录之外提供的。您可以通过修改Nginx配置文件来改变它。</h4><ul><li><span class="ez-toc-section" id="Server_Configuration"/> <span>服务器配置</span> <span class="ez-toc-section-end"/></li></ul><h4 id="server-configuration"><span>/etc/Nginx</span>:Nginx配置目录。所有Nginx配置文件都在这里。</h4><ul><li><span>/etc/Nginx/Nginx . conf</span>:Nginx主配置文件。您可以对其进行修改，以更改Nginx全局配置。</li><li><span>/etc/nginx/sites-available/</span>:可以存储每个站点的服务器块的目录。Nginx不会使用在这个目录中找到的配置文件，除非它们链接到<span>站点启用的</span>目录。通常，所有服务器块配置都在此目录中完成，然后通过链接到另一个目录来启用。</li><li><span>/etc/nginx/sites-enabled/</span>:存储已启用的每个站点的服务器块的目录。通常，它们是通过链接到在<span>站点-可用的</span>目录中找到的配置文件来创建的。</li><li><span> /etc/nginx/snippets </span>:这个目录包含可以包含在nginx配置中其他地方的配置片段。潜在的可重复配置段是重构为代码片段的良好候选。</li><li><span class="ez-toc-section" id="Server_Logs"/> <span>服务器日志</span> <span class="ez-toc-section-end"/></li></ul><h4 id="server-logs"><span>/var/log/nginx/access . log</span>:对web服务器的每个请求都记录在这个日志文件中，除非Nginx被配置为其他方式。</h4><ul><li><span> /var/log/nginx/error.log </span>:任何nginx错误都会记录在这个日志中。</li><li><strong> <span>好样的</span> </strong>！接触到这一点，你就成功地完成了这本如何在Debian 10上安装Nginx的指南。现在，您已经安装了web服务器，对于可以提供的内容类型和可以用来为用户创建更丰富体验的技术，您有许多选择。</li></ul><p><strong><span>Good job</span></strong>! By touching this point, you have successfully finished this guide of How to install Nginx on Debian 10. and you have your web server installed now, you have many options for the type of content you can serve and the technologies you can use to create a richer experience for your users.</p></div></div>    
</body>
</html>