<html>
<head>
<title>How To Install MongoDB On Ubuntu 20.04 - Eldernode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu 20.04 - Eldernode上安装MongoDB</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-mongodb-ubuntu-20/#0001-01-01">https://blog.eldernode.com/install-mongodb-ubuntu-20/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/96083413f97df7ac510d72613bb3dbdb.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to install MongoDB on Ubuntu 20.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/IMG_1996.png"/><p>MongoDB，也称为Mongo，是许多现代web应用程序中使用的开源文档数据库。它被归类为<a href="https://en.wikipedia.org/wiki/NoSQL" target="_blank" rel="noopener noreferrer"> NoSQL数据库</a>，因为它不依赖于传统的基于表的关系数据库结构。</p><p>相反，它使用带有动态模式的类似JSON的文档，这意味着，与关系数据库不同，在向数据库添加数据之前，MongoDB不需要预定义的模式。您可以根据需要随时更改模式，而不必用更新的模式建立新的数据库。联系Eldernode团队作为<a href="https://eldernode.com/vps/" target="_blank" rel="noopener noreferrer"> VPS </a>提供商，拥有自己的<a href="https://eldernode.com/linux-vps/" target="_blank" rel="noopener noreferrer"> Linux虚拟服务器</a>。</p><p> </p><p> </p><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p>拥有<span> sudo </span>权限的<strong>非root </strong>用户。</p><p>一台Ubuntu 20.04服务器，按照我们在Ubuntu 20.04 上设置的<a href="https://eldernode.com/initial-server-setup-on-ubuntu-20/" target="_blank" rel="noopener noreferrer">初始服务器</a> <a href="https://eldernode.com/initial-server-setup-on-ubuntu-20/" target="_blank" rel="noopener noreferrer">进行设置。</a></p><p> </p><h2/><h2><span class="ez-toc-section" id="How_to_install_MongoDB_on_Ubuntu_2004"/>如何在Ubuntu 20.04上安装MongoDB<span class="ez-toc-section-end"/></h2><p>加入我们向你展示如何<strong>在Ubuntu 20.04 </strong>上安装MongoDB。至此，您将在Ubuntu 20.04服务器上安装MongoDB，测试它，并学习如何将其作为<span> <strong> systemd </strong> </span>服务进行管理。</p><p class="fjpost-info"/><h3/><h3 id="step-1-—-installing-mongodb"><span class="ez-toc-section" id="Step_1_-_How_To_Install_MongoDB"/>步骤1–如何安装MongoDB <span class="ez-toc-section-end"/></h3><div><p>首先，要获得该软件的最新版本，您必须将MongoDB的专用包存储库包含到您的APT源代码中。然后，您将能够安装mongodb-org，这是一个元包，它总是指向mongodb的最新版本。首先，导入MongoDB最新稳定版本的公共GPG密钥。您可以通过导航到MongoDB密钥服务器并找到包含最新稳定版本号并以. asc结尾的文件来找到合适的密钥文件。</p><p>要继续，请右键单击该文件，然后选择复制链接地址。然后，将该链接粘贴到以下curl命令中。</p><p><em> <strong>注</strong> </em>:不要忘记替换“https://www . MongoDB . org/static/PGP/server-4.4 . ASC”的网址</p></div><pre><code class="language-bash">curl -fsSL <span class="highlight">https://www.mongodb.org/static/pgp/server-4.4.asc</span> | sudo apt-key add -</code></pre><div><p><strong>更详细地解释一下</strong>，cURL是许多操作系统上都有的命令行工具，用于传输数据。它读取存储在传递给它的URL上的任何数据，并将内容打印到系统的输出。在下面的例子中，cURL打印GPG密钥文件的内容，然后通过管道将它传输到下面的<span><strong>sudo apt-key add–</strong></span>命令，从而将GPG密钥添加到可信密钥列表中。</p><p><strong>请考虑</strong>这个<span> <strong> curl </strong> </span>命令使用了选项<span> <strong> -fsSL </strong> </span>，这两个选项合在一起，本质上是告诉curl无声地失败。这意味着，如果由于某种原因cURL无法联系GPG服务器或GPG服务器宕机，它不会意外地将结果错误代码添加到您的可信密钥列表中。</p><p>如果添加成功，该命令将返回<span> <strong> OK </strong> </span>:</p><p title="Output"><span>输出</span></p><pre><code class="language-bash">OK</code></pre></div><div><p>如果您需要再次检查是否正确添加了密钥，可以使用以下命令:</p><pre><code class="language-bash">apt-key list</code></pre><div title="Output"><p title="Output"><span>输出</span></p><pre><code class="language-bash">/etc/apt/trusted.gpg  --------------------  pub   rsa4096 2019-05-28 [SC] [expires: 2024-05-26]        2069 1EEC 3521 6C63 CAF6  6CE1 6564 08E3 90CF B1F5  uid           [ unknown] MongoDB 4.4 Release Signing Key &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="96e6f7f5fdf7f1fff8f1d6fbf9f8f1f9f2f4b8f5f9fb">[email protected]</a>&gt;  . . .    </code></pre></div><p>当你的APT安装还不知道去哪里找<span> <strong> mongodb-org </strong> </span>包的时候你需要安装最新版本的mongodb。</p><p>但是在你的服务器上有两个地方<strong>APT会在那里寻找下载和安装软件包的在线资源:</strong></p><p><span> <strong> sources.list </strong> </span>文件和<strong> <span> sources.list.d </span> </strong>目录。<span> <strong> sources.list </strong> </span>是一个列出APT数据活动源的文件，每行一个源，最优先的源列在最前面。<span><strong>sources . list . d</strong></span>目录允许您将此类<span> <strong> sources.list </strong> </span>条目添加为单独的文件。</p></div><p>使用下面的命令，在<span> sources.list.d </span>目录<span>中创建一个名为mongodb-org-4.4.list </span>的文件。这个文件中唯一的内容是一行文字，写着【https://repo.mongodb.org/apt/ubuntu】deb[arch = amd64，arm 64]focal/MongoDB-org/4.4 multiverse<span>:</span></p><pre><code class="language-bash">echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/4.4 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.4.list</code></pre><pre><code class="language-bash"><span>Now attention to this single line, which tells APT everything it needs to know about what the source is and where to find it:</span></code></pre><div><p>deb:这意味着源条目引用了常规的Debian架构。在其他情况下，这一行的这一部分可能读作deb-src，这意味着source条目代表Debian发行版的源代码。</p><p><span>【arch = amd64，arm 64】</span>:指定APT数据应该下载到哪个架构。在这种情况下，它指定amd64和arm64架构。</p><p><span>https://repo.mongodb.org/apt/ubuntu</span>:这是一个URI，代表可以找到APT数据的位置。在这种情况下，URI指向官方MongoDB存储库所在的HTTPS地址。</p><p>focal/MongoDB-org/4.4:Ubuntu库可以包含几个不同的版本。这表明您只希望mongodb-org包的4.4版本可用于Ubuntu的focal发行版(“Focal Fossa”是Ubuntu 20.04的代码名称)。</p><p>多元宇宙(multiverse):这部分指向四个主要Ubuntu库之一。在这种情况下，它指向多元宇宙库。</p></div><div><p>运行这个命令后，更新您的服务器的本地包索引，以便APT知道在哪里可以找到<span> mongodb-org </span>包:</p></div><pre><code class="language-bash">sudo apt update</code></pre><div><p>同样，您可以安装MongoDB:</p><pre><code class="language-bash">sudo apt install mongodb-org</code></pre></div><div><p>要确认你要安装软件包，按下<span> Y </span>然后<span>输入</span></p><p>当该命令完成时，MongoDB将安装在您的系统上。然而，它还不能使用。接下来，您将启动MongoDB并确认它工作正常。</p></div><p/><p/><p/><h3 id="step-2-—-starting-the-mongodb-service-and-testing-the-database"><span class="ez-toc-section" id="Step_2_-_How_To_Start_The_MongoDB_Service_And_Test_The_Database"/>步骤2–如何启动MongoDB服务并测试数据库<span class="ez-toc-section-end"/></h3><div><p>到目前为止，您已经了解了上一步中描述的安装过程会自动将MongoDB配置为由<span> systemd </span>控制的守护进程，这意味着您可以使用各种<span> systemctl </span>命令来管理MongoDB。但是，此安装过程不会自动启动该服务。运行下面的<span> systemctl </span>命令来启动MongoDB服务:</p><pre><code class="language-bash">sudo systemctl start mongod.service</code></pre><p>接下来，检查服务的状态。请注意，该命令不包括。服务文件定义中的服务。如果这个后缀不存在的话，systemctl会自动将它附加到您传递的任何参数上，所以没有必要包含它:</p><pre><code class="language-bash">sudo systemctl status mongod</code></pre></div><div><p title="Output"><span>输出</span></p><pre class="code-pre"><code class="language-bash">● mongod.service - MongoDB Database Server       Loaded: loaded (/lib/systemd/system/mongod.service; disabled; vendor preset: enabled)       Active: active (running) since Tue 2020-06-09 12:57:06 UTC; 2s ago         Docs: https://docs.mongodb.org/manual     Main PID: 37128 (mongod)       Memory: 64.8M       CGroup: /system.slice/mongod.service               └─37128 /usr/bin/mongod --config /etc/mongod.conf</code></pre></div><div><p>在确认服务按预期运行后，<strong>启用</strong>MongoDB服务以在引导时启动:</p><pre><code class="language-bash">sudo systemctl enable mongod</code></pre><p>通过连接到数据库服务器并执行诊断命令，可以进一步验证数据库是否可运行。以下命令将连接到数据库并输出其当前版本、服务器地址和端口。它还将返回MongoDB的内部连接状态命令的结果:</p><pre><code class="language-bash">mongo --eval 'db.runCommand({ connectionStatus: 1 })'</code></pre><p><b>连接状态</b>是做什么的？它<span>将检查并返回数据库连接的状态。响应中的</span> <span> ok </span> <span>字段的值为</span> <span> <strong> 1 </strong> </span> <span>表示服务器工作正常:</span></p></div><div><p title="Output"><span>输出</span></p><pre><code class="language-bash">MongoDB shell version v4.4.0  connecting to: mongodb://127.0.0.1:27017/?compressors=disabled&amp;gssapiServiceName=mongodb  Implicit session: session { "id" : UUID("1dc7d67a-0af5-4394-b9c4-8a6db3ff7e64") }  MongoDB server version: 4.4.0  {      "authInfo" : {          "authenticatedUsers" : [ ],          "authenticatedUserRoles" : [ ]      },      "ok" : 1  }</code></pre></div><div><p><em> <strong>注</strong> </em>:数据库运行在<span> <strong> 127.0.0.1 </strong> </span>端口<span> <strong> 27017 </strong> </span>上，本地环回地址代表<strong> localhost </strong>。这是MongoDB的默认端口号。</p></div><p/><p/><p/><h3 id="step-3-—-managing-the-mongodb-service"><span class="ez-toc-section" id="Step_3_-_How_To_Manage_The_MongoDB_Service"/>步骤3–如何管理MongoDB服务<span class="ez-toc-section-end"/></h3><div><p>如前所述，步骤1中描述的安装过程将MongoDB配置为作为一个<span> <strong> systemd </strong> </span>服务运行。这意味着你可以使用标准的<span> <strong> systemctl </strong> </span>命令来管理它，就像你管理其他Ubuntu系统服务一样。</p><p>如您所知，<span> <strong> systemctl status </strong> </span>命令检查<strong> MongoDB </strong>服务的状态。</p><pre><code class="language-bash">sudo systemctl status mongod</code></pre><p>您可以随时使用以下命令停止该服务。</p><pre><code class="language-bash">sudo systemctl stop mongod</code></pre><p>此外，要在服务停止时启动它，请使用下面的命令。</p></div><div><pre><code class="language-bash">sudo systemctl start mongod</code></pre></div><p>如果您需要重启已经运行的服务器:</p><pre><code class="language-bash">sudo systemctl restart mongod</code></pre><pre><code class="language-bash"/></pre><p><strong>注意</strong>:在第<strong> 2 </strong>步中，你启用了<strong> MongoDB </strong>与服务器自动启动。如果您希望<strong>禁用</strong>该自动启动，请键入:</p><pre><code class="language-bash">sudo systemctl disable mongod</code></pre><div><p>然后为了<strong>重新启用</strong>使其在开机时启动，再次运行<span> <strong>启用</strong> </span>命令:</p></div><pre><code class="language-bash">sudo systemctl enable mongod</code></pre><p> </p><p> </p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，通过完成本指南的步骤，您学习了如何在Ubuntu 20.04上安装MongoDB，现在您将官方的MongoDB存储库添加到APT实例中，并安装了MongoDB的最新版本。然后您测试了Mongo的功能，并练习了一些systemctl命令。如果你有兴趣了解更多关于这个主题的内容，请关注我们的相关文章<a href="https://blog.eldernode.com/install-mongodb-debian/" target="_blank" rel="noopener noreferrer">如何在Debian 10上安装MongoDB 4</a>和<a href="https://blog.eldernode.com/install-mongodb-4-centos-8/" target="_blank" rel="noopener noreferrer">如何在CentOS 8上安装MongoDB 4</a>。</p></div></div>    
</body>
</html>