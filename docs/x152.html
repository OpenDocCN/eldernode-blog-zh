<html>
<head>
<title>How to Create Backup Service with Virtualizor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何用Virtualizor创建备份服务</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/create-backup-service-with-virtualizor/#0001-01-01">https://blog.eldernode.com/create-backup-service-with-virtualizor/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/1600836291b9d51ad7e5596f434f6bc3.png" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Create Backup Service with Virtualizor" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/How-to-Create-Backup-Service-with-Virtualizor.webp"/><p>Virtualizor是一个强大的基于web的VPS控制面板，允许用户一键部署和管理VPS服务器。Virtualizor支持KVM虚拟化技术以及其他一些技术。在本文中，我们将教你如何用Virtualizor创建备份服务。需要注意的是，如果你想买一个<a href="https://eldernode.com/dedicated-server/">专用服务器</a>，可以访问Eldernode网站上提供的平面图和位置。</p><h2><span class="ez-toc-section" id="Introduction_to_Virtualizor"/> <strong>虚拟人简介</strong> <span class="ez-toc-section-end"/></h2><p>Virtualizor是Softaculous开发的一个方便易用的控制面板。它还拥有强大的API和实时统计数据，以及许多其他功能。管理员只需点击一个按钮就可以创建VPS。VPS用户可以使用高度先进的基于web的GUI来启动、停止、重启和管理他们的VPS。您可以通过Virtualizor从管理面板管理备份、媒体和格式。请继续关注这篇文章，学习如何使用Virtualizor创建备份服务。</p><h3><span class="ez-toc-section" id="How_to_Add_Backup_Server_with_Virtualizor"/> <strong>如何用虚拟器添加备份服务器</strong> <span class="ez-toc-section-end"/></h3><p>在熟悉了<a href="https://blog.eldernode.com/tag/virtualizor/"> Virtualizor </a>控制面板之后，在本节中，我们想学习如何添加备份服务器。您可能知道，Virtualizor支持三种类型的备份:本地、SSH和FTP。</p><p>您应该注意的一点是，在本地备份的情况下，VPS映像备份在节点服务器自己的目录中。还应该注意，对于远程备份，您需要添加备份服务器的详细信息，这可以使用Add Backup Server API来完成。</p><p>要添加备份服务器，你需要去<strong> Virtualizor管理面板&gt;T3】服务器&gt;T5】添加备份服务器</strong>。</p><p>成功添加备份服务器后，您需要确保将其添加到需要备份的VPS文件的备份计划中。或者，在添加备份服务器后，您应该使用测试备份连接API来测试到备份服务器的连接。<br/>最后，当您在添加备份服务器时传递gen_key，您将在API响应中收到公钥和私钥，如以下命令所示:</p><pre><code class="language-bash">[keys] =&gt; Array  (  [public_key] =&gt; ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDFvWP35.... <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="abd9c4c4dfebc7d3c8">[email protected]</a>    [private_key] =&gt; -----BEGIN RSA PRIVATE KEY-----  MIIEowIBAAKCAQEAxb1j9+b66jRBBPRtVq+znA9nlqiGtW1WgcDN+0T0PTBb8Py5  CuWiUFQ4spQyqkRXi9Y1JT4g3+tAFHEpyCjZttoZivWE5gF/sL8IpG4pUmcVOwut  yjiWW7yglPSVLsqIyCP4ooFJGQ8Bokx7k+zORlrLfAJC+F6fwIe/RyxjZOdD88S9......    [path] =&gt; /var/virtualizor/ssh-keys/  )</code></pre><p>下一步，您需要将公钥添加到备份服务器的<strong> /root/中。ssh/authorized_keys </strong>喜欢下面的命令:</p><pre><code class="language-bash">&lt;?php    require_once('/usr/local/virtualizor/sdk/admin.php');    $key = 'your_api_key';  $pass = 'your_api_pass';  $ip = 'your_server_ip';    $admin = new Virtualizor_Admin_API($ip, $key, $pass);    $post = array();  $post['hostname'] = 'testhost';  $post['name'] = 'backupstest';  $post['type'] = 'SSH';  $post['username'] = 'test';  $post['password'] = 'test123';  $post['gen_key'] = 1; //pass only if you want to generate new keys  $post['ssh_key'] = 1; //pass only if you want to use keys to authenticate  $post['sshpub_key'] = 'YOUR PUBLIC KEY'; //pass only if ssh_key is set  $post['sshpri_key'] = 'YOUR PRIVATE KEY'; //pass only if ssh_key is set  $post['port'] = 22;    $output = $admin-&gt;addbackupserver($post);    print_r(json_encode($output));  ?&gt;</code></pre><h2><span class="ez-toc-section" id="Create_the_Backup_Service_in_virtualizor"/> <strong>在虚拟器中创建备份服务</strong> <span class="ez-toc-section-end"/></h2><p>如下图所示，添加备份服务器后，您需要创建一个备份计划。</p><p><strong> Virtualizor管理面板&gt; &gt;计划(菜单)&gt; &gt;添加备份计划</strong></p><p> </p><p><img data-lazyloaded="1" src="../Images/baccf82376fbdc8c84054e03f00615f7.png" decoding="async" loading="lazy" class="aligncenter wp-image-43030 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/Add_Backup_Plan-with-virtualizor.webp" alt="Add_Backup_Plan-with-virtualizor" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/Add_Backup_Plan-with-virtualizor.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2023/02/Add_Backup_Plan-with-virtualizor-300x139.webp 300w, https://blog.eldernode.com/wp-content/uploads/2023/02/Add_Backup_Plan-with-virtualizor-768x357.webp 768w" data-sizes="(max-width: 1024px) 100vw, 1024px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/Add_Backup_Plan-with-virtualizor.webp"/></p><p> </p><p>在下一步中，您需要将备份计划分配给VPS。有趣的是，可以将备份计划分配给单个VPS或VPS计划。</p><p>要将备份程序分配给特定的VPS，您可以通过参考以下路径来编辑VPS:</p><p><strong> Virtualizor管理面板&gt; &gt;虚拟服务器(菜单)&gt; &gt;列表全部- &gt; &gt;编辑</strong></p><p>如下所示，打开高级选项块，然后选择之前创建的备份计划:</p><p> </p><p><img data-lazyloaded="1" src="../Images/1e056cefb77f7585ee88f0f3c9bf67fd.png" decoding="async" loading="lazy" class="aligncenter wp-image-43031 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/2Add_Backup_Plan.webp" alt="2Add_Backup_Plan" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/2Add_Backup_Plan.webp 515w, https://blog.eldernode.com/wp-content/uploads/2023/02/2Add_Backup_Plan-300x46.webp 300w" data-sizes="(max-width: 515px) 100vw, 515px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/2Add_Backup_Plan.webp"/></p><p> </p><p>请注意，为了将备份计划分配给VPS计划，您必须参考以下路径来编辑VPS计划:</p><p><strong> Virtualizor管理面板&gt; &gt;计划(菜单)&gt; &gt;列出计划&gt; &gt;编辑</strong></p><p> </p><p><img data-lazyloaded="1" src="../Images/df72ade4f41a5f31874be32b683c0f5f.png" decoding="async" loading="lazy" class="aligncenter wp-image-43032 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2023/02/3Add_Backup_Plan.webp" alt="3Add_Backup_Plan" data-srcset="https://blog.eldernode.com/wp-content/uploads/2023/02/3Add_Backup_Plan.webp 551w, https://blog.eldernode.com/wp-content/uploads/2023/02/3Add_Backup_Plan-300x31.webp 300w" data-sizes="(max-width: 551px) 100vw, 551px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2023/02/3Add_Backup_Plan.webp"/></p><p> </p><h3><span class="ez-toc-section" id="How_to_Configure_Backup_Service_with_Virtualizor"/> <strong>如何用虚拟器配置备份服务</strong> <span class="ez-toc-section-end"/></h3><p>在这一节中，我们将解释Virtualizor中的备份设置。这个描述是基于本帖的第一张图片。</p><p><strong>–禁用:</strong>禁用备份程序。请注意，禁用备份程序不会从cron运行它。此外，最终用户不能备份/恢复分配给此计划的所有VP。</p><p><strong>–备份服务器:</strong>上传VPS备份的备份服务器的名称。</p><p><strong>–目录:</strong>这是VPS备份在备份服务器上存储的目录。</p><p><strong>–备份频率:</strong>通过选择此部分中的一个选项，可以设置每小时、每天、每周、每月或手动备份过程。</p><p><strong>–备份轮换:</strong>设置备份轮换。例如，如果rotation设置为2，VPS的最后两个备份将保留在服务器上。</p><p><strong>–最终用户备份:</strong>创建尽可能多的备份。您可以设置备份副本数量的限制。</p><p><strong>–最终用户恢复:</strong>根据用户需要创建任意数量的恢复副本。您可以设置恢复副本数量的限制。</p><p><strong>–进程优先级:</strong>决定备份进程的优先级。较高的值表示低优先级，较低的负值表示高优先级。</p><p><strong>–进程I/O优先级:</strong>优先级越高，磁盘时间越长。</p><p><strong>–禁用压缩:</strong>这会减少CPU的使用，但会增加备份过程中的IO使用。需要注意的重要一点是，选择此选项会增加VPS备份的大小。</p><p>最后，您可以从以下路径搜索备份过程日志文件的故障排除/报告:</p><p><strong>/var/virtualizor/log/backup/VPS id . log</strong></p><p><strong>/var/virtualizor/log/restore/VPS id . log</strong></p><h2><span class="ez-toc-section" id="How_to_Start_Backup"/> <strong>如何启动备份</strong> <span class="ez-toc-section-end"/></h2><p>要开始备份过程，您必须仔细遵循前面几节中提到的所有步骤。然后从控制台运行以下命令，以便立即完成备份过程:</p><pre><code class="language-bash">/usr/local/emps/bin/php /usr/local/virtualizor/scripts/vpsbackups_plan.php -b&lt;backup-plan-id&gt; [options]</code></pre><p><strong>选项:</strong></p><p>-f强制备份，即使备份计划被禁用</p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>注意，Virtualizor本身并不是一个虚拟器。Virtualizor只是一个控制面板。也就是说，它使用虚拟化技术来创建虚拟机或VPS，并自动执行分配它的步骤。由于使用此控制面板的重要性，有必要学习如何通过Virtualizor进行备份。在本文中，我们试图教你如何用Virtualizor创建备份服务。如果你有任何问题，你可以在评论区和我们分享。</p></div></div>    
</body>
</html>