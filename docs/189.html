<html>
<head>
<title>How to work with the Test-NetConnection command in PowerShell - Eldernode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在PowerShell - Eldernode中使用Test-NetConnection命令</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/test-netconnection-command-in-powershell/#0001-01-01">https://blog.eldernode.com/test-netconnection-command-in-powershell/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/d4bddb5113757c695d210c5faa7b368e.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="how to work with the test-netconnection command in powershell" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-work-with-the-Test-NetConnection-command-in-PowerShell-1.png"/><p>如何在PowerShell中使用<span> Test-NetConnection </span>命令。在继续的<a href="http://eldernode.com/tag/powershell-commands/"> PowerShell教程</a>中，在这篇文章中，我们将教你如何在PowerShell中使用<span> Test-NetConnection </span>命令。</p><p>在上一篇文章中，我们教了<a href="https://eldernode.com/set-up-windows-network-with-powershell/">如何通过PowerShell </a>设置网络，您已经熟悉了一些设置IP地址的命令，等等。<span>在本文</span>中，我们将解释一个可以用来测试网络的命令。您可能熟悉诸如<a href="https://en.wikipedia.org/wiki/Ping_(networking_utility)"> Ping </a>、<a href="https://support.microsoft.com/en-us/help/314868/how-to-use-tracert-to-troubleshoot-tcp-ip-problems-in-windows"> tracert </a>或<a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/netstat"> NetStat </a>之类的命令，并见过它们在CMD或其他操作系统中的使用。</p><p>在<span> PowerShell </span>中，可以使用CMD命令。PowerShell和它的其他命令一样，提供了一个用于处理网络的特定命令，类似于CMD命令的功能，但有时会提供更完整的信息。</p><p>继续阅读，了解如何在PowerShell中使用<span> Test-NetConnection </span>命令。</p><p> </p><p><a href="https://eldernode.com/windows-vps/"> <strong>买Windows VPS托管，便宜的Windows VPS </strong> </a></p><p> </p><h2><span class="ez-toc-section" id="Working_with_the_Test-NetConnection_command_in_PowerShell"/>在PowerShell中使用Test-NetConnection命令<span class="ez-toc-section-end"/></h2><p><span> PowerShell命令</span>与<span> CMD命令</span>相同，但是具有不同的功能，您将在下面看到。</p><h3><span class="ez-toc-section" id="Test-NetConnection_command"/>测试网络连接命令<span class="ez-toc-section-end"/></h3><p><span> Test-NetConnection </span>命令是CMD中几个常用网络命令的组合，有几个参数。该命令的一般<span>结构</span>与其他PowerShell命令相同，输入命令后可以输入所需的参数或值。</p><p>参见下面的<span>示例</span>了解更多关于该命令的信息。</p><p> </p><h4><span class="ez-toc-section" id="Example_for_the_Test-NetConnection_command"/>测试网络连接命令的例子<span class="ez-toc-section-end"/></h4><p>您可以使用以下命令在PowerShell中ping一个IP地址。</p><pre><code class="language-bash">Test-NetConnection 192.18.1.1</code></pre><p> </p><p>以下命令用于根据<span>计算机名</span>或<span>域</span>执行ping操作。</p><pre><code class="language-bash">Test-NetConnection –ComaputerName google.com</code></pre><p> </p><p>PowerShell结构特性将允许您输入IP的<span>范围，以便PowerShell可以ping通所有IP。</span></p><pre><code class="language-bash">1..99 | % { Test-NetConnection -ComputerName 192.168.1.$_ } | FT –AutoSize</code></pre><p> </p><p>在<span>上面的命令</span>中，<span>的值为1..99 </span>是IP地址的最后一个<strong>号，而<span> x.x.x </span>是<strong>网络地址</strong>，您可以在这里输入您想要的值。PowerShell将分别ping范围<strong> 192.168.1.1 </strong>到<strong> 192.168.1.99 </strong>的所有IP地址。</strong></p><p>该功能是<span> Test-NetConnection </span>命令最简单的功能。在下面，我们将解释这个命令的其他参数。</p><p> </p><h4><span class="ez-toc-section" id="TraceRoute_parameter"/> TraceRoute参数<span class="ez-toc-section-end"/></h4><p>在Tracert网络中广泛使用的命令之一是PowerShell，它已经成为<span> Test-NetConnection </span>命令的参数。要使用<span> tracert </span>，您可以进行如下操作。以下命令将与<span> Tracert命令</span>完全相同。</p><pre><code class="language-bash">Test-NetConnection www.google.com –Traceroute</code></pre><p> </p><h4><span class="ez-toc-section" id="State_parameter"/>状态参数<span class="ez-toc-section-end"/></h4><p>CMD中存在的另一个在PowerShell中用作参数的命令是<span> Netstat命令</span>，它通过<span>状态</span>在<a href="https://docs.microsoft.com/en-us/powershell/"> PowerShell </a>中执行，并恢复所有<span>建立的</span>连接</p><pre><code class="language-bash">Test-NetConnection –State Established</code></pre><p> </p><h4><span class="ez-toc-section" id="Port_parameter"/>端口参数<span class="ez-toc-section-end"/></h4><p>你将能够使用这个参数来<strong>检查</strong>一台<span>计算机上的特定端口</span>。</p><pre><code class="language-bash">Test-NetConection –ComputerName google.com –Port 80</code></pre><p>这个<span>命令</span>将<strong>在<strong>Google.com</strong>服务器上检查</strong>端口80 的<span>状态，并最终提供有关该端口的信息。</span></p><p>通过这个命令，您还可以使用<span>common support</span>参数来扫描特定服务上的所有端口。</p><p><span>例如</span>，在下面的命令中，我们希望<strong> HTTP端口</strong>搜索<strong> 192.168.1.10服务器</strong>。</p><pre><code class="language-bash">Test-NetConnection 192.168.1.10 –CommonTCPPort http</code></pre><p>输入上述命令后，PowerShell开始扫描上述系统的所有端口。只要它能找到<strong> HTTP服务</strong>所在的端口，它就会<span>输出</span>给你。</p><p>您可以使用<span>Test-net connection</span>命令及其其他应用程序参数，并且不再为此使用附加组件。</p><p>使用PowerShell中的命令后的<strong>获取关于<span>的信息、其他参数</span>以及Test-NetConnection命令的其他示例:</strong></p><pre><code class="language-bash">Get-Help Test-NetConnection –detailed</code></pre><p> </p><p><span> <strong>亦作，见:</strong> </span></p><p><a href="https://eldernode.com/introduction-to-windows-powershell/">Windows PowerShell简介</a></p><p><a href="https://eldernode.com/important-powershell-commands/">了解重要的PowerShell命令</a></p><p><a href="https://eldernode.com/powershell-commands-for-hard-disk/">使用硬盘的PowerShell命令</a></p><p> </p><p><strong>尊敬的用户</strong>，我们希望您能喜欢这个<a href="https://eldernode.com/category/tutorial/">教程</a>，您可以在评论区提出关于本次培训的问题，或者解决<a href="https://eldernode.com/blog/">老年人节点培训</a>领域的其他问题，请参考<a href="https://eldernode.com/ask">提问页面</a>部分，并尽快提出您的问题。腾出时间给其他用户和专家来回答你的问题。</p><p><span>好运</span>。</p></div></div>    
</body>
</html>