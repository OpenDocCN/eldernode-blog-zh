<html>
<head>
<title>How to Install Samba on Linux/Windows -</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Linux/Windows上安装Samba</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-samba-on-linux-windows/#0001-01-01">https://blog.eldernode.com/install-samba-on-linux-windows/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/519e96bb5647b857687fcf217bd6c408.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Install Samba on Linux-Windows" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-Linux-Windows.png"/><p>如何在Linux/Windows上安装Samba？Samba是免费的开源软件，它允许文件在Windows和T2 Linux系统间简单方便地共享。确切的说，它是<span>对<a href="https://en.wikipedia.org/wiki/Server_Message_Block#:~:text=In%20computer%20networking%2C%20Server%20Message,between%20nodes%20on%20a%20network."><span>SMB</span></a>/<a href="https://cifs.com/#:~:text=Common%20Internet%20File%20System%20(CIFS,files%20on%20the%20remote%20server."><span>CIFS</span></a>协议的一个</span>开源实现。</p><p>(<span> CIFS </span> ) <strong>通用互联网文件系统</strong>协议是<span> SMB协议</span>的一种方言。描述一个协议的不同变体的消息包的集合被称为方言。</p><p>(<span> SMB </span> ) <strong>服务器消息块</strong>协议是一种<span>客户端-服务器</span>通信协议，用于共享对文件、打印机、串行端口和网络上其他资源的访问。</p><p>使用<span> <strong> Samba </strong> </span>时，可以在<span> Linux </span> / <span> Unix </span>服务器和Windows客户端之间共享文件和打印服务、用户认证和授权、名称解析、服务公告。</p><p> </p><p><strong> <a href="https://eldernode.com/vps/">购买VPS，便宜的VPS托管服务器带即时激活</a> </strong></p><p> </p><h2><span class="ez-toc-section" id="The_Main_Tasks_of_Samba"/>桑巴的主要任务<span class="ez-toc-section-end"/></h2><p><span> <strong> 1。</strong> </span>与<span> Windows <span>机器</span> </span>共用一个<span> Linux驱动</span>。</p><p><strong> <span> 2。</span> </strong>用<span> Linux </span>机器访问<span> SMB共享</span>。</p><p><strong> <span> 3。</span> </strong>与<span> Windows </span>机器共用一台<span> Linux打印机</span>。</p><p><strong> <span> 4。</span> </strong>与<span> Linux </span>机器共用一台<span> Windows打印机</span>。</p><p><strong> <span> 5。</span> </strong>在<span> Unix </span> / <span> Linux </span>服务器上设置<span>域控制器</span>，并将<strong> Windows客户端</strong>集成到<span>域控制器</span>。</p><p>Samba还可以充当域控制器或常规域成员。如果你有一个混合的网络环境，包含了Windows和T2的Linux计算机，那么这个选项使得Samba几乎成为一个必备组件。</p><h2><span class="ez-toc-section" id="Introduction_before_installation"/>安装前介绍<span class="ez-toc-section-end"/></h2><p>为了<strong>安装Samba </strong>，你需要<strong>以拥有<span> Sudo </span>权限的用户，或者作为<span> root </span>用户，登录</strong>你的<span> Linux服务器</span>。</p><p><span> <strong>注:</strong> </span>为了简化本教程中的步骤，我们将使用<span>根用户</span>。</p><p>如果您决定以您的用户身份(拥有sudo权限)安装软件，不要忘记在每个命令的开头键入<span> Sudo </span>命令。</p><p>你还需要一台<span> Windows电脑</span>，我们将把<span>从</span> / <span>连接到</span>。</p><p> </p><h3><span class="ez-toc-section" id="Installation_of_Samba_on_CentOS_7"/>在CentOS 7上安装Samba<span class="ez-toc-section-end"/></h3><p>由于在<span> CentOS </span>和其他基于<span> RedHat </span>的发行版上的安装大多使用<strong> yum工具</strong>进行最佳管理，我们将使用它在我们的<span> CentOS 7 </span>上安装Samba并更新我们的系统。</p><p>首先让我们<span>删除所有可能仍在<span>系统中缓存</span>的包</span>。</p><p>要从任何已启用的存储库中一次性清除所有缓存文件，我们将使用以下命令:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="13617c7c67537b7c6067">[email protected]</a> ~]# yum clean all</code></pre><p>接下来，让我们确保我们所有的系统包都已更新。</p><p>我们使用<span> -y标志</span>对任何提示进行<strong>自动确认</strong>:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e4c51514a7e56514d4a">[email protected]</a> ~]# yum -y update</code></pre><p> </p><p>现在，您可以继续进行<span> Samba安装</span>。</p><p>注意我们如何再次使用<span> -y标志</span>来<strong>自动确认</strong>安装提示。</p><p>使用以下命令可以轻松安装Samba :</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="beccd1d1cafed6d1cdca">[email protected]</a> ~]# yum -y install samba samba-client samba-common</code></pre><p>Yum 就是这样一个伟大的工具，它会自动安装<span> Samba </span>所需的任何依赖项。</p><p>在安装输出的最后，您应该会看到类似于以下输出的内容:</p><pre><code class="language-bash">Installed:  samba.x86_64 0:4.9.1-10.el7_7 samba-client.x86_64 0:4.9.1-10.el7_7 samba-common.noarch 0:4.9.1-10.el7_7    Dependency Installed:  libsmbclient.x86_64 0:4.9.1-10.el7_7 libwbclient.x86_64 0:4.9.1-10.el7_7  samba-client-libs.x86_64 0:4.9.1-10.el7_7 samba-common-libs.x86_64 0:4.9.1-10.el7_7  samba-common-tools.x86_64 0:4.9.1-10.el7_7 samba-libs.x86_64 0:4.9.1-10.el7_7    Complete!</code></pre><p> </p><p>安装完成后，可以<span>检查Samba版本</span>:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="99ebf6f6edd9f1f6eaed">[email protected]</a> ~]# smbd --version  Version 4.9.1</code></pre><p> </p><h3><span class="ez-toc-section" id="How_to_Configure_Samba"/>如何配置Samba <span class="ez-toc-section-end"/></h3><p>安装<span>桑巴</span>后，你需要<span> <strong>配置</strong> </span>来符合你的设置和标准。</p><p><span> <strong>注意:</strong> </span>在您<span>在我们的<strong> Linux机器</strong>上用S <span> amba配置</span>开始</span>之前，您需要在您的<strong> Windows计算机</strong>上验证<span>工作组</span>。</p><p>要在您的<span> Windows电脑</span>上<span>确认</span>T2工作组，请执行以下操作:</p><p><strong> <span> 1。</span> </strong> <strong>在<span>这台电脑</span>或者<span>我的电脑</span>上右键</strong>。</p><p><strong> <span> 2。</span> </strong>点击<span>属性</span>。</p><p><strong> <span> 3。</span>T3选择<span>高级系统设置</span>。</strong></p><p><span> <strong> 4。</strong> </span> <span>电脑名称</span>将显示以下窗口，显示您需要的数据。</p><p> </p><p><img data-lazyloaded="1" src="../Images/fc6d753efb0863d5679db02fb2d11c72.png" decoding="async" loading="lazy" class="aligncenter wp-image-10157 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-1.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-1.png 407w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-1-261x300.png 261w" data-sizes="(max-width: 407px) 100vw, 407px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-1.png"/></p><p> </p><p>您也可以<strong>运行</strong> <span> cmd </span>(从<span>窗口开始</span>框)并运行以下命令:</p><pre><code class="language-bash">net config workstation</code></pre><p>上面的<span>命令</span>将<span>显示你需要的关于<strong>工作站域</strong>的信息</span>。</p><p>您将看到类似下图的内容:</p><p> </p><p><img data-lazyloaded="1" src="../Images/e1dfb2c3a540c2ba32e21d1c9c0df20e.png" decoding="async" loading="lazy" class="aligncenter wp-image-10158 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-2.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-2.png 512w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-2-300x157.png 300w" data-sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-2.png"/></p><p> </p><p>现在您已经有了关于Windows计算机工作组的信息，您可以继续在您的<span> Linux系统</span>上进行<strong> Samba配置</strong>。</p><p><span> Samba配置</span>文件可以在/<span>etc</span>/<span>Samba</span>/<span>SMB . conf</span>找到。</p><p> </p><p><span> <strong>注意:</strong> </span>在我们进行任何更改之前，请确保创建一个<span>备份</span>原始配置文件的副本。</p><p>为了<strong>创建原始配置文件<span> smb.conf </span>的备份</strong>，您将使用以下命令创建一个名为<span> smb.conf_orig </span>的备份副本:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="96e4f9f9e2d6fef9e5e2">[email protected]</a> ~]# cp /etc/samba/smb.conf /etc/samba/smb.conf_orig</code></pre><p>我们将通过为<span>匿名文件共享</span>服务配置Samba来<span>启动</span>。</p><p>在这个共享中，任何用户都可以读写。我们将首先创建一个名为“<span>匿名共享目录</span>的<strong>目录</strong>，我们的文件将存储在这里:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d3f2222390d25223e39">[email protected]</a> ~]# mkdir -p /samba/anonymous_shared_directory</code></pre><p>现在，你需要申请<span>适当的权限</span>在你的目录上:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6614090912260e091512">[email protected]</a> ~]# chmod -R 0775 /samba/anonymous_shared_directory  [<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="31435e5e4571595e4245">[email protected]</a> ~]# chown -R nobody:nobody /samba/anonymous_shared_directory</code></pre><p> </p><p> </p><p>如果您正在使用<span> SELinux </span>，您将需要为<strong> samba共享目录</strong>更改<span> SELinux安全上下文</span>:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f3819c9c87b39b9c8087">[email protected]</a> ~]# chcon -t samba_share_t /samba/anonymous_shared_directory</code></pre><p>要对您的配置文件进行所需的<span>更改</span>，您需要<strong>用首选的<span> CLI文本编辑器</span> ( <a href="https://eldernode.com/connect-to-nano-server/"> Nano </a>或<a href="https://eldernode.com/use-vi-full-text-editor/"> Vim </a>)打开</strong>the/<span>etc</span>/<span>samba</span>/<span>SMB . conf</span>文件。</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="35475a5a41755d5a4641">[email protected]</a> ~]# vim /etc/samba/smb.conf</code></pre><p>现在我们将通过<strong>添加</strong>和<strong>编辑</strong>以下指令来<span>配置</span>我们的<span>匿名份额</span>:</p><pre><code class="language-bash">[global]  workgroup = WORKGROUP  security = user  netbios name = centos7  printcap name = cups  idmap config * : backend = tdb  cups options = raw  map to guest = bad user    [Anonymous]  comment = anonymous file share  path = /samba/anonymous_shared_directory  browseable = yes  writable = yes  guest ok = yes  guest only = yes  read only = no  force user = nobody</code></pre><p>您的<span> Samba配置</span>文件现在应该如下所示:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="93e1fcfce7d3fbfce0e7">[email protected]</a> samba]# cat /etc/samba/smb.conf    # See smb.conf.example for a more detailed config file or  # read the smb.conf manpage.  # Run 'testparm' to verify the config is correct after  # you modified it.    [global]  workgroup = WORKGROUP  security = user  netbios name = centos7  printcap name = cups  idmap config * : backend = tdb  cups options = raw  map to guest = bad user    [Anonymous]  comment = anonymous file share  path = /samba/anonymous_shared_directory  browseable = yes  writable = yes  guest ok = yes  guest only = yes  read only = no  force user = nobody    [homes]  comment = Home Directories  valid users = %S, %D%w%S  browseable = No  read only = No  inherit acls = Yes    [printers]  comment = All Printers  path = /var/tmp  printable = Yes  create mask = 0600  browseable = No    [print$]  comment = Printer Drivers  path = /var/lib/samba/drivers  write list = @printadmin root  force group = @printadmin  create mask = 0664  directory mask = 0775</code></pre><p><span> <strong>注意:</strong> </span>不要忘记<span>保存</span>所做的修改并<strong>关闭</strong><span>文本编辑器</span>。</p><p> </p><p> </p><p>为了<strong>验证</strong>您当前的samba设置，运行以下命令:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a1d3ceced5e1c9ced2d5">[email protected]</a> samba]# testparm  rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)  Registered MSG_REQ_POOL_USAGE  Registered MSG_REQ_DMALLOC_MARK and LOG_CHANGED  Load smb config files from /etc/samba/smb.conf  rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)  Processing section "[Anonymous]"  Processing section "[homes]"  Processing section "[printers]"  Processing section "[print$]"  Loaded services file OK.  Server role: ROLE_STANDALONE</code></pre><p>按<span>回车</span>来查看服务定义的<span>转储</span>。</p><p><span>在</span>你继续<strong>启动</strong>这个<span>桑巴服务</span>之前，你需要<span>配置你的防火墙</span>来配合它工作。</p><p>如何在Linux/Windows上安装Samba？</p><p>Samba需要打开以下<span>端口</span>才能正常运行:</p><pre><code class="language-bash">Port 137 (TCP) - netbios-ns - NETBIOS Name Service  Port 138 (TCP) - netbios-dgm - NETBIOS Datagram Service  Port 139 (TCP) - netbios-ssn - NETBIOS session service  Port 445 (TCP) - microsoft-ds - if you are using Active Directory</code></pre><p>并且:</p><pre><code class="language-bash">Port 389 (TCP) - for LDAP (Active Directory Mode)  Port 445 (TCP) - NetBIOS was moved to 445 after 2000 and beyond, (CIFS)  Port 901 (TCP) - for SWAT service (not related to client communication)</code></pre><p>我们将从配置<span> csf.conf </span>文件开始。</p><p>让我们用您选择的文本编辑器<strong>打开</strong>我们的<span> csf配置</span>文件:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c4b6ababb084acabb7b0">[email protected]</a> ~]# vim /etc/csf/csf.conf</code></pre><p>现在，确保将端口添加到适当的部分:</p><pre><code class="language-bash"># Allow incoming TCP ports  TCP_IN = "20,21,25,53,80,110,139,143,443,445,465,587,993,995,53835"  # Allow outgoing TCP ports  TCP_OUT = "20,21,25,53,80,110,139,143,113,443,445,587,993,995,53835"</code></pre><p><span>保存</span>更改并<span>重新加载</span>防火墙规则:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4634292932062e293532">[email protected]</a> ~]# csf -r</code></pre><p>如果您正在运行<span>防火墙服务</span>，只需<strong>使用以下命令添加服务</strong>:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80f2efeff4c0e8eff3f4">[email protected]</a> ~]# firewall-cmd --permanent --zone=public --add-service=samba</code></pre><p><span>重新加载</span>防火墙服务:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3f4d50504b7f57504c4b">[email protected]</a> ~]# firewall-cmd --reload</code></pre><p> </p><p>启动Samba服务，并确保它在系统启动时自动启动。</p><p>桑巴使用<strong>两个</strong> <strong>系统</strong> <strong>服务</strong>来运行:</p><p><span> <strong> 1。</strong></span><strong>SMB . service:</strong>实现了监听<strong>端口</strong> <span> 139 </span>和<span> 445 </span>的<span>文件共享</span>和<span>打印</span>服务。</p><p><strong> <span> 2。</span></strong><strong>nmb . service:</strong>实现<span>NetBIOS</span>over<span>IP naming</span>服务给客户端，监听<span>端口137 </span>。<strong> <br/> </strong></p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2e5c41415a6e46415d5a">[email protected]</a> ~]# systemctl start smb.service  [<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="790b16160d3911160a0d">[email protected]</a> ~]# systemctl start nmb.service</code></pre><p><span> <strong>注意:</strong> </span>为了确保这些服务在系统启动时自动启动，您需要<span>启用</span>它们:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="582a37372c1830372b2c">[email protected]</a> ~]# [<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="85f7eaeaf1c5edeaf6f1">[email protected]</a> ~]# systemctl enable smb.service  Created symlink from /etc/systemd/system/multi-user.target.wants/smb.service to /usr/lib/systemd/system/smb.service.  [<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="53213c3c27133b3c2027">[email protected]</a> ~]# systemctl enable nmb.service  Created symlink from /etc/systemd/system/multi-user.target.wants/nmb.service to /usr/lib/systemd/system/nmb.service.</code></pre><p> </p><p>为了<span>测试</span>你新<span>实现的匿名分享</span>做以下事情:</p><p><span> <strong> 1。</strong> </span>转到Windows电脑</p><p><strong> <span> 2。</span> </strong>点击<span>开始</span>-&gt;-<span>运行</span>，我们要输入的是服务器的IP地址，就像这样。</p><p><strong> <span> 3。</span>T3按下<span>确定</span>。您的匿名目录将显示在<span>文件浏览器</span>中。</strong></p><p><strong> <span> 4。</span> </strong> <strong>双击</strong>进入目录，然后<strong>右键</strong>创建一个<span>新文本文档</span>。</p><p><strong> <span> 5。</span> </strong>选择一个文件名然后<span>保存</span>它。(为此，我们将我们的文件命名为<span> testfile </span>。)</p><p>确保<span>新文件</span>在你的<span> Linux机器</span>上也是可用的:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="55273a3a21153d3a2621">[email protected]</a> ~]# [<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0674696972466e697572">[email protected]</a> ~]# ls -l /samba/anonymous_shared_directory  total 0  -rwxr--r--. 1 nobody nobody 0 Mar 30 22:03 testfile.txt</code></pre><p>如何在Linux/Windows上安装Samba？</p><p> </p><h2><span class="ez-toc-section" id="How_to_Configure_Samba_for_Private_Shares"/>如何为私有股份配置Samba】</h2><p>这种类型的共享需要一个<span>用户名</span>和一个<span>密码</span>才能访问。我们需要<strong>创建</strong>一个<span>用户</span> / <span>组</span>的用户，他们被允许访问我们的共享。</p><p>一旦我们为我们的Samba用户建立了一个组，我们就可以很容易地一次为他们分配任何需要的特权。</p><p>要<span>创建一个新组</span>,使用以下命令:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4c3e2323380c24233f38">[email protected]</a> ~]# groupadd sambausergroup</code></pre><p>我们现在已经成功地为我们的用户创建了一个名为<span> sambausergroup </span>的组。让我们继续并创建我们的用户。</p><p>我们将它命名为<span> newtestuser </span>，我们将在一个命令中将它分配给我们的组，同时拒绝他的shell访问。</p><p><span> Samba用户账户</span>与系统账户分开，所以我们打算只授予Samba特权的用户不需要shell <span>访问</span> / <span>密码</span>。</p><p>如果你决定合并，你可以<strong>安装</strong> " <span> samba-winbind </span>软件包，它用于将系统用户和密码与samba用户数据库同步，以及其他功能。</p><p>如何在Linux/Windows上安装Samba？</p><p> </p><p> </p><p>要添加您的用户,请使用以下命令:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="691b06061d2901061a1d">[email protected]</a> ~]# useradd -s /sbin/nologin -g sambausergroup newtestuser</code></pre><p>我们的用户访问我们的共享还需要一个密码，所以让<span>为他创建一个Samba访问</span> <span>密码</span>:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7c0e1313083c14130f08">[email protected]</a> ~]# smbpasswd -a newtestuser  New SMB password:  Retype new SMB password:  Added user newtestuser.</code></pre><p>这个受密码保护的共享的Samba用户现在需要一个地方来存储他们的文件，所以我们需要为他们创建一个目录。</p><p>这个将被称为“<span>密码保护目录</span>”:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="10627f7f6450787f6364">[email protected]</a> samba]# mkdir -p /samba/password_protected_directory</code></pre><p>来自我们创建的组<span> sambausergroup </span>的用户需要读取、写入和执行该目录中的文件的权限，因此我们将使用以下命令授予他们这些权限:</p><pre><code class="language-bash"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="33415c5c47735b5c4047">[email protected]</a> samba]# setfacl -R -m "g:sambausergroup:rwx" /samba/password_protected_directory</code></pre><p>您还需要对这个应用<span> SELinux </span>安全上下文:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6d1f0202192d05021e19">[email protected]</a> samba]# chcon -t samba_share_t /samba/password_protected_directory/</code></pre><p>打开<span> Samba配置</span>文件，<strong>为我们的私有共享添加</strong>设置:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b4c6dbdbc0f4dcdbc7c0">[email protected]</a> ~]# vim /etc/samba/smb.conf</code></pre><pre><code class="language-bash">[Password Protected]  comment = needs username and password to access  path = /samba/password_protected_directory  valid users = @sambausergroup  guest ok = no  writable = yes  browsable = yes</code></pre><p><span>完整配置</span>文件现在将如下所示:</p><pre><code class="language-bash"># See smb.conf.example for a more detailed config file or  # read the smb.conf manpage.  # Run 'testparm' to verify the config is correct after  # you modified it.    [global]  workgroup = WORKGROUP  security = user  netbios name = centos7  printcap name = cups  idmap config * : backend = tdb  cups options = raw  map to guest = bad user    [Password Protected]  comment = needs username and password to access  path = /samba/password_protected_directory  valid users = @sambausergroup  guest ok = no  writable = yes  browsable = yes    [Anonymous]  comment = anonymous file share  path = /samba/anonymous_shared_directory  browseable = yes  writable = yes  guest ok = yes  guest only = yes  read only = no  force user = nobody    [homes]  comment = Home Directories  valid users = %S, %D%w%S  browseable = No  read only = No  inherit acls = Yes    [printers]  comment = All Printers  path = /var/tmp  printable = Yes  create mask = 0600  browseable = No    [print$]  comment = Printer Drivers  path = /var/lib/samba/drivers  write list = @printadmin root  force group = @printadmin  create mask = 0664  directory mask = 0775</code></pre><p>现在您可以用<span> testparm </span>命令测试您的配置:</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d7a5b8b8a397bfb8a4a3">[email protected]</a> samba]# testparm  rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)  Registered MSG_REQ_POOL_USAGE  Registered MSG_REQ_DMALLOC_MARK and LOG_CHANGED  Load smb config files from /etc/samba/smb.conf  rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)  Processing section "[Password Protected]"  Processing section "[Anonymous]"  Processing section "[homes]"  Processing section "[printers]"  Processing section "[print$]"  Loaded services file OK.  Server role: ROLE_STANDALONE</code></pre><p>按<span>回车</span>来查看你的服务定义的转储。</p><p>对于<strong>测试</strong>，从你的<span> Windows电脑</span>连接，点击<span>开始</span>–&gt;<span>运行</span>和<span>输入你的服务器IP</span>\ \ serverIP—&gt;<span>Ok</span>。</p><p> </p><p><img data-lazyloaded="1" src="../Images/584ad4ff280f3e4fee13648d46e63087.png" decoding="async" loading="lazy" class="aligncenter wp-image-10159 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-3.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-3.png 399w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-3-300x155.png 300w" data-sizes="(max-width: 399px) 100vw, 399px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-3.png"/></p><p>现在，你将拥有<span>匿名目录</span>和<span>密码保护目录</span>:</p><p> </p><p><img data-lazyloaded="1" src="../Images/13205c0b909b9520a84bd36363cc8cbf.png" decoding="async" loading="lazy" class="aligncenter wp-image-10160 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-4.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-4.png 512w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-4-300x196.png 300w" data-sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-4.png"/></p><p> </p><p><strong>双击<span>密码保护目录</span>上的</strong>会打开如下提示，我们需要在这里输入我们的<span> newtestuser </span>凭证:</p><p> </p><p><img data-lazyloaded="1" src="../Images/1ecda298bd185ff17e9fc1e61114fd22.png" decoding="async" loading="lazy" class="aligncenter wp-image-10161 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-5.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-5.png 453w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-5-300x234.png 300w" data-sizes="(max-width: 453px) 100vw, 453px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-5.png"/></p><p> </p><p>为了确保一切正常运行，请<span>在您的密码保护目录中创建一个新目录</span>:</p><p> </p><p><img data-lazyloaded="1" src="../Images/314fb0806f43398615b36b6fa5ed068a.png" decoding="async" loading="lazy" class="aligncenter wp-image-10162 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-6.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-6.png 512w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-6-300x205.png 300w" data-sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-6.png"/></p><p> </p><p>为了这个目的，这个将被命名为<span> test_directory f </span>。</p><p> </p><p><img data-lazyloaded="1" src="../Images/1a4c75e40e7fd3deff93b7b58411fe5c.png" decoding="async" loading="lazy" class="aligncenter wp-image-10163 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-7.png" alt="How to Install Samba on Linux-Windows" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-7.png 512w, https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-7-300x236.png 300w" data-sizes="(max-width: 512px) 100vw, 512px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/08/How-to-Install-Samba-on-LinuxWindows-7.png"/></p><p> </p><p>最后，<strong>从你的<span> Linux机器</span>上确认</strong>你的<span>目录</span>的存在。</p><pre><code class="language-bash">[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80f2efeff4c0e8eff3f4">[email protected]</a> /]# ls -l /samba/password_protected_directory/  total 0  drwxr-xr-x. 2 newtestuser sambausergroup 6 Apr 3 21:12 test_directory</code></pre><p> </p><p><strong>尊敬的用户</strong>，我们希望您能喜欢这个<a href="https://eldernode.com/category/tutorial/">教程</a>，您可以在评论区提出关于本次培训的问题，或者解决<a href="https://eldernode.com/blog/">老年人节点培训</a>领域的其他问题，请参考<a href="https://eldernode.com/ask">提问页面</a>部分，并尽快提出您的问题。腾出时间给其他用户和专家来回答你的问题。</p><p>如何在Linux/Windows上安装Samba？</p><p><span>好运</span>。</p></div></div>    
</body>
</html>