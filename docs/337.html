<html>
<head>
<title>How to install VNC on Debian 10 - vnc set up debian 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在debian 10上安装VNC-VNC设置Debian 10</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-vnc-on-debian-10/#0001-01-01">https://blog.eldernode.com/install-vnc-on-debian-10/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/62810aaf03728d71a37690fb87b23a70.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to install VNC on Debian 10" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2278.png"/><p>之前，你已经在CentOS 7 上读到过<a href="https://eldernode.com/install-vnc-centos-7/" target="_blank" rel="noopener noreferrer"> VNC。在这篇文章中，我们将学习如何在Debian 10上安装VNC。Vnc(虚拟网络计算)是一个连接系统，使用户更容易在远程服务器上安装软件、管理文件和设置。那些不习惯命令行的人，可以使用VNC让他们使用键盘和鼠标与远程服务器上的图形桌面环境进行交互。接下来，你将学习如何使用</a><a href="https://www.tightvnc.com/"> TightVNC </a>，一个远程控制包，在Debian 10服务器上建立一个VNC服务器，并通过<a href="https://eldernode.com/tag/install-ssh-server/" target="_blank" rel="noopener noreferrer"> SSH </a>隧道连接到它。</p><p> </p><h2><span>如何在Debian 10上安装VNC</span></h2><p id="prerequisites"><strong>先决条件</strong></p><p>如果您知道以下内容，本教程可能会更有用:</p><p><span> <strong> 1- </strong> </span>要设置一个Debian 10，访问Debian 10初始服务器设置教程，包括一个非根用户sudo访问和一个防火墙。</p><p><strong> <span> 2- </span> </strong>通过SSh隧道支持VNC连接的计算机。</p><p>在Linux上，选择vinagre、krdc、RealVNC或TightVNC中的一个。</p><p><span> 2-2 </span>在macOS上，使用内置的屏幕共享程序，或者RealVNC这样的跨平台app。</p><p><span> 2-3 </span>在Windows上，可以使用TightVNC、RealVNC或UltraVNC。</p><h3><span>在Debian 10上逐步安装和配置VNC</span></h3><p><strong> <span>第一步</span></strong>—<strong>先安装桌面环境和VNC服务器</strong>。</p><p>如您所知，Debian 10服务器上默认不安装图形环境，所以我们将从安装开始。当然，安装最新的Xfce桌面环境的软件包和官方Debian仓库中的TightVNC软件包。</p><p><strong>更新</strong>您的套餐列表:</p><pre><code class="language-bash">sudo apt update</code></pre><p><strong>在服务器上安装</strong>Xfce桌面环境:</p><pre><code class="language-bash">sudo apt install xfce4 xfce4-goodies</code></pre><p>如果系统提示您选择键盘布局，请选择适合您的语言的，然后按Enter键。然后安装将继续。安装完成后，安装TightVNC服务器:</p><pre><code class="language-bash">sudo apt install tightvncserver</code></pre><p>使用vncserver命令设置安全密码并创建初始配置文件，以完成VNC服务器的配置。</p><pre><code class="language-bash">vncserver</code></pre><p>然后，您必须输入并验证密码才能远程访问您的机器:</p><pre><code class="language-bash"><span>Output</span>    You will require a password to access your desktops.  Password:  Verify:    </code></pre><p>密码<strong>的长度必须在6到8个字符之间。但是超过8个字符的密码将被自动截断。如果您使用只读密码登录，您将无法使用鼠标或键盘控制VNC即时。要为服务器创建默认配置文件和连接信息，请执行以下操作:</strong></p><p title="Output"><span>输出</span></p><pre><code class="language-bash">Would you like to enter a view-only password (y/n)? <span>n</span>  xauth:  file /home/<span>noodi</span>/.Xauthority does not exist    New 'X' desktop is <span>your_hostname</span>:1    Creating default startup script /home/<span>noodi</span>/.vnc/xstartup  Starting applications specified in /home/<span>noodi</span>/.vnc/xstartup  Log file is /home/<span>noodi</span>/.vnc/<span>your_hostname</span>:1.log</code></pre><p><span> <strong>第二步</strong></span>–<strong>配置VNC服务器</strong></p><p>VNC需要验证它应该连接到哪个图形桌面。这些命令在<span>中名为<span> xstartup </span>的配置文件中可用。您的主目录下的vnc </span>文件夹。当您运行<span> vncserver </span>命令时，启动脚本被创建。设置VNC后，它在端口5901启动。被VNC <span>称为:1 </span>。当然，它可以在其他显示端口上启动多个实例，如<span> : 2，</span> <span> 3 </span>。由于您可能会更改VNC服务器的配置方式，您应该首先使用以下命令停止运行在端口<span> 5091 </span>上的VNC服务器。</p><p>您可能会看到不同的PID，但是，输出如下所示:</p><pre><code class="language-bash">vncserver -kill :1  </code></pre><p>通过在修改<span> xstartup </span>之前输入该命令，可以备份原始文件。</p><pre title="Output"><code class="language-bash"><span>Output</span>    Killing Xtightvnc process ID17648</code></pre><p><strong>现在</strong>创建一个新的xstartup文件，并在文本编辑器中打开它:</p><pre><code class="language-bash">mv ~/.vnc/xstartup ~/.vnc/xstartup.bak</code></pre><p>如果你以前没有做过，你需要VNC来启动你的桌面环境。将以下命令添加到文件中:</p><pre><code class="language-bash">nano ~/.vnc/xstartup</code></pre><p><span>。Xresources </span>是用户可以更改图形桌面设置的地方。您需要使VNC服务器可执行，以确保它能够使用这个新的启动文件。</p><pre><code class="language-bash">~/.vnc/xstartup    #!/bin/bash     xrdb $HOME/.Xresources    startxfce4 &amp;</code></pre><p>您应该在这里重新启动VNC服务器。</p><pre><code class="language-bash">sudo chmod +x ~/.vnc/xstartup  </code></pre><p>输出可能显示如下。</p><pre><code class="language-bash">vncserver</code></pre><p><span> <strong>第三步</strong></span>–<strong>安全连接VNC桌面</strong></p><pre title="Output"><code class="language-bash"><span>Output</span>    New 'X' desktop is <span>your_hostname</span>:1    Starting applications specified in /home/<span>noodi</span>/.vnc/xstartup  Log file is /home/<span>noodi</span>/.vnc/your_hostname:1.log</code></pre><pre><code class="language-bash"/></pre><p>您应该使用SSH隧道安全地连接到您的服务器，因为VNC不使用安全协议。因此，创建<span> SSH </span>连接来为VNC转发<span> localhost </span>连接。通过Linux或macOS上的终端，使用以下命令完成此操作:</p><p><span>注意</span>:将<span> noodi </span>和<span> your_server_ip </span>替换为您服务器的非root用户名和ip地址。使用<span> your_server_ip </span>作为连接ip，如果您使用的是图形SSH客户端，如PuTTY，则设置<span> localhost:5901 </span>。</p><pre><code class="language-bash">ssh -L 5901:127.0.0.1:5901 -C -N -l noodi your_server_ip</code></pre><p>一旦连接上，您将看到默认的Xfce桌面。</p><p><img data-lazyloaded="1" src="../Images/8bbfe152c43ef876916a1937b7f9e302.png" decoding="async" loading="lazy" class="aligncenter wp-image-8180 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/07/default-xfce.jpg" alt="VNC on Debian 10-desktop view" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/07/default-xfce.jpg 1021w, https://blog.eldernode.com/wp-content/uploads/2020/07/default-xfce-300x224.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2020/07/default-xfce-768x572.jpg 768w" data-sizes="(max-width: 1021px) 100vw, 1021px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/07/default-xfce.jpg"/></p><p>当您点击<strong>使用默认配置</strong>时，您将快速配置您的桌面。</p><p>要使用文件管理器或命令行，您可以访问您的主目录中的文件，如下所示:</p><p><img data-lazyloaded="1" src="../Images/4502deb4c76c40626a4ef6ba5b48bec3.png" decoding="async" loading="lazy" class="aligncenter wp-image-8191 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/07/vnc-on-debian-10-home-view.jpg" alt="vnc on debian 10- home view" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/07/vnc-on-debian-10-home-view.jpg 1022w, https://blog.eldernode.com/wp-content/uploads/2020/07/vnc-on-debian-10-home-view-300x215.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2020/07/vnc-on-debian-10-home-view-768x552.jpg 768w" data-sizes="(max-width: 1022px) 100vw, 1022px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/07/vnc-on-debian-10-home-view.jpg"/></p><p>您可以使用<span> CTRL+C </span>来停止SSH隧道，这将断开您的VNC会话。</p><p><span> <strong>第四步</strong></span>–<span><strong>运行VNC作为系统服务</strong> </span></p><p>作为systemd服务，您可以在设置VNC服务器后启动、停止和重新启动它。因此，首先使用文本编辑器创建一个名为<span> /etc/systemd/system/ <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="53253d30203621253621137d203621253a3036">【电子邮件保护】</a> </span>的新单元文件。</p><p>如果您对符号<span> @ </span>有疑问，它允许您传入一个参数，您可以在服务配置中使用它。当您管理该服务时，您可以使用它来指定您想要使用的VNC显示端口。</p><pre><code class="language-bash">sudo nano /etc/systemd/system/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0c7a626f7f697e7a697e4c227f697e7a656f69">[email protected]</a></code></pre><p>将以下几行添加到文件中。请务必更改<strong>用户</strong>、<strong>组</strong>、<strong>工作目录</strong>的值，以及<strong> PIDFILE </strong>的值中的用户名，以匹配您的用户名:</p><p> </p><p>ExecStartPre 命令停止VNC。</p><pre><code class="language-bash">[Unit]  Description=Start TightVNC server at startup  After=syslog.target network.target    [Service]  Type=forking  User=<span>noodi</span>  Group=<span>noodi</span>  WorkingDirectory=/home/<span>noodi</span>    PIDFile=/home/<span>noodi</span>/.vnc/%H:%i.pid  ExecStartPre=-/usr/bin/vncserver -kill :%i &gt; /dev/null 2&gt;&amp;1  ExecStart=/usr/bin/vncserver <span>-depth 24 -geometry 1280x800</span> :%i  ExecStop=/usr/bin/vncserver -kill :%i    [Install]  WantedBy=multi-user.target    </code></pre><p><span> ExecStart </span>命令启动VNC，并将颜色深度设置为24位颜色，分辨率为1280×800。</p><p>保存并关闭文件。</p><p>现在，让系统知道新的单元文件，输入下面的命令。</p><p>然后启用单元文件。</p><pre><code class="language-bash">sudo systemctl daemon-reload</code></pre><p>要停止VNC服务器的当前实例，请执行以下操作:</p><pre><code class="language-bash">sudo systemctl enable <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="26504845554354504354661708554354504f4543">[email protected]</a></code></pre><p>要像启动任何其他systemd服务一样启动它:</p><pre><code class="language-bash">vncserver -kill :1</code></pre><p>验证它是用这个命令启动的。</p><pre><code class="language-bash">sudo systemctl start <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0f79616c7c6a7d796a7d4f3e">[email protected]</a></code></pre><p>当它正确启动时，输出应该如下所示:</p><pre><code class="language-bash">sudo systemctl status <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e5938b86968097938097a5d4">[email protected]</a></code></pre><p><span>输出</span></p><p title="Output">当您重新启动机器时，VNC服务器现在将可用。</p><pre><code class="language-bash"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c1b7afa2b2a4b3b7a4b381f0efb2a4b3b7a8a2a4">[email protected]</a> - Start TightVNC server at startup     Loaded: loaded (/etc/systemd/system/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="addbc3cedec8dfdbc8dfed83dec8dfdbc4cec8">[email protected]</a>; enabled; vendor preset: enabled)     Active: <span>active</span> (running) since Thu 2019-10-10 17:56:17 UTC; 5s ago    Process: 935 ExecStartPre=/usr/bin/vncserver -kill :1 &gt; /dev/null 2&gt;&amp;1 (code=exited, status=2)    Process: 940 ExecStart=/usr/bin/vncserver -depth 24 -geometry 1280x800 :1 (code=exited, status=0/SUCCESS)   Main PID: 948 (Xtightvnc)  . . .</code></pre><p>现在再次启动您的SSH隧道:</p><p>要连接到您的机器，请通过您的VNC客户端软件建立到<span> localhost:5901 </span>的新连接。</p><p> </p><pre><code class="language-bash">ssh -L <span>5901</span>:127.0.0.1:<span>5901</span> -C -N -l <span>noodi</span> <span>your_server_ip</span></code></pre><p>亲爱的用户，我们希望这篇教程能对你有所帮助，如果你有任何问题或想查看我们的用户关于这篇文章的对话，请访问<a href="https://eldernode.com/ask" target="_blank" rel="noopener noreferrer">提问页面</a>。也为了提高你的知识，有这么多有用的教程为<a href="https://eldernode.com/blog/" target="_blank" rel="noopener noreferrer">老年节点培训</a>准备。</p><p> </p><p> </p><p><span> <strong>不要错过</strong> </span></p><p><span> <a href="https://eldernode.com/install-vnc-on-centos-linux/" target="_blank" rel="noopener noreferrer">如何在CentOS Linux上安装VNC</a></span></p><p><span> <a href="https://eldernode.com/webmin-linux-ubuntu-and-debian/"> Webmin Linux、Ubuntu和Debian web管理工具</a> </span></p><p><span><a href="https://eldernode.com/install-vnc-on-centos-linux/" target="_blank" rel="noopener noreferrer">How to install VNC on CentOS Linux</a></span></p><p><span><a href="https://eldernode.com/webmin-linux-ubuntu-and-debian/">Webmin Linux, Ubuntu and Debian web management tool</a></span></p><p/></div></div>    
</body>
</html>