<html>
<head>
<title>How To Install SeaweedFS Cluster On Debian 10 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Debian 10 - Eldernode博客上安装SeaweedFS集群</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-seaweedfs-cluster-on-debian-10/#0001-01-01">https://blog.eldernode.com/install-seaweedfs-cluster-on-debian-10/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/030726ceba76ca74488e3600bc02a6e6.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How To Install SeaweedFS Cluster On Debian 10" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/How-To-Install-SeaweedFS-Cluster-On-Debian-10.png"/><p>SeaweedFS是一个开源的分布式对象存储和文件系统，用于快速存储和服务数十亿个文件。对于blobs、对象、文件和数据仓库，这是一个简单且高度可伸缩的存储系统。Blob存储具有O(1)磁盘寻道、本地分层、云分层。你可能知道Ceph、GlusterFS和HDFS，SeaweedFS类似于这些文件系统。但是它可以很容易地与云集成，并且无需任何客户端更改即可实现快速访问。此外，它在设置和操作方面都非常快速和简单。在本文中，您将学习如何在Debian 10 上安装SeaweedFS集群。如果您准备购买完全托管的VPS，请在<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>上订购您考虑的软件包，并购买您自己的<strong> <a href="https://eldernode.com/linux-vps/" target="_blank" rel="noopener"> Linux VPS </a> </strong>。</p><h2><span class="ez-toc-section" id="Tutorial_Install_SeaweedFS_Cluster_On_Debian_10"/> <strong>教程在Debian 10上安装SeaweedFS集群</strong>T3】</h2><h3><span class="ez-toc-section" id="Introducing_SeaweedFS"/> <strong>介绍SeaweedFS</strong>T3】</h3><p>SeaweedFS是一个独立的Apache许可的项目。它提供了一些显著的<strong>特性</strong>，比如自动主服务器故障转移、自动输入TTL到期、并行处理、处理大小文件、对任何文件的低延迟访问等等。正如你所读到的，SeaweedFS有两个目标。<strong>存储数十亿文件</strong>和<strong>快速提供文件</strong>。作为一个对象存储，SeaweedFS能够有效地处理小文件。这样，中央主机管理而不是管理中央主机中的所有文件元数据，管理卷服务器上的卷，并且这些卷服务器管理文件及其元数据。此外，添加/删除服务器不会导致任何数据重新平衡，除非由管理命令触发。</p><h2><span class="ez-toc-section" id="Install_SeaweedFS_Cluster_On_Debian_10_Debian_9"/> <strong>在Debian 10 | Debian 9 </strong> <span class="ez-toc-section-end"/>上安装SeaweedFS集群</h2><p>让我们通过本指南的步骤来回顾一下SeaweedFS在Debian  10上的安装。</p><p><em>第一步:</em></p><p>首先，你必须安装<strong>最新的软件和补丁</strong>。此外，您将在这里安装您需要的工具:</p><pre><code class="language-bash">sudo apt update</code></pre><pre><code class="language-bash">sudo apt install vim curl wget zip git -y</code></pre><pre><code class="language-bash">sudo apt install build-essential autoconf automake gdb git</code></pre><pre><code class="language-bash">libffi-dev zlib1g-dev libssl-dev -y</code></pre><p><em>第二步:</em></p><p>要获取并安装Go，可以用两种方法继续。</p><p><strong>方法一:</strong></p><p>您可以从APT存储库中安装它。所以，运行:</p><pre><code class="language-bash">sudo apt install golang</code></pre><p><strong>方法二:</strong></p><p>此外，您可以从源代码中提取并手动安装。要获取最新的Go tarball版本，请访问<a href="https://golang.org/dl/" target="_blank" rel="noopener"> Go下载页面</a>。</p><pre><code class="language-bash">cd ~</code></pre><pre><code class="language-bash">wget -c https://golang.org/dl/go1.15.5.linux-amd64.tar.gz -O</code></pre><pre><code class="language-bash"> - | sudo tar -xz -C /usr/local</code></pre><p><em>第三步:</em></p><p>当您成功地通过了上面两个步骤后，将<strong> "/usr/local/go/bin" </strong>目录添加到PATH环境变量中，这样服务器将会找到go可执行二进制文件。为此，您可以将下面一行附加到<strong> /etc/profile </strong>文件或<strong> $HOME/。配置文件</strong>文件。</p><p><em> <strong>注意</strong> </em>:在<strong>全系统安装</strong>中，您可以将下面一行添加到<strong> /etc/profile </strong>文件中:</p><pre><code class="language-bash">echo "export PATH=$PATH:/usr/local/go/bin" | sudo tee -a /etc/profile</code></pre><p>而对于<strong>当前用户安装</strong>，建议您添加到<strong> $HOME/。简介:</strong></p><pre><code class="language-bash">echo "export PATH=$PATH:/usr/local/go/bin" | tee -a $HOME/.profile</code></pre><p><em>第四步:</em></p><p>新的PATH环境变量可以加载到当前的shell会话中，这取决于您在上一步中编辑的源文件。</p><pre><code class="language-bash">source ~/.profile</code></pre><p>或者</p><pre><code class="language-bash">source /etc/profile</code></pre><p><em>第五步:</em></p><p>因为您需要将必要的文件放入您的服务器，所以使用GitHub中所有可用的资源。因此<strong>，克隆存储库</strong>并继续安装:</p><pre><code class="language-bash">cd ~</code></pre><pre><code class="language-bash">git clone https://github.com/chrislusf/seaweedfs.git</code></pre><p><em>第六步:</em></p><p>是时候<strong>下载、编译和安装SeaweedFS </strong>了。当您克隆了所有源代码后，导航到新目录并通过运行以下命令安装SeaweedFS项目:</p><pre><code class="language-bash">$ cd ~/seaweedfs</code></pre><pre><code class="language-bash">$ make install</code></pre><p><img data-lazyloaded="1" src="../Images/e5dbccc517e741f5c25c900875f0862f.png" decoding="async" loading="lazy" class="size-full wp-image-26996 alignnone" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/5.png" alt="download, compile, and install SeaweedFS" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/5.png 452w, https://blog.eldernode.com/wp-content/uploads/2021/03/5-300x223.png 300w" data-sizes="(max-width: 452px) 100vw, 452px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/5.png"/></p><p><em>第七步:</em></p><p>现在，你可以在你的<strong> $GOPATH/bin </strong>目录中找到可执行文件“<strong> weed </strong>”。如您所见，安装完成后，weed在您当前的主目录下创建了<strong> $GOPATH </strong>。所以，你可以在这里找到weed“~<strong>/go/bin/weed</strong>”。要解决此问题，请将SeaweedFS二进制文件复制到在<em>步骤2 </em>中安装Go的早期位置，如下所示:</p><pre><code class="language-bash">sudo cp ~/go/bin/weed /usr/local/bin/</code></pre><p><em>第八步:</em></p><p>因为"<strong> weed </strong>"命令在PATH环境变量中，所以您可以轻松地配置SeaweedFS:</p><pre><code class="language-bash">$ weed version</code></pre><pre><code class="language-bash">version 30GB 2.12 6d30b21b linux amd64</code></pre><h2><span class="ez-toc-section" id="How_to_use_SeaweedFS_on_Debian_Linux"/> <strong>如何在Debian Linux上使用SeaweedFS</strong><span class="ez-toc-section-end"/></h2><p>默认情况下，主节点运行在端口9333上，卷节点运行在端口8080上。通过分别在端口8080和8081上启动一个主节点和两个卷节点，您可以更好地理解这一点。因此，正如您所猜测的，它们应该从不同的机器上启动，但是您可以使用一台服务器作为示例。如果您打算在不同的服务器上启动卷，请确保<strong> -mserver </strong> IP地址指向主服务器。此外，请考虑主服务器上的端口必须可以从卷服务器/节点到达。</p><p><em> <strong>注意</strong> </em> : SeaweedFS使用HTTP REST操作来读取、写入和删除。响应采用JSON或JSONP格式。</p><h3><span class="ez-toc-section" id="How_to_start_Master_Server_on_Debian_10_using_SeaweedFS"/> <strong>如何使用SeaweedFS</strong>T3在Debian 10上启动主服务器</h3><p>默认情况下，主节点运行在端口9333上。有两种方法可以启动主服务器。让我们在下面回顾一下它们:</p><p><strong>方法1:手动启动主服务器</strong></p><pre><code class="language-bash">weed master &amp;</code></pre><p><img data-lazyloaded="1" src="../Images/f55fef6cc004656463b4785abfe115a5.png" decoding="async" loading="lazy" class="size-full wp-image-26993 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/22.png" alt="Start the master server manually - How To Install SeaweedFS Cluster On Debian 10" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/22.png 499w, https://blog.eldernode.com/wp-content/uploads/2021/03/22-300x247.png 300w" data-sizes="(max-width: 499px) 100vw, 499px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/22.png"/></p><p><strong>方法2:使用Systemd </strong>启动主服务器</p><p>此外，您还可以使用Systemd通过创建其单元文件来启动主服务器:</p><pre><code class="language-bash">sudo tee /etc/systemd/system/seaweedmaster.service&lt;&lt;EOF  </code></pre><p><img data-lazyloaded="1" src="../Images/d412ebe9edaac4261b8f513add95833e.png" decoding="async" loading="lazy" class="size-full wp-image-26999 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/3-5.png" alt="Start the master server using Systemd" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/3-5.png 424w, https://blog.eldernode.com/wp-content/uploads/2021/03/3-5-300x294.png 300w" data-sizes="(max-width: 424px) 100vw, 424px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/3-5.png"/></p><p>文件更新后，重新加载守护程序并启动主程序。</p><pre><code class="language-bash">sudo systemctl daemon-reload</code></pre><pre><code class="language-bash">sudo systemctl start seaweedmaster</code></pre><pre><code class="language-bash">sudo systemctl enable seaweedmaster</code></pre><p>然后检查其状态。</p><pre><code class="language-bash">systemctl status seaweedmaster -l</code></pre><p><img data-lazyloaded="1" src="../Images/c6b63136fc793e33d59fbc10fe6e73f1.png" decoding="async" loading="lazy" class="size-full wp-image-27001 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-5.png" alt="reload the daemon and start the master" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-5.png 548w, https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-5-300x189.png 300w" data-sizes="(max-width: 548px) 100vw, 548px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-5.png"/></p><h3><span class="ez-toc-section" id="How_to_start_Volume_Servers_on_Debian_10_using_SeaweedFS"/> <strong>如何使用SeaweedFS </strong> <span class="ez-toc-section-end"/>在Debian 10上启动卷服务器 <strong/></h3><p>当主服务器准备好并等待卷时，您现在可以放心地使用以下命令启动卷。让我们首先创建示例目录:</p><pre><code class="language-bash">mkdir /tmp/{data1,data2,data3,data4}}</code></pre><p>现在，您可以创建第一批卷。</p><p><strong>选项1:手动方式</strong></p><pre><code class="language-bash">weed volume -dir="/tmp/data1" -max=5 -</code></pre><pre><code class="language-bash">mserver="localhost:9333" -port=8080 &amp;</code></pre><p><img data-lazyloaded="1" src="../Images/c5936e19d80370675bf430dc0839549b.png" decoding="async" loading="lazy" class="size-full wp-image-27004 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/s.png" alt="reate the first volumes manual way" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/s.png 518w, https://blog.eldernode.com/wp-content/uploads/2021/03/s-159x300.png 159w" data-sizes="(max-width: 518px) 100vw, 518px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/s.png"/></p><p>然后创建第二个:</p><pre><code class="language-bash">weed volume -dir="/tmp/data2" -max=10 -</code></pre><pre><code class="language-bash">mserver="localhost:9333" -port=8081 &amp;</code></pre><p><img data-lazyloaded="1" src="../Images/d56e8a922dfaf73cf75580c0f6c387f9.png" decoding="async" loading="lazy" class="size-full wp-image-27009 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-6.png" alt="create the second volumes" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-6.png 529w, https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-6-187x300.png 187w" data-sizes="(max-width: 529px) 100vw, 529px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-6.png"/></p><p><strong>选项2:使用SystemD </strong></p><p>如果需要更多的卷文件来使用Systemd启动卷，您需要创建两个或更多的卷文件。看看下面的解释，了解更多信息。</p><p><strong>对于第一卷:</strong></p><pre><code class="language-bash">sudo vim /etc/systemd/system/seaweedvolume1.service</code></pre><p><img data-lazyloaded="1" src="../Images/9c0c1347369d87c8e84b60cbe3e75ff8.png" decoding="async" loading="lazy" class="size-full wp-image-27019 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-7.png" alt="start Volume Servers Using SystemD" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-7.png 470w, https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-7-300x274.png 300w" data-sizes="(max-width: 470px) 100vw, 470px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-7.png"/></p><p>此时，用正确的值替换卷路径，然后启动并启用:</p><pre><code class="language-bash">sudo systemctl daemon-reload</code></pre><pre><code class="language-bash">sudo systemctl start seaweedvolume1.service</code></pre><pre><code class="language-bash">sudo systemctl enable seaweedvolume1.service</code></pre><p>检查状态:</p><pre><code class="language-bash">$ systemctl status seaweedvolume1</code></pre><p><img data-lazyloaded="1" src="../Images/f79fa11c31fcf5169ec4b953daebcd3f.png" decoding="async" loading="lazy" class="size-full wp-image-27014 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/d.png" alt="replace the volume path with your correct value" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/d.png 577w, https://blog.eldernode.com/wp-content/uploads/2021/03/d-300x174.png 300w" data-sizes="(max-width: 577px) 100vw, 577px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/d.png"/></p><p><strong>对于第二卷:</strong></p><pre><code class="language-bash">sudo vim /etc/systemd/system/seaweedvolume2.service</code></pre><p><img data-lazyloaded="1" src="../Images/5166304e38a75651d0e161c11bd57e7c.png" decoding="async" loading="lazy" class="size-full wp-image-27022 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-9.png" alt="start the volumes using Systemd" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-9.png 530w, https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-9-300x239.png 300w" data-sizes="(max-width: 530px) 100vw, 530px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Untitled-9.png"/></p><p>更新文件后，如图所示重新加载守护进程。</p><pre><code class="language-bash">sudo systemctl daemon-reload</code></pre><pre><code class="language-bash">sudo systemctl start seaweedvolume2</code></pre><pre><code class="language-bash">sudo systemctl enable seaweedvolume2</code></pre><p>然后检查它们的状态</p><pre><code class="language-bash">sudo systemctl status seaweedvolume2</code></pre><p><img data-lazyloaded="1" src="../Images/ed1ad89c6923fb140353e9f4209b3330.png" decoding="async" loading="lazy" class="size-full wp-image-27024 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/JJ.png" alt="reload the daemon" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/JJ.png 509w, https://blog.eldernode.com/wp-content/uploads/2021/03/JJ-300x205.png 300w" data-sizes="(max-width: 509px) 100vw, 509px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/JJ.png"/></p><h3><span class="ez-toc-section" id="How_to_write_a_sample_file_on_Debian_10_using_SeaweedFS"/> <strong>如何用SeaweedFS </strong> <span class="ez-toc-section-end"/>在Debian 10上写一个样本文件 <strong/></h3><p>在本节中，您将上传一个文件到SeaweedFS对象存储是很有趣的。因此，您必须向<strong> /dir/assign </strong>发送HTTP POST、PUT或GET请求，以获取文件ID (fid)和卷服务器URL:</p><pre><code class="language-bash">$ curl http://localhost:9333/dir/assign</code></pre><pre><code class="language-bash">{"fid":"7,0101406762","url":"Your_file_ID:8080","publicUrl":"Your_file_ID:8080","count":1}</code></pre><p>接下来，您需要存储文件内容。因此，从响应中向<strong> URL + '/' +文件ID </strong> (fid)发送一个HTTP多部分POST请求。我们的fid是70101406762，URL是Your_file_ID:8080。让我们发出这样的请求。您将得到如下所示的响应:</p><pre><code class="language-bash">$ curl -F <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a0c6c9ccc59de0">[email protected]</a>/home/tech/teleport-logo.png http://Your_file_ID:8080/7,0101406762</code></pre><pre><code class="language-bash">{"name":"teleport-logo.png","size":70974,"eTag":"ef8deb64899176d3de492f2fa9951e14"}</code></pre><h3><span class="ez-toc-section" id="How_to_access_SeaweedFS_on_Debian_10"/> <strong>如何在Debian 10上访问SeaweedFS</strong>T3】</h3><p>要访问SeaweedFS，请使用URL<em>http://your-server-IP</em>:8080/7，016bad1bc0。这样，您将查看存储在SeaweedFS对象存储中的文件。请看下图，它显示了你上传的文件。</p><p> </p><p><img data-lazyloaded="1" src="../Images/7f3b6de023c6feba75b3c68c87c22711.png" decoding="async" loading="lazy" class="size-full wp-image-27028 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/p1-1.png" alt="How to access SeaweedFS on Debian 10" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/p1-1.png 569w, https://blog.eldernode.com/wp-content/uploads/2021/03/p1-1-300x244.png 300w" data-sizes="(max-width: 569px) 100vw, 569px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/p1-1.png"/></p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，您了解了如何在Debian 10上安装SeaweedFS集群。SeaweedFS的架构相当简单，实际数据存储在存储节点的卷中。SeaweedFS不像分布式文件系统那样管理块，而是管理主服务器中的数据卷。</p></div></div>    
</body>
</html>