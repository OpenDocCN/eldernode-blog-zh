<html>
<head>
<title>Tutorial Limit SSH with UFW on Ubuntu 20.04 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>教程限制SSH与UFW在Ubuntu 20.04 - Eldernode博客</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/limit-ssh-with-ufw-on-ubuntu/#0001-01-01">https://blog.eldernode.com/limit-ssh-with-ufw-on-ubuntu/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/cafa5756612e794eeb619a7bb12aa3c9.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial Limit SSH with UFW on Ubuntu 20.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Tutorial-Limit-SSH-with-UFW-on-Ubuntu-20.04.png"/><p>正确的防火墙配置是系统安全最重要的方面之一。默认情况下，Ubuntu附带一个名为UFW(简单防火墙)的防火墙配置工具。UFW是一个用户友好的避难所，用于管理iptables防火墙规则，其主要目的是管理或轻松管理iptables。在这篇文章中，我们将教你如何在Ubuntu 20.04 上用UFW限制SSH。如果你想购买一台<a href="https://eldernode.com/ubuntu-vps/" target="_blank" rel="noopener"> <strong> Ubuntu VPS </strong> </a>服务器，你可以访问<a href="https://eldernode.com/"> Eldernode </a>中提供的软件包。</p><h2><span class="ez-toc-section" id="How_to_Limit_SSH_with_UFW_on_Ubuntu_2004"/> <strong>如何在Ubuntu 20.04上用UFW限制SSH</strong><span class="ez-toc-section-end"/></h2><h3><span class="ez-toc-section" id="How_to_Syntax_to_limit_SSH_connections_with_UFW"/> <strong>如何语法限制SSH与UFW的连接</strong> <span class="ez-toc-section-end"/></h3><p>在这一节中，我们想教你如何使用语法来限制与UFW的SSH (TCP端口22)连接。注意，语法非常简单。为此，您可以看到以下命令:</p><pre><code class="language-bash">## ufw limit ssh various usage ##</code></pre><pre><code class="language-bash">ufw limit ssh</code></pre><pre><code class="language-bash">ufw limit ssh/tcp</code></pre><pre><code class="language-bash">ufw limit ssh comment 'Rate limit for openssh server'</code></pre><pre><code class="language-bash">### if sshd is running on tcp port 2022 add ####</code></pre><pre><code class="language-bash">ufw limit 2022/tcp comment 'SSH port rate limit'</code></pre><h2><span class="ez-toc-section" id="Limit_SSH_with_UFW_on_Ubuntu_2004_Ubuntu_2104"/> <strong>在Ubuntu 20.04上用UFW限制SSH |</strong><strong>Ubuntu 21.04</strong><span class="ez-toc-section-end"/></h2><p>在上一节中，我们提到了一些限制SSH与UFW连接的语法。请注意，这些规则对于防范暴力日志攻击非常有用。</p><p>现在在这一节，我们想讨论如何在Ubuntu 20.04上用UFW限制SSH。请注意，当使用受限规则时，UFW通常会允许连接。但是如果一个IP地址试图在30秒内建立多个连接，它会拒绝该连接。因此，您需要在安装后使用以下命令进行确认:</p><pre><code class="language-bash">sudo ufw limit ssh/tcp comment 'Rate limit for openssh serer'</code></pre><pre><code class="language-bash">sudo ufw status</code></pre><p>有趣的是，Iptables中的真正规则如下:</p><pre><code class="language-bash">-A ufw-user-input -p tcp -m tcp --dport 22 -m conntrack --ctstate NEW -m recent --set --name DEFAULT --mask 255.255.255.255 --rsource</code></pre><pre><code class="language-bash">-A ufw-user-input -p tcp -m tcp --dport 22 -m conntrack --ctstate NEW -m recent --update --seconds 30 --hitcount 6 --name DEFAULT --mask 255.255.255.255 --rsource -j ufw-user-limit</code></pre><pre><code class="language-bash">-A ufw-user-input -p tcp -m tcp --dport 22 -j ufw-user-limit-accept</code></pre><h3><span class="ez-toc-section" id="How_to_Limit_SSH_with_UFW_and_other_protocols"/> <strong>如何用UFW等协议限制SSH</strong><span class="ez-toc-section-end"/></h3><p>在这一节中，我们想向您展示如何使用UFW和其他协议来限制ssh。您可以使用以下命令来实现这一点。您也可以使用这些命令来限制其他服务:</p><pre><code class="language-bash">ufw limit {service}</code></pre><pre><code class="language-bash">## be careful with http/https limits as many users might be behind a large proxy server ##</code></pre><pre><code class="language-bash">ufw limit 25/tcp</code></pre><pre><code class="language-bash">ufw limit http</code></pre><pre><code class="language-bash">ufw</code></pre><pre><code class="language-bash">ufw limit https</code></pre><h3><span class="ez-toc-section" id="How_to_Limit_SSH_using_the_GUFW_GUI_tool"/> <strong>如何使用GUFW GUI工具限制SSH</strong><span class="ez-toc-section-end"/></h3><p>在这一节中，我们想使用GUFW GUI工具来处理限制ssh的问题。为此，您必须按顺序执行以下步骤。</p><p>首先，你需要确保GUFW安装在Ubuntu Linux上。您可以使用以下命令来执行该测试:</p><pre><code class="language-bash">sudo apt install gufw</code></pre><p>现在，您可以通过执行以下命令开始:</p><pre><code class="language-bash">gufw &amp;</code></pre><p>请注意，运行GUI防火墙工具需要身份验证。因此会要求您输入密码。完成此操作并输入密码后，您可以看到如下所示的窗口:</p><p> </p><p><img data-lazyloaded="1" src="../Images/d6990f9033ed6a54940807e2c207a2e3.png" decoding="async" loading="lazy" class="aligncenter wp-image-34017 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/08/How-to-Limit-SSH-using-the-GUFW-GUI-tool.png" alt="How to Limit SSH using the GUFW GUI tool" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/08/How-to-Limit-SSH-using-the-GUFW-GUI-tool.png 412w, https://blog.eldernode.com/wp-content/uploads/2021/08/How-to-Limit-SSH-using-the-GUFW-GUI-tool-222x300.png 222w" data-sizes="(max-width: 412px) 100vw, 412px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/08/How-to-Limit-SSH-using-the-GUFW-GUI-tool.png"/></p><p> </p><p>查看上图后，您必须点击<strong>规则</strong>选项卡，然后点击页面底部的<strong> + </strong>符号。在下一步中，您需要在<strong>应用程序</strong>过滤器框中键入“<strong> SSH </strong>，并点击橙色图标:</p><p> </p><p><img data-lazyloaded="1" src="../Images/0db3b3b463db777bd538eca60b5cf32e.png" decoding="async" loading="lazy" class="aligncenter wp-image-34018 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Limiting-SSH-using-the-GUFW-GUI-tool.png" alt="Limiting SSH using the GUFW GUI tool" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/08/Limiting-SSH-using-the-GUFW-GUI-tool.png 411w, https://blog.eldernode.com/wp-content/uploads/2021/08/Limiting-SSH-using-the-GUFW-GUI-tool-225x300.png 225w" data-sizes="(max-width: 411px) 100vw, 411px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Limiting-SSH-using-the-GUFW-GUI-tool.png"/></p><p> </p><p>在查看下图并确定限制策略后，您可以点击“<b>添加</b>，然后点击“<b>关闭</b>按钮:</p><p> </p><p><img data-lazyloaded="1" src="../Images/b6f19b2815cf8dbaed4223e9fd3f1a2a.png" decoding="async" loading="lazy" class="aligncenter wp-image-34019 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Limit-SSH-using-the-GUFW-GUI-tool-on-ubuntu.png" alt="Limit SSH using the GUFW GUI tool on ubuntu" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/08/Limit-SSH-using-the-GUFW-GUI-tool-on-ubuntu.png 568w, https://blog.eldernode.com/wp-content/uploads/2021/08/Limit-SSH-using-the-GUFW-GUI-tool-on-ubuntu-300x245.png 300w" data-sizes="(max-width: 568px) 100vw, 568px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/08/Limit-SSH-using-the-GUFW-GUI-tool-on-ubuntu.png"/></p><p> </p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在虚拟和<a href="https://eldernode.com/dedicated-server/">专用服务器</a>中，提高服务器安全性的最有效方法之一是在防火墙的帮助下控制服务器的流量以及入站和出站连接。这是通过设置防火墙并阻止或限制服务端口或流量来实现的。在Ubuntu 20.04中，这可以通过UFW防火墙来实现，所以在这篇文章中，我们试图教你如何在Ubuntu 20.04上用UFW来限制SSH。也可以参考<a href="https://blog.eldernode.com/set-up-firewall-ufw-debian-10/">如何在Debian 10 </a>和<a href="https://blog.eldernode.com/setup-firewall-ufw-ubuntu-20/"> Ubuntu 20.04 </a>上用UFW设置防火墙的文章。</p></div></div>    
</body>
</html>