<html>
<head>
<title>How to Setup MPLS on MikroTik - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在MikroTik - Eldernode博客上设置MPLS</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/setup-mpls-on-mikrotik/#0001-01-01">https://blog.eldernode.com/setup-mpls-on-mikrotik/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/09e532d2c191b141b197859e62a8451d.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Setup MPLS on MikroTik" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/How-to-Setup-MPLS-on-MikroTik.png"/><p>MPLS代表多协议标签交换。这种传输技术已经成为流行和普及了几年的技术。MPLS使用标记机制在网络上发送数据包。通常，如果我们要描述MPLS的功能，它使用路由平台中的标记机制来执行交换操作。也就是说，当进入MPLS网络时，基于目的地IP地址来标记分组。然后它被引导沿着第二层中的路径并基于这个标签到达目的地。在本文中，我们将向您学习如何在MikroTik 上设置MPLS。您可以访问<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>中可用的包来购买<a href="https://eldernode.com/mikrotik-vps-server/" target="_blank" rel="noopener"> Mikrotik VPS </a>服务器。</p><h2><span class="ez-toc-section" id="Tutorial_Setup_MPLS_on_MikroTik"/> <strong>教程在MikroTik </strong>上设置MPLS<span class="ez-toc-section-end"/></h2><p>MPLS不位于OSI的特定层，它的功能位于第二层(数据链路)和第三层(网络)之间。这就是它作为第2.5层协议推出的原因。如前所述，MPLS在数据包上使用标签机制。MPLS标签分布在路由器之间，路由器可以使用这些标签来获得网络标签的映射。这些标签连接到IP数据包，使路由器能够使用这些标签发送数据包，而不管IP地址。在MPLS中，数据包是通过标签交换而不是IP交换发送的。</p><p>标签交换技术并不是一项新技术，帧中继和ATM网络已经用它来发送帧和信元。在帧中继和ATM中，标签在网络的每一跳都会改变。这是这两种技术和在IP包中发送的主要区别。当路由器发送IP数据包时，它不会更改目的地址。事实上，MPLS标签是用来发送数据包的，并不使用IP地址。在本文的后续部分，我们将告诉您如何在<a href="https://blog.eldernode.com/tag/mikrotik/"> MikroTik </a>上设置MPLS。</p><h3><span class="ez-toc-section" id="Advantages_of_MPLS"/><strong>MPLS的优势</strong> <span class="ez-toc-section-end"/></h3><p>这里总结了在网络上使用MPLS的好处:</p><p>–使用集成网络基础设施</p><p>–优于ATM上的IP</p><p>–无边界网关协议(BGP)核心</p><p>–交通流量优化</p><p>–交通工程</p><p>–MPLS VPN的对等模型</p><h3><span class="ez-toc-section" id="Setup_MPLS_on_MikroTik"/> <strong>在MikroTik </strong>上设置MPLS<span class="ez-toc-section-end"/></h3><p>为了建立MPLS网络，我们考虑了以下场景。此场景由三台提供商路由器和三台提供商边缘路由器组成。</p><p> </p><p><img data-lazyloaded="1" src="../Images/e63454ef8e58599b1abfb77388a53e91.png" decoding="async" loading="lazy" class="aligncenter wp-image-22750 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/Setup-MPLS-on-MikroTik.png" alt="Setup MPLS on MikroTik" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/Setup-MPLS-on-MikroTik.png 670w, https://blog.eldernode.com/wp-content/uploads/2021/01/Setup-MPLS-on-MikroTik-300x174.png 300w" data-sizes="(max-width: 670px) 100vw, 670px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/Setup-MPLS-on-MikroTik.png"/></p><p> </p><p>第一步是在所有设备上创建环回接口。由于只创建一个LDP会话，两台路由器之间是否有多条链路并不重要，因此环回接口也可用于LSR ID和传输地址。</p><p>请注意以下命令:</p><p><strong> P1 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.1/32 interface=lobridge</code></pre><p>请注意，其它路由器被设置为10.255.255.2-6，如上所示:</p><p><strong> P2 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.2/32 interface=lobridge</code></pre><p><strong> P3 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.3/32 interface=lobridge</code></pre><p><strong> PE1 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.4/32 interface=lobridge</code></pre><p><strong> PE2 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.5/32 interface=lobridge</code></pre><p><strong> PE3 </strong></p><pre><code class="language-bash">/interface bridge add name=lobridge</code></pre><pre><code class="language-bash">/ip address add address=10.255.255.6/32 interface=lobridge</code></pre><h3><span class="ez-toc-section" id="IP_Addressing_training"/> <strong> IP寻址训练</strong> <span class="ez-toc-section-end"/></h3><p>接下来，您需要配置设备以太网接口的IP地址。为此，请检查以下命令:</p><p><strong> P1 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.0.255.1/30 interface=ether1</code></pre><pre><code class="language-bash">add address=10.0.255.5/30 interface=ether2</code></pre><pre><code class="language-bash">add address=10.1.0.254/24 interface=ether3</code></pre><p><strong> P2 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.0.255.6/30 interface=ether1</code></pre><pre><code class="language-bash">add address=10.0.255.9/30 interface=ether2</code></pre><pre><code class="language-bash">add address=10.2.0.254/24 interface=ether3</code></pre><p><strong> P3 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.0.255.10/30 interface=ether1</code></pre><pre><code class="language-bash">add address=10.0.255.2/30 interface=ether2</code></pre><pre><code class="language-bash">add address=10.3.0.254/24 interface=ether3</code></pre><p><strong> PE1 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.1.0.1/24 interface=ether1</code></pre><p><strong> PE2 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.2.0.1/24 interface=ether1</code></pre><p><strong> PE3 </strong></p><pre><code class="language-bash">/ip address</code></pre><pre><code class="language-bash">add address=10.3.0.1/24 interface=ether1</code></pre><h3><span class="ez-toc-section" id="How_to_set_up_Dynamic_Routing"/> <strong>如何设置动态路由</strong> <span class="ez-toc-section-end"/></h3><p>在这一部分，您必须设置一个动态路由，使网络完全可达。通过这样做，LDP将能够在您的网络上启动MPLS核心网络。</p><p><strong> P1 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.1 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.0/30</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.4/30</code></pre><pre><code class="language-bash">add area=backbone network=10.1.0.0/24</code></pre><p><strong> P2 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.2 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.8/30</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.4/30</code></pre><pre><code class="language-bash">add area=backbone network=10.2.0.0/24</code></pre><p><strong> P3 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.3 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.0/30</code></pre><pre><code class="language-bash">add area=backbone network=10.0.255.8/30</code></pre><pre><code class="language-bash">add area=backbone network=10.3.0.0/24</code></pre><p><strong> PE1 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.4 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.1.0.0/24</code></pre><p><strong> PE2 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.5 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.2.0.0/24</code></pre><p><strong> PE3 </strong></p><pre><code class="language-bash">/routing ospf instance</code></pre><pre><code class="language-bash">set distribute-default=never redistribute-connected=as-type-1 router-id=10.255.255.6 numbers=default</code></pre><pre><code class="language-bash">/routing ospf network</code></pre><pre><code class="language-bash">add area=backbone network=10.3.0.0/24</code></pre><p>应该注意的是，在执行上述步骤后，您现在应该有一个OSPF根系统:</p><h3><span class="ez-toc-section" id="How_to_setup_MPLS"/> <strong>如何设置MPLS </strong> <span class="ez-toc-section-end"/></h3><p>最后，您需要转到应该位于MPLA核心网络上的以太网接口，并在这些接口上启用LDP:</p><p><strong> P1 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.1 transport-address=10.255.255.1</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><pre><code class="language-bash">add interface=ether2</code></pre><pre><code class="language-bash">add interface=ether3</code></pre><p><strong> P2 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.2 transport-address=10.255.255.2</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><pre><code class="language-bash">add interface=ether2</code></pre><pre><code class="language-bash">add interface=ether3</code></pre><p><strong> P3 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.3 transport-address=10.255.255.3</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><pre><code class="language-bash">add interface=ether2</code></pre><pre><code class="language-bash">add interface=ether3</code></pre><p><strong> PE1 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.4 transport-address=10.255.255.4</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><p><strong> PE2 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.5 transport-address=10.255.255.5</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><p><strong> PE3 </strong></p><pre><code class="language-bash">/mpls ldp</code></pre><pre><code class="language-bash">set enabled=yes lsr-id=10.255.255.6 transport-address=10.255.255.6</code></pre><pre><code class="language-bash">/mpls ldp interface</code></pre><pre><code class="language-bash">add interface=ether1</code></pre><p>现在，在<strong> MPLS </strong>选项卡的<strong> LDP邻居</strong>部分，您的LDP邻居应该会显示给您。</p><p> </p><p><img data-lazyloaded="1" src="../Images/27135df2e0c5e8f2b521da481af86761.png" decoding="async" loading="lazy" class="aligncenter wp-image-22753 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/LDP-Neighbor-section-in-the-MPLS.png" alt="LDP Neighbor section in the MPLS" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/LDP-Neighbor-section-in-the-MPLS.png 422w, https://blog.eldernode.com/wp-content/uploads/2021/01/LDP-Neighbor-section-in-the-MPLS-300x90.png 300w" data-sizes="(max-width: 422px) 100vw, 422px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/LDP-Neighbor-section-in-the-MPLS.png"/></p><p> </p><p>您也可以使用以下命令:</p><pre><code class="language-bash">mpls ldp neighbor print</code></pre><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>当今非常流行的MPLS协议提供了基于更新的方法路由数据包的能力。它还消除了对旧IP路由的需要，并以更高的速度路由我们的数据包。在本文中，我们试图让您熟悉如何在MikroTik上设置MPLS。</p></div></div>    
</body>
</html>