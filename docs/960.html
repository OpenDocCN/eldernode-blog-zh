<html>
<head>
<title>How to Install Elastic Stack 7 on Debian 11 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Debian 11 - Eldernode博客如何安装Elastic Stack 7</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-elastic-stack-7-on-debian-11/#0001-01-01">https://blog.eldernode.com/install-elastic-stack-7-on-debian-11/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/e28ccbcc5daf94f269c6d0e8ed65e2d2.png" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How-to-Install-Elastic-Stack-7-on-Debian-11" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/How-to-Install-Elastic-Stack-7-on-Debian-11-1.webp"/><p><strong> ELK </strong>是一个开源应用的集合。您可以使用ELK收集、分析和可视化来自各种来源的报告。它由称为Elastcisearch、Logstash和Kibana的组件组成，在本文中，你将熟悉它们的特性，然后你将学习<strong>如何在Debian 11 </strong>上安装Elastic Stack 7。如果您想购买<a href="https://eldernode.com/linux-vps/"> <strong> Linux VPS </strong> </a>服务器，您可以在<a href="https://eldernode.com/"> Eldernode </a>网站上看到可用的软件包。</p><h2><span class="ez-toc-section" id="Tutorial_Install_Elastic_Stack_7_on_Debian_11"/> <strong>教程在Debian 11上安装弹性栈7</strong>T3】</h2><h3><span class="ez-toc-section" id="ELK_Components"/> <strong>麋鹿</strong>T3】组件T5】</h3><p>1 –&gt;<strong>elastic search</strong>是一个搜索和分析引擎。</p><p>2 –&gt;<strong>Logstash</strong>是一个服务器端数据处理管道，它同时接收、转换然后发送来自多个资源的数据。</p><p>3 –&gt;<strong>Kibana</strong>允许用户在Elasticsearch中使用图表和图形可视化数据。</p><p>4 –&gt;<strong>Beats</strong>从服务器收集报告并发送到Logstash或Elasticsearch。</p><p>在这篇来自<a href="https://blog.eldernode.com/tag/debian/"> Debian教程</a>系列的文章的续篇中，我们将一步一步地向你解释如何在Debian 11上安装Elastic Stack 7及其组件。</p><h2><span class="ez-toc-section" id="Installing_Elastic_Stack_7_on_Debian_11"/> <strong>在Debian 11上安装弹性栈7</strong>T3】</h2><p>首先<strong>使用以下命令更新您的系统</strong> <strong>包</strong>:</p><pre><code class="language-bash">sudo apt-get update</code></pre><pre><code class="language-bash">sudo apt-get upgrade</code></pre><pre><code class="language-bash">sudo reboot</code></pre><p>安装ELK之前需要<strong>安装Java 8 </strong>或者11。运行以下命令安装OpenJDK 11:</p><pre><code class="language-bash">sudo apt install openjdk-11-jdk -y</code></pre><p>您可以检查版本以确认Java安装:</p><pre><code class="language-bash">java --version</code></pre><p>然后使用下面的命令<strong>安装弹性栈PGP签名密钥</strong>:</p><pre><code class="language-bash">wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -</code></pre><p>您可以使用以下命令在Debian 11上安装ELK APT存储库:</p><pre><code class="language-bash">sudo apt install apt-transport-https</code></pre><pre><code class="language-bash">echo "deb https://artifacts.elastic.co/packages/7.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-7.x.list</code></pre><p>然后<strong>使用以下命令更新包列表</strong>的缓存:</p><pre><code class="language-bash">sudo apt update</code></pre><p>成功添加ELK存储库之后，您就可以安装弹性堆栈的各个组件了。</p><h3><span class="ez-toc-section" id="How_to_Install_Elasticsearch_on_Debian_11"/> <strong>如何在Debian 11上安装elastic search</strong>T3】</h3><p>为了<strong>安装Elasticsearch </strong>，首先运行以下命令:</p><pre><code class="language-bash">sudo apt install elasticsearch</code></pre><p>现在运行以下命令来配置Elasticsearch，以定义您想要监听的IP地址和端口，并设置发现类型和集群名称:</p><pre><code class="language-bash">sudo vim /etc/elasticsearch/elasticsearch.yml</code></pre><p>然后应用以下更改:</p><p><img data-lazyloaded="1" src="../Images/150f4fef1cf97fee944159dfd1751cf0.png" decoding="async" loading="lazy" class="aligncenter wp-image-37729 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/changes-in-Elasticsearch.webp" alt="changes-in-Elasticsearch" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/changes-in-Elasticsearch.webp 938w, https://blog.eldernode.com/wp-content/uploads/2022/06/changes-in-Elasticsearch-300x177.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/changes-in-Elasticsearch-768x453.webp 768w" data-sizes="(max-width: 938px) 100vw, 938px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/changes-in-Elasticsearch.webp"/></p><p><strong>使用以下命令调整系统内存中的JVM堆大小</strong>:</p><pre><code class="language-bash">sudo vim /etc/elasticsearch/jvm.options</code></pre><p><img data-lazyloaded="1" src="../Images/93deb917a7dbe477e4fe6c61c80ba176.png" decoding="async" loading="lazy" class="aligncenter wp-image-37731 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/JVM-heap-size.webp" alt="JVM-heap-size" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/JVM-heap-size.webp 936w, https://blog.eldernode.com/wp-content/uploads/2022/06/JVM-heap-size-300x77.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/JVM-heap-size-768x196.webp 768w" data-sizes="(max-width: 936px) 100vw, 936px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/JVM-heap-size.webp"/></p><p>现在<strong>保存</strong>文件并运行以下命令以<strong>开始并启用弹性搜索</strong>:</p><pre><code class="language-bash">sudo systemctl enable --now elasticsearch</code></pre><p>然后使用下面的命令确认状态:</p><pre><code class="language-bash">systemctl status elasticsearch</code></pre><h3><span class="ez-toc-section" id="How_to_Install_Kibana_on_Debian_11"/> <strong>如何在Debian 11上安装Kibana</strong>T3】</h3><p>使用以下命令安装Kibana :</p><pre><code class="language-bash">sudo apt install kibana</code></pre><p>使用以下命令<strong>配置Kibana </strong>:</p><pre><code class="language-bash">sudo vim /etc/kibana/kibana.yml</code></pre><p><img data-lazyloaded="1" src="../Images/c89404df377c5270171f2616540ef1ea.png" decoding="async" loading="lazy" class="aligncenter wp-image-37739 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-configuration.webp" alt="Kibana-configuration" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-configuration.webp 941w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-configuration-300x103.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-configuration-768x263.webp 768w" data-sizes="(max-width: 941px) 100vw, 941px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-configuration.webp"/></p><p>应用以下设置来配置Kibana与Elasticsearch的连接:</p><p><img data-lazyloaded="1" src="../Images/0a4996c08ba8f54ce8942c331174f7ac.png" decoding="async" loading="lazy" class="aligncenter wp-image-37742 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch.webp" alt="Kibana-connection-to-Elasticsearch" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch.webp 1128w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch-300x51.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch-1024x174.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch-768x131.webp 768w" data-sizes="(max-width: 1128px) 100vw, 1128px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-connection-to-Elasticsearch.webp"/></p><p>运行以下命令<strong>启用并启动Kibana </strong>:</p><pre><code class="language-bash">sudo systemctl enable --now kibana</code></pre><p>然后使用以下命令确认<strong> Kibana状态</strong>:</p><pre><code class="language-bash">systemctl status kibana</code></pre><p>运行以下命令来<strong>配置防火墙</strong>，以便Kibana端口可以从互联网访问:</p><pre><code class="language-bash">sudo ufw allow 5601/tcp</code></pre><p>您可以使用<strong> IP服务器</strong>或<strong>主机名</strong>和<strong>基巴纳端口</strong> : <strong> http:// &lt;服务器IP地址&gt; :5601 </strong>从浏览器<strong>访问基巴纳仪表板</strong></p><p><img data-lazyloaded="1" src="../Images/51808c99bab1f4b5607742e61b67dfa5.png" decoding="async" loading="lazy" class="aligncenter wp-image-37745 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation.webp" alt="Kibana-installation" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation.webp 1848w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation-300x138.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation-1024x471.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation-768x353.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation-1536x706.webp 1536w" data-sizes="(max-width: 1848px) 100vw, 1848px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Kibana-installation.webp"/></p><h3><span class="ez-toc-section" id="How_to_Install_Logstash_on_Debian_11"/> <strong>如何在Debian 11上安装Logstash</strong><span class="ez-toc-section-end"/></h3><p>您可以使用以下命令<strong>安装Logstash </strong>:</p><pre><code class="language-bash">sudo apt-get install logstash</code></pre><p>为了<strong>配置Logstash </strong>，首先创建一个名为<strong> 02-beats-input.conf </strong>的文件，您可以在其中配置您的Filebeat输入:</p><pre><code class="language-bash">sudo vim /etc/logstash/conf.d/02-beats-input.conf</code></pre><p>然后添加以下内容:</p><pre><code class="language-bash">input {  beats {    port =&gt; 5044   } }</code></pre><p>现在您需要将过滤器设置添加到<strong>创建系统报告</strong>，因此运行以下命令来创建另一个配置文件:</p><pre><code class="language-bash">sudo vim /etc/logstash/conf.d/10-syslog-filter.conf</code></pre><p>按以下顺序修改文件内容:</p><pre><code class="language-bash">filter { if [type] == "syslog" { grok { match =&gt; { "message" =&gt; "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" } add_field =&gt; [ "received_at", "%{@timestamp}" ] add_field =&gt; [ "received_from", "%{host}" ] } syslog_pri { } date { match =&gt; [ "syslog_timestamp", "MMM d HH:mm:ss", "MMM dd HH:mm:ss" ] } } }</code></pre><p>最后，通过Logstash创建另一个配置文件来存储Elasticsearch中的beats数据:</p><pre><code class="language-bash">sudo vim /etc/logstash/conf.d/30-elasticsearch-output.conf</code></pre><p>将以下内容添加到文件中:</p><pre><code class="language-bash">output { elasticsearch { hosts =&gt; ["your_ip_address:9200"] manage_template =&gt; false index =&gt; "ssh_auth-%{+YYYY.MM}" } }</code></pre><p>运行以下命令来<strong>启动并启用Logstash </strong>:</p><pre><code class="language-bash">sudo systemctl start logstash</code></pre><pre><code class="language-bash">sudo systemctl enable logstash</code></pre><h3><span class="ez-toc-section" id="How_to_Install_Filebeat_on_Debian_11"/> <strong>如何在Debian 11上安装Filebeat</strong>T3】</h3><p>ELK使用beats发送各种来源的数据，并提交给Logstash或Elasticsearch。<strong> Filebeat </strong>用于采集和发送报表文件。</p><p>运行以下命令将Filebeat 安装到与Elasticsearch相同的服务器上:</p><pre><code class="language-bash">sudo apt-get install filebeat</code></pre><p>要将数据发送到Logstash，运行以下命令来<strong>配置Filebeat </strong>:</p><pre><code class="language-bash">sudo vim /etc/filebeat/filebeat.yml</code></pre><p>在输出部分，应用以下更改:</p><p><img data-lazyloaded="1" src="../Images/aee082e2fe41fa0cc298530233893142.png" decoding="async" loading="lazy" class="aligncenter wp-image-37757 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Elasticsearch-Logstash-output.webp" alt="Elasticsearch-Logstash-output" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/Elasticsearch-Logstash-output.webp 945w, https://blog.eldernode.com/wp-content/uploads/2022/06/Elasticsearch-Logstash-output-300x215.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/Elasticsearch-Logstash-output-768x550.webp 768w" data-sizes="(max-width: 945px) 100vw, 945px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Elasticsearch-Logstash-output.webp"/></p><p><strong>使用以下命令启用Filebeat模块</strong>:</p><pre><code class="language-bash">sudo filebeat modules enable system</code></pre><p>然后运行以下命令<strong>加载索引模板</strong>:</p><pre><code class="language-bash">sudo filebeat setup \</code></pre><pre><code class="language-bash">--index-management -E output.logstash.enabled=false \</code></pre><pre><code class="language-bash">-E 'output.elasticsearch.hosts=["IP.address:9200"]'</code></pre><p>最后，您可以使用以下命令<strong>启动并启用Filebeat </strong>:</p><pre><code class="language-bash">sudo systemctl start filebeat</code></pre><pre><code class="language-bash">sudo systemctl enable filebeat</code></pre><p>现在<strong>登录到基巴纳</strong>到<strong>添加Filebeat索引</strong>并按照下面的路径添加一个新的索引:</p><p>管理-&gt;堆栈管理-&gt; Kibana -&gt;索引模式-&gt;创建索引模式</p><p>要搜索匹配模式，请在索引模式名称中输入<strong> filebeat </strong>。找到图案后，点击<strong>下一步</strong>:</p><p><img data-lazyloaded="1" src="../Images/4658af5a047692ebd55811e4f293d263.png" decoding="async" loading="lazy" class="aligncenter wp-image-37762 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern.webp" alt="Filebeat-index-pattern" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern.webp 1241w, https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern-300x156.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern-1024x532.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern-768x399.webp 768w" data-sizes="(max-width: 1241px) 100vw, 1241px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/Filebeat-index-pattern.webp"/></p><p>然后要配置新的索引，点击<strong>创建索引模式</strong>:</p><p><img data-lazyloaded="1" src="../Images/ec85445bffed525280c72df1a838dc21.png" decoding="async" loading="lazy" class="aligncenter wp-image-37763 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp.webp" alt="configure-timestamp" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp.webp 1351w, https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp-300x126.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp-1024x429.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp-768x322.webp 768w" data-sizes="(max-width: 1351px) 100vw, 1351px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/configure-timestamp.webp"/></p><p>最后，从上一菜单中，点击<strong>发现</strong>以显示您的数据:</p><p><img data-lazyloaded="1" src="../Images/effd44862867d86c70866d73daad3308.png" decoding="async" loading="lazy" class="aligncenter wp-image-37766 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data.webp" alt="filebeat-data" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data.webp 1897w, https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data-300x66.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data-1024x225.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data-768x168.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data-1536x337.webp 1536w" data-sizes="(max-width: 1897px) 100vw, 1897px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/06/filebeat-data.webp"/></p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，我们介绍了Elastic Stack，这是一个开源应用程序的集合，并分析了它的组件(Elasticsearch、Kibana、Logstash)的特性。通过这篇文章，你还学习了如何在Debian 11上安装Elastic Stack 7。</p></div></div>    
</body>
</html>