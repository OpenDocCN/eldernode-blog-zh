<html>
<head>
<title>Tutorial Setup Puppet On Ubuntu 21.04 &amp; 20.04 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Ubuntu 21.04 &amp; 20.04教程设置木偶- Eldernode博客</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/setup-puppet-on-ubuntu/#0001-01-01">https://blog.eldernode.com/setup-puppet-on-ubuntu/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/bd88c98268071ba21dfdf7f704f5f6c8.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial Setup Puppet On Ubuntu 21.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/05/Tutorial-Setup-Puppet-On-Ubuntu-21.04.png"/><p>Puppet是一个开源的、跨平台的企业自动化工具，用于管理和自动化服务器的配置。对于管理员来说，这是一个有用的工具，因为它能够通过网络自动配置所有的计算机系统，添加用户，安装软件包，等等。Puppet是用Ruby DSL语言编写的，遵循客户机-服务器模式。加入我们来回顾Ubuntu 21.04 上的<strong>教程设置木偶。要找到您考虑的软件包，请访问<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>并购买您自己的<a href="https://eldernode.com/ubuntu-vps/" target="_blank" rel="noopener"> Ubuntu VPS </a>托管服务。</strong></p><h2><span class="ez-toc-section" id="How_To_Setup_Puppet_On_Ubuntu_2104"/> <strong>如何在Ubuntu 21.04上设置木偶</strong> <span class="ez-toc-section-end"/></h2><p>之前给大家介绍过<a href="https://blog.eldernode.com/puppet-service-for-linux/" target="_blank" rel="noopener">木偶</a>。您可以使用它来远程执行管理任务和服务器管理。Puppet可以在<a href="https://blog.eldernode.com/tag/linux/" target="_blank" rel="noopener">的Linux </a>、Unix和<a href="https://blog.eldernode.com/tag/windows/" target="_blank" rel="noopener">的Windows </a>上使用。Puppet可以设置在具有多个模块的客户端-服务器模型中，在本指南中，我们使用Ubuntu 21.04作为我们的Puppet master或Puppet server。</p><h3><span class="ez-toc-section" id="Prerequisites_to_Install_Puppet_on_Ubuntu_2104"/> <strong>在Ubuntu 21.04上安装木偶的先决条件</strong> <span class="ez-toc-section-end"/></h3><p>为了让本教程更好地工作，请考虑以下先决条件:</p><p>_拥有Sudo权限的非root用户。要设置，请遵循我们在Ubuntu 21.04 上的<a href="https://blog.eldernode.com/initial-server-setup-on-ubuntu-21-04/" target="_blank" rel="noopener">初始服务器设置。</a></p><p>_两个或更多(主客户端和其他客户端)运行Ubuntu 21.04系统。</p><p>_与私有或公共网络相连的系统。</p><h2><span class="ez-toc-section" id="Install_Puppet_Master_and_Agent_on_Ubuntu_2104"/> <strong>在Ubuntu 21.04上安装傀儡师和代理</strong> <span class="ez-toc-section-end"/></h2><p>Puppet使用客户机-服务器模型，其中Puppetmaster控制Puppet代理的配置信息。让我们来看一下在Ubuntu 21.04上安装Puppet所需的步骤，然后准备配置和设置它。</p><p><em>第一步:</em></p><p>像往常一样，从更新Puppet master和Puppet client系统上的所有包开始。运行以下命令来更新它们:</p><pre><code class="language-bash">apt-get update -y</code></pre><p><em>第二步:</em></p><p>现在，为了让节点通过主机名一起通信，<strong>在两个节点上设置主机名</strong>。为此，在两个节点上编辑<strong> /etc/hosts </strong>文件:</p><pre><code class="language-bash">nano /etc/hosts</code></pre><p>然后，在两个节点上添加以下行:</p><pre><code class="language-bash">puppet-master-ip puppetmaster puppet</code></pre><pre><code class="language-bash">puppet-client-ip puppetclient</code></pre><p>当你完成<strong>保存</strong>和<strong>关闭</strong>文件。</p><p><em>第三步:</em></p><p>默认情况下，Puppet包在Ubuntu 21.04默认存储库中不可用。因此，为了在主节点上安装傀儡服务器，您需要在您的服务器上安装傀儡库。使用以下命令下载Puppet的最新版本:</p><pre><code class="language-bash">wget https://apt.puppetlabs.com/puppet6-release-focal.deb</code></pre><p>成功下载后，运行以下命令进行安装:</p><pre><code class="language-bash">dpkg -i puppet6-release-focal.deb</code></pre><p>安装完成后，运行以下命令来更新存储库并安装Puppet服务器:</p><pre><code class="language-bash">apt-get update -y</code></pre><pre><code class="language-bash">apt-get install puppetserver -y</code></pre><p><em>第四步:</em></p><p>现在您已经成功地安装了Puppet服务器，更改Puppet Javaprocess内存分配大小。为此，您需要编辑<strong>/etc/default/puppetserver</strong>文件:</p><pre><code class="language-bash">nano /etc/default/puppetserver</code></pre><p>完成后，<strong>保存</strong>，<strong>关闭</strong>文件。</p><p><em>第五步:</em></p><p>现在，你可以<strong>启动傀儡服务</strong>并且<strong>使</strong>它在系统重启时启动。所以，运行:</p><pre><code class="language-bash">systemctl start puppetserver</code></pre><pre><code class="language-bash">systemctl enable puppetserver</code></pre><p><em>第六步:</em></p><p>在这一步中，您可以通过运行下面的命令来验证Puppet服务的<strong>状态</strong>:</p><pre><code class="language-bash">systemctl status puppetserver</code></pre><h2><span class="ez-toc-section" id="How_to_Install_and_Configure_Puppet_Agent"/> <strong>如何安装和配置傀儡代理</strong> <span class="ez-toc-section-end"/></h2><p>现在已经安装了puppet服务器，您可以在客户机节点上安装Puppet代理了。</p><p>首先，使用下面的命令<strong>下载并安装Puppet存储库</strong>:</p><pre><code class="language-bash">wget https://apt.puppetlabs.com/puppet6-release-focal.deb</code></pre><pre><code class="language-bash">dpkg -i puppet6-release-focal.deb</code></pre><p>在安装了上面的存储库之后，运行下面的命令来<strong>安装傀儡代理</strong>:</p><pre><code class="language-bash">apt-get update -y</code></pre><pre><code class="language-bash">apt-get install puppet-agent -y</code></pre><p>安装完Puppet代理后，打开Puppet配置文件进行编辑:</p><pre><code class="language-bash">nano /etc/puppetlabs/puppet/puppet.conf</code></pre><p>然后，添加下面一行来定义傀儡主人信息:</p><pre><code class="language-bash">[main]  certname = puppetclient  server = puppetmaster</code></pre><p><strong> <em>注意</em> : </strong>确保在客户端的<strong> /etc/hosts </strong>文件中定义了这些主机名。</p><p>然后，您可以<strong>保存</strong>并<strong>关闭</strong>该文件。</p><p>现在，运行下面的命令<strong>停止</strong>、<strong>启动</strong>、<strong>使</strong>傀儡代理在客户端启动时自动启动:</p><pre><code class="language-bash">sudo systemctl stop puppet</code></pre><pre><code class="language-bash">systemctl start puppet</code></pre><pre><code class="language-bash">systemctl enable puppet</code></pre><p>同样，要验证傀儡的<strong>状态</strong>，运行以下命令:</p><pre><code class="language-bash">systemctl status puppet</code></pre><p>通过这种方式，安装并配置了傀儡代理。</p><h3><span class="ez-toc-section" id="How_to_Sign_Puppet_Agent_Certificate"/> <strong>如何签署傀儡代理人证书</strong> <span class="ez-toc-section-end"/></h3><p>由于Puppe使用客户机-服务器体系结构，您应该在代理节点配置它之前批准每个代理节点的证书请求。在此部分中，切换回服务器节点。要列出服务器上所有可用的<strong>证书</strong>，请运行以下命令:</p><pre><code class="language-bash">/opt/puppetlabs/bin/puppetserver ca list</code></pre><p>然后，为了给<strong>的所有证书</strong>签名，运行以下命令:</p><pre><code class="language-bash">/opt/puppetlabs/bin/puppetserver ca sign --all</code></pre><p>一旦在输出中得到“<em>成功签署了傀儡客户端</em>的证书请求”和“<em>成功签署了傀儡主机</em>的证书请求”，这意味着傀儡主机能够通信并控制代理节点。</p><p>最后，使用下面的命令<strong>在傀儡代理节点上测试傀儡主</strong>和<strong>代理通信</strong>:</p><pre><code class="language-bash">/opt/puppetlabs/bin/puppet agent --test</code></pre><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，您了解了如何在Ubuntu 21.04上设置Puppet。要做到这一点，您首先要学习安装傀儡师和代理。接下来，您回顾了Puppet代理的安装和配置。最后，通过签署傀儡代理证书，您已经成功地完成了本指南。因此，您将能够添加多个代理，并使用Puppet轻松管理它们。在使用该工具时向我们发送反馈，以帮助您的朋友使用您在<a href="https://community.eldernode.com/" target="_blank" rel="noopener">社区</a>上的新体验。</p></div></div>    
</body>
</html>