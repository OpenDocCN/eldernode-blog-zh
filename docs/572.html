<html>
<head>
<title>Tutorial Install LDAP Client On CentOS 7 &amp; 8 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>教程在CentOS 7和8 - Eldernode博客上安装LDAP客户端</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-ldap-client-on-centos/#0001-01-01">https://blog.eldernode.com/install-ldap-client-on-centos/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/da72e7734ff5ca215ae3acc70c47e558.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial Install LDAP Client On CentOS 7&amp;8" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/Tutorial-Install-LDAP-Client-On-CentOS-78.png"/><p><strong> LDAP </strong>是轻量级目录访问协议的缩写。LDAP是一个供应商中立的应用程序协议，它允许您通过Internet协议网络目录访问协议来访问和维护分布式目录信息服务。有许多不同的方法来提供一个目录。使用LDAP有助于您提供一个中心位置来存储用户名和密码。因此，会有许多不同的应用程序和服务可以连接到LDAP服务器来验证用户。本文介绍了在Centos 7 &amp; 8 上安装LDAP客户端的<strong>教程。在<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>上根据自己的需求选择合适的套装，购买自己的<a href="https://eldernode.com/centos-vps/" target="_blank" rel="noopener"> CentOS VPS </a>。</strong></p><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p>拥有sudo权限的非root用户。</p><p>要进行设置，请遵循我们的<a href="https://blog.eldernode.com/initial-set-up-centos-8/" target="_blank" rel="noopener">初始设置centos 8 </a>。</p><h2><span class="ez-toc-section" id="Install_LDAP_Client_On_CentOS_7_CentOS_8"/> <strong>在CentOS 7 | CentOS 8 </strong> <span class="ez-toc-section-end"/>上安装LDAP客户端</h2><p>不同种类的信息以不同的方式存储在目录中。您可以考虑关于如何引用、查询、更新该信息的不同要求，以及防止其被授权访问的方式。</p><h2><span class="ez-toc-section" id="How_To_Install_And_Configure_LDAP_Client_On_CentOS_7"/> <strong>如何在CentOS 7</strong>T3上安装和配置LDAP客户端</h2><p>加入我们，浏览本指南的步骤，在CentOS 7 上<strong>安装和配置OpenLDAP。请注意正确执行每个步骤，以完成简单的安装过程。</strong></p><p><em>第一步:</em></p><p>像往常一样，出于一些<a href="https://blog.eldernode.com/how-to-increase-website-security/" target="_blank" rel="noopener">安全</a>原因，建议你更新系统。使用下面的命令<strong>更新</strong>你所有的系统软件包到最新的可用版本:</p><pre><code class="language-bash">yum update</code></pre><p><em>第二步:</em></p><p>要<strong>安装OpenLDAP功能所需的包</strong>,运行:</p><pre><code class="language-bash">yum -y install openldap compat-openldap openldap-clients openldap-servers openldap-servers-sql openldap-devel</code></pre><p>然后，您必须启动LDAP守护程序，并在根目录上启用它。因此，键入:</p><pre><code class="language-bash">systemctl start slapd.service  systemctl enable slapd.service</code></pre><p><em>第三步:</em></p><p>要设置一个<strong> LDAP root密码</strong>并保存输出，请使用下面的命令来帮助您配置OpenLDAP。</p><pre><code class="language-bash">slappasswd</code></pre><p><em>第四步:</em></p><p>要开始<strong>配置OpenLDAP </strong>，您需要创建db.idif文件。使用nano或您喜欢的文本编辑器，将以下内容粘贴到:</p><pre><code class="language-bash">nano db.ldif</code></pre><pre><code class="language-bash">dn: olcDatabase={2}hdb,cn=config  changetype: modify  replace: olcSuffix  olcSuffix: dc=field,dc=eldernode,dc=com    dn: olcDatabase={2}hdb,cn=config  changetype: modify  replace: olcRootDN  olcRootDN: cn=ldapadm,dc=field,dc=eldernode,dc=com    dn: olcDatabase={2}hdb,cn=config  changetype: modify  replace: olcRootPW  olcRootPW: hashed_output_from_the_slappasswd_command</code></pre><p>现在，部署配置:</p><pre><code class="language-bash">ldapmodify -Y EXTERNAL -H ldapi:/// -f db.ldif</code></pre><p>接下来，您可以将监视器访问权限仅限于ldapadm用户:</p><pre><code class="language-bash">nano monitor.ldif</code></pre><pre><code class="language-bash">dn: olcDatabase={1}monitor,cn=config  changetype: modify  replace: olcAccess  olcAccess: {0}to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external, cn=auth" read by dn.base="cn=ldapadm,dc=field,dc=eldernode,dc=com" read by * none</code></pre><p>同样，通过运行以下命令来部署配置更改:</p><pre><code class="language-bash">ldapmodify -Y EXTERNAL -H ldapi:/// -f monitor.ldif</code></pre><p><em>第五步:</em></p><p>在这一步中，您需要生成一个证书和私有密钥，以便能够安全地与OpenLDAP服务器通信。运行以下命令通过此步骤。</p><pre><code class="language-bash">openssl req -new -x509 -nodes -out \</code></pre><pre><code class="language-bash">/etc/openldap/certs/myldap.field.eldernode.com.cert \</code></pre><pre><code class="language-bash">-keyout /etc/openldap/certs/myldap.field.eldernode.com.key \</code></pre><pre><code class="language-bash">-days 365</code></pre><p>要更改所有者和组权限，请键入下面的命令。它允许OpenLDAP读取文件:</p><pre><code class="language-bash">chown -R ldap:ldap /etc/openldap/certs</code></pre><p><em>第六步:</em></p><p>要配置OpenLDAP并使用LDAPS协议，您必须创建certs.ldif</p><pre><code class="language-bash">nano certs.ldif</code></pre><pre><code class="language-bash">dn: cn=config  changetype: modify  replace: olcTLSCertificateFile  olcTLSCertificateFile: /etc/openldap/certs/myldap.field.eldernode.com.cert</code></pre><pre><code class="language-bash">dn: cn=config  changetype: modify  replace: olcTLSCertificateKeyFile  olcTLSCertificateKeyFile: /etc/openldap/certs/myldap.field.eldernode.com.key</code></pre><p>同样，您可以部署配置:</p><pre><code class="language-bash">ldapmodify -Y EXTERNAL -H ldapi:/// -f certs.ldif</code></pre><p>您也可以通过运行以下命令来测试配置:</p><pre><code class="language-bash">slaptest -u</code></pre><h3><span class="ez-toc-section" id="How_to_setup_the_OpenLDAP_database"/> <strong>如何设置OpenLDAP数据库</strong> <span class="ez-toc-section-end"/></h3><p>当上述步骤完成后，您就可以设置LDAP数据库了。要启动该过程，您必须将示例数据库配置文件复制到'/var/lib/ldap '并更改文件权限。</p><pre><code class="language-bash">cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG</code></pre><pre><code class="language-bash">chown -R ldap:ldap /var/lib/ldap</code></pre><p>然后，添加LDAP模式。</p><pre><code class="language-bash">ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/cosine.ldif</code></pre><pre><code class="language-bash">ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/nis.ldif</code></pre><pre><code class="language-bash">ldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/inetorgperson.ldifv</code></pre><p>接下来，为您的域创建一个base.ldif文件:</p><pre><code class="language-bash">nano base.ldif</code></pre><pre><code class="language-bash">dn: dc=field,dc=eldernode,dc=com  dc: field  objectClass: top  objectClass: domain</code></pre><pre><code class="language-bash">dn: cn=ldapadm,dc=field,dc=eldernode,dc=com  objectClass: organizationalRole  cn: ldapadm  description: LDAP Manager</code></pre><pre><code class="language-bash">dn: ou=People,dc=field,dc=eldernode,dc=com  objectClass: organizationalUnit  ou: People</code></pre><pre><code class="language-bash">dn: ou=Group,dc=field,dc=eldernode,dc=com  objectClass: organizationalUnit  ou: Group</code></pre><p>使用ldapadm用户将这些配置更改部署到OpenLDAP服务器:</p><pre><code class="language-bash">ldapadd -x -W -D "cn=ldapadm,dc=field,dc=linuxhostsupport,dc=com" -f base.ldif</code></pre><p>当系统询问您时，请输入root密码。如果您喜欢添加用户，可以使用GUI。此外，建议您0为此使用Apache Directory Studio或JXplorer。</p><p>就是这样！LDAP现在应该已经安装在CentOS 7服务器上了。</p><h2><span class="ez-toc-section" id="How_To_Install_And_Configure_LDAP_Client_On_CentOS_8"/> <strong>如何在CentOS 8</strong>T3上安装和配置LDAP客户端</h2><p>CentOS 8存储库没有最新版本的OpenLDAP，应提供可用版本。继续本指南的步骤，在<a href="https://blog.eldernode.com/tag/centos/" target="_blank" rel="noopener"> CentOS 8上完成LDAP安装过程。</a></p><p><em>第一步:</em></p><p>要<strong>更新</strong>您的系统包，运行以下命令:</p><pre><code class="language-bash">dnf update</code></pre><p><em>第二步:</em></p><p>然后，您需要<strong>安装所需的依赖项</strong>和构建工具。要安装依赖项和构建工具的数量，请运行:</p><pre><code class="language-bash">dnf install cyrus-sasl-devel make libtool autoconf libtool-ltdl-devel openssl-devel libdb-devel tar gcc perl perl-devel wget vim</code></pre><p><em>开始3: </em></p><p>现在，是时候<strong>创建OpenLDAP系统帐户</strong>了。因为OpenLDAP将运行一个非特权系统用户，所以使用下面的命令创建一个具有自定义用户和组id的OpenLDAP系统用户。</p><pre><code class="language-bash">useradd -r -M -d /var/lib/openldap -u 55 -s /usr/sbin/nologin ldap</code></pre><p><em>开始4: </em></p><p>为了<strong>下载OpenLDAP源码tarball </strong>，最好导航到<a href="https://www.openldap.org/software/download/" target="_blank" rel="noopener"> OpenLDAP下载的页面</a>并接收该页面的最新稳定版本。</p><pre><code class="language-bash">VER=2.4.57</code></pre><pre><code class="language-bash">wget ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-$VER.tgz</code></pre><p><em>第五步:</em></p><p>现在，您可以<strong>提取OpenLDAP源代码tarball </strong>。使用下面的命令来完成此操作:</p><pre><code class="language-bash">tar xzf openldap-$VER.tgz</code></pre><p><em>第六步:</em></p><p>您需要运行配置脚本来使OpenLDAP适应您的系统，以便能够在CentOS 8上编译OpenLDAP。使用以下命令检查是否缺少任何必需的依赖项。</p><pre><code class="language-bash">cd openldap-$VER</code></pre><p>使用配置脚本构建OpenLDAP时，可以启用或禁用各种选项。</p><pre><code class="language-bash">./configure --prefix=/usr --sysconfdir=/etc --disable-static \</code></pre><pre><code class="language-bash">--enable-debug --with-tls=openssl --with-cyrus-sasl --enable-dynamic \</code></pre><pre><code class="language-bash">--enable-crypt --enable-spasswd --enable-slapd --enable-modules \</code></pre><pre><code class="language-bash">--enable-rlookups --enable-backends=mod --disable-ndb --disable-sql \</code></pre><pre><code class="language-bash">--disable-shell --disable-bdb --disable-hdb --enable-overlays=mod</code></pre><p><strong>注意</strong>:如果您需要关于配置选项的更多信息，请寻求帮助:</p><pre><code class="language-bash">./configure --help</code></pre><p>一旦配置脚本顺利完成，您将在最后一行看到以下命令。</p><pre><code class="language-bash">Please run "make depend" to build dependencies</code></pre><p>正如您所猜测的，您需要运行<em> make depend </em>命令来构建OpenLDAP依赖关系。</p><pre><code class="language-bash">make depend</code></pre><p>最后，要在CentOS 8上编译OpenLDAP，请键入:</p><pre><code class="language-bash">make</code></pre><p>如果您希望运行测试套件来验证OpenLDAPbuild是否有任何错误，请键入:</p><pre><code class="language-bash">make test</code></pre><p><strong>注意</strong>:运行上述命令是可选的，可能需要时间。</p><p><em>第七步:</em></p><p>一旦OpenLDAP的编译成功完成，您就可以使用下面的命令<strong>在CentOS 8 </strong>上安装OpenLDAP了。</p><pre><code class="language-bash">make install</code></pre><p>OpenLDAP配置文件现在安装在<em> /etc/openldap </em>上。</p><pre><code class="language-bash">ls /etc/openldap/  certs ldap.conf ldap.conf.default schema slapd.conf slapd.conf.default slapd.ldif slapd.ldif.default</code></pre><p><strong>注意</strong>:库安装在<em> /usr/libexec/openldap </em>下。</p><h3><span class="ez-toc-section" id="How_to_configure_OpenLDAP_on_CentOS_8"/> <strong>如何在CentOS 8上配置OpenLDAP</strong>T3】</h3><p>当您完成OpenLDAP安装过程后，就可以开始配置了。</p><p>要创建OpenLDAP数据和数据库目录，请运行:</p><pre><code class="language-bash">mkdir /var/lib/openldap /etc/openldap/slapd.d</code></pre><p>现在，您可以在OpenLDAP方向和配置文件上设置适当的所有权和权限。</p><pre><code class="language-bash">chown -R ldap:ldap /var/lib/openldap</code></pre><pre><code class="language-bash">chown root:ldap /etc/openldap/slapd.conf</code></pre><pre><code class="language-bash">chmod 640 /etc/openldap/slapd.conf</code></pre><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，向您展示了在CentOS 7 &amp; 8上安装LDAP客户端的教程。有些目录服务是本地的，有些是全球的。本地服务向受限制的上下文提供服务，如单个机器上的finger服务，而全局服务向更广泛的上下文提供服务。如果你有兴趣阅读更多关于LDAP的内容，可以找到我们的相关文章<a href="https://blog.eldernode.com/install-ldap-client-on-ubuntu-20-04/" target="_blank" rel="noopener">如何在Ubuntu 20.04上安装LDAP客户端</a></p></div></div>    
</body>
</html>