<html>
<head>
<title>How to Install Vaultwarden on Ubuntu 22.04 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu 22.04 - Eldernode博客上安装Vaultwarden</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-vaultwarden-on-ubuntu-22-04/#0001-01-01">https://blog.eldernode.com/install-vaultwarden-on-ubuntu-22-04/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/5c7867ab0eeca167bb0b01473fcdf27a.png" data-src="https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Install Vaultwarden on Ubuntu 22.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/05/How-to-Install-Vaultwarden-on-Ubuntu-22.04.webp"/><p>有许多不同的开源密码管理器，其中之一是Bitwarden，它集成了您用于日常操作的系统。但是，由于该服务器的设置可能不正确。因此，您可以使用Vaultwarden作为Bitwarden的替代方案，它易于设置，并与Bitwarden客户兼容。在本文中，我们将教你如何在Ubuntu 22.04 上安装Vaultwarden。<a href="https://eldernode.com/ubuntu-vps/"> <strong> Ubuntu VPS </strong> </a>服务器套装在<a href="https://eldernode.com/"> Eldernode </a>网站上提供，想要的可以查看购买。</p><h2><span class="ez-toc-section" id="Tutorial_SetupVaultwarden_on_Ubuntu_2204"/><strong>Ubuntu上的教程SetupVaultwarden 22.04</strong><span class="ez-toc-section-end"/></h2><h3><span class="ez-toc-section" id="What_is_Vaultwarden"/> <strong>什么是Vaultwarden？</strong>T3】</h3><p>Vaultwarden是用Rust编写的<a href="https://blog.eldernode.com/install-bitwarden-on-windows-rdp/"> Bitwarden </a>服务器的单进程、开源、非官方替代方案。此外，它还是一个密码管理应用程序，可以自托管并在您的基础架构上运行。由于所需资源非常少，它可以在您的浏览器和移动服务中与任何Bitwarden客户一起工作。</p><p>Vaultwarden通过Bitwarden客户端使用支持连接，不如官方的Bitwarden服务资源丰富。通过运行此服务，您可以使用服务器支持的Bitwarden浏览器扩展和移动应用程序。</p><p>在这篇文章的后续部分，在介绍了所需的先决条件之后，将会一步一步地教你如何在<a href="https://blog.eldernode.com/tag/ubuntu/"> Ubuntu </a> 22.04上安装Vaultwarden。</p><h3><span class="ez-toc-section" id="Prerequisites_to_Install_Vaultwarden_on_Ubuntu_2204"/> <strong>在Ubuntu 22.04上安装Vaultwarden的先决条件</strong> <span class="ez-toc-section-end"/></h3><p>Ubuntu 22.04服务器</p><p>2)拥有sudo权限的非root用户</p><h2><span class="ez-toc-section" id="Installing_Vaultwarden_on_Ubuntu_2204"/> <strong>在Ubuntu 22.04上安装vault warden</strong>T3】</h2><p>首先，您应该用下面的命令更新包列表:</p><pre><code class="language-bash">sudo apt update</code></pre><p>然后使用以下命令升级所有可升级的软件包:</p><pre><code class="language-bash">sudo apt upgrade</code></pre><p>更新完所需的软件包后，<strong>在以下命令的帮助下重启系统</strong>:</p><pre><code class="language-bash">sudo reboot</code></pre><p>您可以通过输入以下命令<strong>删除旧包</strong>和依赖项:</p><pre><code class="language-bash">sudo apt autoremove</code></pre><p>现在你应该<strong>移除任何旧版本的Docker </strong>和Docker引擎。为此，请运行以下命令:</p><pre><code class="language-bash">sudo apt remove docker docker.io containerd runc</code></pre><p>接下来，确保您的snapd版本已更新:</p><pre><code class="language-bash">sudo snap install core</code></pre><pre><code class="language-bash">sudo snap refresh core</code></pre><p>您可以通过运行以下命令来安装Docker :</p><pre><code class="language-bash">sudo snap install docker</code></pre><h3><span class="ez-toc-section" id="How_to_Configure_Vaultwarden_on_Ubuntu_2204"/> <strong>如何在Ubuntu 22.04 </strong> <span class="ez-toc-section-end"/>上配置 <strong> Vaultwarden</strong></h3><p>首先，您需要<strong>在您的主目录中创建一个vaultwarden目录</strong>并输入它。为此，请运行以下命令:</p><pre><code class="language-bash">mkdir ~/vaultwarden  </code></pre><pre><code class="language-bash">cd ~/vaultwarden</code></pre><p>现在打开您最喜欢的文本编辑器并<strong>创建一个新的docker-compose.yml </strong>文件:</p><pre><code class="language-bash">nano docker-compose.yml</code></pre><p>然后，您应该<strong>向文件中添加</strong>以下几行:</p><pre><code class="language-bash">version: '3'    services:    vaultwarden:      image: vaultwarden/server:latest      container_name: vaultwarden      restart: always      environment:        - WEBSOCKET_ENABLED=true      volumes:        - ./vw-data:/data      caddy:      image: caddy:2      container_name: caddy      restart: always      ports:        - 80:80        - 443:443      volumes:        - ./Caddyfile:/etc/caddy/Caddyfile:ro        - ./caddy-config:/config        - ./caddy-data:/data      environment:        - DOMAIN=        - EMAIL=        - LOG_FILE=/data/access.log</code></pre><p>然后您应该<strong>将域名</strong>或子域添加到<a href="https://blog.eldernode.com/introducing-the-caddy-web-server/"> Caddy </a>环境变量中的域值中:</p><pre><code class="language-bash">environment:    - DOMAIN=https://example.com</code></pre><p>现在，您应该<strong>将TLS/SSL </strong>证书注册的电子邮件地址添加到Caddy环境变量下的email值中。为此，请输入以下命令:</p><pre><code class="language-bash">environment:  - DOMAIN=https://example.com  - <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="86c3cbc7cfcabbf3f5e3f4c6e3fee7ebf6eae3a8e5e9eb">[email protected]</a></code></pre><p>记得保存并退出文本编辑器。你可以通过按下“<strong> CTRL+X </strong>”，然后“<strong> Y </strong>”，再按下“<strong> Enter </strong>”来实现。</p><p>现在再次打开你最喜欢的文本编辑器，创建并打开一个新的Caddyfile ，如下所示:</p><pre><code class="language-bash">nano Caddyfile</code></pre><p>然后，您需要将以下几行添加到文件中:</p><pre><code class="language-bash">{$DOMAIN}:443 {    log {      level INFO      output file {$LOG_FILE} {        roll_size 10MB        roll_keep 10      }    }      # Get a cert by using the ACME HTTP-01 challenge.    tls {$EMAIL}      encode gzip      # Headers to improve security.    header {    # Enable HSTS    Strict-Transport-Security "max-age=31536000;"      # Enable cross-site filter (XSS)    X-XSS-Protection "1; mode=block"      # Disallow the site to be rendered within a frame (clickjacking protection)    X-Frame-Options "DENY"      # Prevent search engines from indexing    X-Robots-Tag "none"      # Remove Caddy branding    -Server    }      # Redirect notifications to the WebSocket.    reverse_proxy /notifications/hub vaultwarden:3012      reverse_proxy vaultwarden:80 {         header_up X-Real-IP {remote_host}    }  }</code></pre><p>最后，记得<strong>保存</strong>和<strong>退出</strong>文本编辑器。</p><p>Caddy由Caddfile配置。这将HTTPS请求从<strong>端口443 </strong>转发到Vaultwarden，并添加了额外的头以提高安全性。</p><h3><span class="ez-toc-section" id="How_to_Run_Vaultwarden_on_Ubuntu_2204"/> <strong>如何在Ubuntu 22.04上运行vault warden</strong><span class="ez-toc-section-end"/></h3><p>现在，您应该在分离模式下运行Vaultwarden。您可以使用以下命令来完成此操作:</p><pre><code class="language-bash">sudo docker-compose up -d</code></pre><p>然后使用以下命令检查Vaultwarden是否正在运行:</p><pre><code class="language-bash">sudo docker ps  STATUS  Up x seconds/minutes</code></pre><p>请注意，状态应该是启动。</p><h3><span class="ez-toc-section" id="How_to_Configure_Additional_Security_on_Vaultwarden"/> <strong>如何在Vaultwarden </strong> <span class="ez-toc-section-end"/>上配置附加安全性</h3><p>首先，您需要禁用注册。因为任何有权访问Vaultwarden实例的人都不能创建帐户。</p><p>请注意，您可以在创建帐户后禁用注册。为此，您应该在“<strong> docker-compose.yml </strong>”中将环境变量<strong>signs _ ALLOWED</strong>设置为false</p><pre><code class="language-bash">services:  vaultwarden:  ... other configuration ...  environment:  - SIGNUPS_ALLOWED=false  ... other configuration ...</code></pre><p>Vaultwarden的一个特性是，它允许注册用户邀请其他新用户在服务器上创建帐户。如果您是单个用户，这可能会带来安全风险，最好禁用它。为此，只需在“<strong> docker-compose.yml </strong>”中将环境变量<strong> INVITATIONS_ALLOWED </strong>设置为false:</p><pre><code class="language-bash">services:  vaultwarden:  ... other configuration ...  environment:  - INVITATIONS_ALLOWED=false  ... other configuration ...</code></pre><p>Bitwarden的密码提示通常通过电子邮件发送。Vaultwarden密码提示可在密码帮助页面上找到，您不需要配置电子邮件服务。您可以将“<strong> docker-compose.yml </strong>”中的变量<strong> SHOW_PASSWORD_HINT </strong>设置为false来禁用密码提示:</p><pre><code class="language-bash">services:  vaultwarden:  ... other configuration ...  environment:  - SHOW_PASSWORD_HINT=false  ... other configuration ...</code></pre><p><em> <strong>注意:</strong> </em>如果环境变量发生变化，首先您应该借助以下步骤应用这些变化。</p><p>首先，您需要借助以下命令<strong>停止Vaultwarden </strong>:</p><pre><code class="language-bash">sudo docker-compose down</code></pre><p>现在<strong>使用以下命令返回Vaultwarden </strong>:</p><pre><code class="language-bash">sudo docker-compose up -d</code></pre><p>就是这样！您的新配置已经应用。</p><p>您可以使用Bitwarden来访问Vaultwarden实例。您只需将服务器URL更改为Vaultwarden实例，在这种情况下，您可以使用上游Bitwarden客户端。</p><p>转到您的Vaultwarden安装并登录到您的帐户:</p><pre><code class="language-bash">https://example.com</code></pre><p>最后，您应该将您的登录名和密码添加到您的vault中。</p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>Vaultwarden为许多Bitwarden应用程序和浏览器扩展提供了兼容的API。在本文中，您学习了如何使用Docker和docker-compose在Ubuntu 22.04上安装Vaultwarden。然后我们使用Caddy来保护配置。如有疑问，可在评论中联系我们。</p></div></div>    
</body>
</html>