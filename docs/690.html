<html>
<head>
<title>How to Use Traceroute to track packets on Nmap - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何使用Traceroute跟踪Nmap - Eldernode博客上的数据包</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/use-traceroute-to-track-packets-on-nmap/#0001-01-01">https://blog.eldernode.com/use-traceroute-to-track-packets-on-nmap/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/fc54a216cb3516842574a3f282e1a604.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How to Use Traceroute to track packets on Nmap" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/How-to-Use-Traceroute-to-track-packets-on-Nmap-1.png"/><p>Traceroute工具显示将数据包传输到目的地的路由器(跳)列表。该工具在所有Linux和Windows操作系统上都可用。Mikrotik路由器上也有此工具。Traceroute通常用于排除网络故障。通过显示经过的路由器，该工具使用户能够看到到达网络特定目标所必须经过的路径。在本文中，我们将教您如何使用Traceroute来跟踪Nmap 上的数据包。需要注意的是，如果你想买一个<a href="https://eldernode.com/vps/" target="_blank" rel="noopener"> VPS服务器</a>，你可以在<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>看到可用的包。</p><h2><span class="ez-toc-section" id="Tutorial_Use_Traceroute_to_track_packets_on_Nmap"/> <strong>教程使用Traceroute跟踪Nmap上的数据包</strong> <span class="ez-toc-section-end"/></h2><p>网络管理员和技术人员经常用来排除网络故障的工具之一是<a href="https://blog.eldernode.com/install-and-run-traceroute-on-ubuntu-20-04/"> Traceroute </a>。只要网络中存在延迟和连通性问题等干扰，Traceroute和Ping这两种基本但有效的工具就能帮助我们解决问题。如果两个系统的连接有问题，Traceroute首先可以确定是否有连接问题，其次可以确定问题出在哪里！Traceroute通常使用回应数据包(属于ICMP协议)以及不同数量的TTL(生存时间)。</p><p>Traceroute首先发送TTL为1的数据包。这些数据包在到达第一跳后会将TTL值减少一个单位。因此，这些数据包的TTL值为零。当TTL值达到零时，数据包首先被丢弃。第二，向发送方发送一条错误消息。</p><p>到目前为止，RTT代表了发送方(发送数据包的人和执行Traceroute命令的人)与第一跳之间的时间间隔。因为我们将TTL设置为1。</p><p>在下一步中，Traceroute开始发送TTL为2的数据包。这样做的目的是将我们的数据包仅移动到第二跳。因此，在数据包开始移动后，它们首先通过第一跳，其TTL从2降至1。然后，当数据包到达第二跳时，它们的TTL从1减少到0，结果，一个错误消息被发送到发送方。这样，发送器了解到第二跳的RTT的状态。Traceroute一直这样做，每次将TTL增加一个单位，以了解每一跳的连接状态和RTT。</p><h3><span class="ez-toc-section" id="What_is_Traceroute_and_how_does_it_work"/> <strong>什么是Traceroute，它是如何工作的？</strong>T3】</h3><p>Traceroute是计算机网络中的一个实用程序，您可以通过在CMD中键入Tracert来访问它。此工具允许您检查到达所需目的地的路线和可能的错误。</p><p>当您与网络上的其它设备通信时，信息或数据包会通过许多网络设备(如路由器)发送到目的地。现在，如果你用UTP电缆直接连接两台计算机，数据包就直接从一台计算机发送到另一台计算机。</p><p>如果您可以访问互联网上的网站，流量首先会通过路由器或本地设备。换句话说，这种流量可能通过ISP路由设备，可能是中性路由器或连接到本地和目的设备的设备。在路由设备之间传输数据包称为“跳”。因此，如果您ping一个网站，它将是您的第一个本地路由器，下一跳将是数据包到达web服务器所经过的每个路由器。</p><p>在本文的后续部分，请加入我们，通过示例向您展示如何使用Traceroute来跟踪<a href="https://blog.eldernode.com/introduction-nmap-tool-and-check-its-applications/"> Nmap </a>上的数据包。</p><h2><span class="ez-toc-section" id="Use_Traceroute_to_track_packets_on_Nmap"/> <strong>使用Traceroute跟踪Nmap上的数据包</strong> <span class="ez-toc-section-end"/></h2><p>Traceroute涉及收集流量从一点传输到另一点所经过的中间路由器的信息。有趣的是，大多数操作系统已经使用“traceroute”命令获得了这个特性。Nmap NSE (Nmap脚本引擎)套件中还附带了额外的工具。</p><h3><span class="ez-toc-section" id="An_example_of_how_Traceroute_works_with_Nmap"/><strong>Traceroute如何与Nmap一起工作的示例</strong> <span class="ez-toc-section-end"/></h3><p>在下面的例子中，我们正在追踪从我的设备到Eldernode.com的路线；应该注意，选项<strong> -sn </strong>指示Nmap忽略默认端口扫描，因为我们对扫描Eldernode.com端口不感兴趣，而只是路由、选项或标志<strong> -Pn </strong>指示Nmap避免主机发现，因为我们知道主机是活动的。</p><p><em> <strong>注:</strong> </em>选项<strong>–traceroute</strong>用于追踪所有跳或中间路由器。</p><pre><code class="language-bash">nmap -sn -Pn --traceroute eldernode.com</code></pre><p> </p><p><img data-lazyloaded="1" src="../Images/f70f828fb507dde6ddb967e574b46b7c.png" decoding="async" loading="lazy" class="aligncenter wp-image-27654 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/how-Traceroute-works-with-Nmap-1.jpg" alt="how Traceroute works" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/how-Traceroute-works-with-Nmap-1.jpg 741w, https://blog.eldernode.com/wp-content/uploads/2021/03/how-Traceroute-works-with-Nmap-1-300x206.jpg 300w" data-sizes="(max-width: 741px) 100vw, 741px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/how-Traceroute-works-with-Nmap-1.jpg"/></p><p> </p><p>通过执行上面的命令，您将看到在我的计算机和Eldernode.com服务器之间有16个设备(<strong> HOP </strong>)，它们在HOP列中指定。</p><p>您还可以在<strong> RTT列</strong>(返回时间或延迟时间)中看到包含从该跳返回的每一跳的<strong>速度</strong>，单位为毫秒。应该注意，这对于诊断连接问题非常有用。</p><p>请注意，<strong>地址</strong>列显示了每个路由器或跳设备的地址。</p><p>上图可以看到，我的第一个hopper是192.168.0.1。然后它到达7个路由器。这八台路由器位于阿根廷的布宜诺斯艾利斯，归克拉罗电信所有，该公司将流量传送到墨西哥的下一跳。然后它去迈阿密，到gblx.net路由器，最后到达托管服务。</p><p>总共有16跳，但是RTT随着路由器的通过而增加。</p><h3><span class="ez-toc-section" id="How_to_Insert_traceroute_hops_into_the_Nmap_scan_with_NSE"/> <strong>如何用NSE将traceroute跳插入Nmap扫描</strong> <span class="ez-toc-section-end"/></h3><p>在本节中，我们将了解如何使用NSE将traceroute跳插入Nmap扫描。应该注意的是，Nmap脚本引擎包括用于管理跟踪的脚本，并增加了一些很棒的特性。在这种情况下，您只能使用Nmap NSE来端口扫描所有跳接口以到达linux.lat。</p><pre><code class="language-bash">nmap --script targets-traceroute --script-args newtargets --traceroute linux.lat</code></pre><p> </p><p><img data-lazyloaded="1" src="../Images/fa5e8c86e28996945c0a6870f646e9c3.png" decoding="async" loading="lazy" class="aligncenter wp-image-27655 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1.jpg" alt="Insert traceroute hops into the Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1.jpg 899w, https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-300x245.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-768x628.jpg 768w" data-sizes="(max-width: 899px) 100vw, 899px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1.jpg"/></p><p>1</p><p><img data-lazyloaded="1" src="../Images/f1d24a40710d65885af0673b9f7b45d7.png" decoding="async" loading="lazy" class="aligncenter wp-image-27656 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1.jpg" alt="how to Insert traceroute hops into the Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1.jpg 797w, https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-300x247.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-768x632.jpg 768w" data-sizes="(max-width: 797px) 100vw, 797px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1.jpg"/></p><p>2</p><p><img data-lazyloaded="1" src="../Images/6b159e34ebd5055ff278c0caa657d25a.png" decoding="async" loading="lazy" class="aligncenter wp-image-27657 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1.jpg" alt="tutorial Insert traceroute hops into the Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1.jpg 651w, https://blog.eldernode.com/wp-content/uploads/2021/03/03-1-300x74.jpg 300w" data-sizes="(max-width: 651px) 100vw, 651px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1.jpg"/></p><p>3</p><p>关注我们，跟踪到达Eldernode.com的所有跳数:</p><pre><code class="language-bash">nmap --script targets-traceroute --script-args newtargets --traceroute eldernode.com</code></pre><p> </p><p><img data-lazyloaded="1" src="../Images/99d8fa4b86d32f2e7a3f315cec31e69c.png" decoding="async" loading="lazy" class="aligncenter wp-image-27659 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-1.jpg" alt="Use Traceroute to track packets on Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-1.jpg 950w, https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-1-300x149.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-1-768x381.jpg 768w" data-sizes="(max-width: 950px) 100vw, 950px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/01-1-1.jpg"/></p><p>4</p><p><img data-lazyloaded="1" src="../Images/d2a0006518d787a6bda1894e2e9f14e5.png" decoding="async" loading="lazy" class="aligncenter wp-image-27660 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-1.jpg" alt="Use Traceroute to track packets on Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-1.jpg 742w, https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-1-300x175.jpg 300w" data-sizes="(max-width: 742px) 100vw, 742px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/02-1-1.jpg"/></p><p>5</p><p><img data-lazyloaded="1" src="../Images/b6e46df706237fa31835314c7f0ae3b7.png" decoding="async" loading="lazy" class="aligncenter wp-image-27661 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1-1.jpg" alt="Use Traceroute to track packets on Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1-1.jpg 667w, https://blog.eldernode.com/wp-content/uploads/2021/03/03-1-1-300x196.jpg 300w" data-sizes="(max-width: 667px) 100vw, 667px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/03-1-1.jpg"/></p><p>6</p><p><img data-lazyloaded="1" src="../Images/4ac3f997e6a0488d8de3902e06854434.png" decoding="async" loading="lazy" class="aligncenter wp-image-27662 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/04-1.jpg" alt="Use Traceroute" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/04-1.jpg 654w, https://blog.eldernode.com/wp-content/uploads/2021/03/04-1-300x200.jpg 300w" data-sizes="(max-width: 654px) 100vw, 654px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/04-1.jpg"/></p><p>7</p><p><img data-lazyloaded="1" src="../Images/cf1a67314c2033ffd57ca542624766b8.png" decoding="async" loading="lazy" class="aligncenter wp-image-27663 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/05-1.jpg" alt="track packets" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/05-1.jpg 646w, https://blog.eldernode.com/wp-content/uploads/2021/03/05-1-300x201.jpg 300w" data-sizes="(max-width: 646px) 100vw, 646px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/05-1.jpg"/></p><p>8</p><p><img data-lazyloaded="1" src="../Images/c82998b514963d9050d59d87d357c4ca.png" decoding="async" loading="lazy" class="aligncenter wp-image-27664 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/06-1.jpg" alt="Use Traceroute" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/06-1.jpg 635w, https://blog.eldernode.com/wp-content/uploads/2021/03/06-1-300x206.jpg 300w" data-sizes="(max-width: 635px) 100vw, 635px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/06-1.jpg"/></p><p>9</p><p><img data-lazyloaded="1" src="../Images/78cf7b26c9b9cd24d20af29c1f30206b.png" decoding="async" loading="lazy" class="aligncenter wp-image-27665 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/07-1.jpg" alt="Use Traceroute to track packets on Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/07-1.jpg 613w, https://blog.eldernode.com/wp-content/uploads/2021/03/07-1-300x211.jpg 300w" data-sizes="(max-width: 613px) 100vw, 613px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/07-1.jpg"/></p><p>10</p><p><img data-lazyloaded="1" src="../Images/7279c0e3c4a476b5dd28673758fd3307.png" decoding="async" loading="lazy" class="aligncenter wp-image-27666 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/08-1.jpg" alt="Use Traceroute to track packets on Nmap" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/08-1.jpg 600w, https://blog.eldernode.com/wp-content/uploads/2021/03/08-1-300x218.jpg 300w" data-sizes="(max-width: 600px) 100vw, 600px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/08-1.jpg"/></p><p>11</p><p><img data-lazyloaded="1" src="../Images/4daf9f3a5b493d4e1278e55c25c5ada7.png" decoding="async" loading="lazy" class="aligncenter wp-image-27667 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/09-1.jpg" alt="Use Traceroute" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/09-1.jpg 708w, https://blog.eldernode.com/wp-content/uploads/2021/03/09-1-300x184.jpg 300w" data-sizes="(max-width: 708px) 100vw, 708px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/09-1.jpg"/></p><p>12</p><p>稍微注意一下上面的图片，您就可以很容易地看到Nmap将有关发现的跳端口的信息放在端口上。</p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>Traceroute是用来测试主机(服务器)可用性的最有用的网络工具之一。该工具的工作方式类似于带有ICMP协议的ping工具，但与ping有许多不同之处。在Traceroute中，与ping不同，它与网络上的路由器无关，网络上的每一台路由器，从Internet网关到路由器，再到目的服务器之前的路由器，都显示为单个测试，并向您显示结果。该实用程序通常用于查找路由器之间的通信问题。在本文中，我们试图通过一个例子来一步一步地教您如何使用Traceroute来跟踪Nmap上的数据包。</p></div></div>    
</body>
</html>