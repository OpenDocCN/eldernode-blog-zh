<html>
<head>
<title>How To Install OpenNMS Monitoring On Ubuntu 20.04 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu 20.04 - Eldernode博客上安装OpenNMS监控</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-opennms-monitoring-on-ubuntu-20-04/#0001-01-01">https://blog.eldernode.com/install-opennms-monitoring-on-ubuntu-20-04/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/019c8b9a38be8c423817a4fcb8783637.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How To Install OpenNMS Monitoring On Ubuntu 20.04" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/12/How-To-Install-OpenNMS-Monitoring-On-Ubuntu-20.04.png"/><p>之前给大家介绍过<a href="https://blog.eldernode.com/opennms-monitoring-for-linux/" target="_blank" rel="noopener noreferrer"> OpenNMS </a>(开放<strong> N </strong>网络<strong> M </strong>管理<strong> S </strong>系统)。作为管理员或用户，您需要检测设备和网络节点。由于所有Java编写的软件都适用于大多数<a href="https://blog.eldernode.com/tag/linux/" target="_blank" rel="noopener noreferrer"> Linux </a>发行版，在本文中，您将学习如何<strong>在Ubuntu 20.04 </strong>上安装OpenNMS Monitoring。要开始安全和经济的网络监控，请购买您自己的<a href="https://eldernode.com/ubuntu-vps/" target="_blank" rel="noopener noreferrer"> Ubuntu VPS </a>并享受我们完美的软件包和支持。</p><h2><span class="ez-toc-section" id="Tutorial_Install_OpenNMS_Monitoring_On_Ubuntu_2004"/> <strong>教程在Ubuntu 20.04上安装OpenNMS监控</strong> <span class="ez-toc-section-end"/></h2><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p><strong> 1- </strong>拥有sudo权限的非root用户。</p><p><strong> 2- </strong>要进行设置，请遵循我们在Ubuntu 20.04 上的<a href="https://blog.eldernode.com/initial-server-setup-on-ubuntu-20/" target="_blank" rel="noopener noreferrer">初始服务器设置。</a></p><p><b> 3- </b>已安装OpenJDK 11开发套件</p><p><b> 4- </b> 2个CPU，2 GB内存，20 GB磁盘</p><p><strong> 5- </strong> <a href="https://blog.eldernode.com/tutorial-postgresql-installation-ubuntu-20/" target="_blank" rel="noopener noreferrer"> PostgreSQL </a>数据库</p><h2><span class="ez-toc-section" id="Install_OpenNMS_Monitoring_On_Ubuntu_2004"/>在Ubuntu 20.04上安装OpenNMS监控<span class="ez-toc-section-end"/></h2><p>与我们一起阅读本指南，了解OpenNMS网络监控平台的安装。您可以在Ubuntu 16.04 LTS或更高版本上安装OpenNMS。让我们通过本指南的7个步骤来学习并完成它。</p><h3><span class="ez-toc-section" id="Step_1_How_To_Update_Ubuntu_Server"/>第一步:如何更新Ubuntu服务器<span class="ez-toc-section-end"/></h3><p>一如既往，我们开始安装的第一个建议是考虑安全性并更新您的系统。应该运行以下命令:</p><pre><code class="language-bash">apt-get update -y</code></pre><pre><code class="language-bash">apt-get upgrade -y</code></pre><p class="entry-title">一旦所有包的更新完成，使用下面的命令安装其他依赖项。</p><pre><code class="language-bash">apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common -y</code></pre><h3><span class="ez-toc-section" id="Step_2_How_To_Install_Java_-_OpenJDK_11_in_Ubuntu_2004"/>第二步:如何在Ubuntu 20.04中安装Java–open JDK 11<span class="ez-toc-section-end"/></h3><p>作为安装的先决条件，您可以通过键入以下命令来安装OpenJDK 11:</p><pre><code class="language-bash">sudo apt-get install openjdk-11-jdk</code></pre><p>现在，您可以验证您安装的<strong> Java </strong>的版本。</p><pre><code class="language-bash">java -version</code></pre><p>在<strong> /etc/profile </strong>文件中添加以下行，以便为所有用户设置Java环境变量。</p><pre><code class="language-bash">export JAVA_HOME=/usr/lib/jvm/java-1.11.0-openjdk-amd64</code></pre><p>然后，您可以保存文件，并读取<strong> /etc/profile </strong>文件，运行:</p><pre><code class="language-bash">source /etc/profile</code></pre><h3 id="install-docker-and-docker-compose"><span class="ez-toc-section" id="Step_3_How_To_Install_Docker_on_Ubuntu_Server"/>第三步:如何在Ubuntu服务器上安装Docker<span class="ez-toc-section-end"/></h3><p>在这一步中，您将安装Docker和Docker Compose，由于Ubuntu 20.04的默认库中没有Docker的最新版本，所以您需要安装它。使用下面的命令让它从Docker的官方仓库安装。</p><pre><code class="language-bash">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -</code></pre><p>现在添加了GPT键。现在，通过键入以下命令，尝试将Docker存储库添加到您的系统中:</p><pre><code class="language-bash">add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"</code></pre><p>添加存储库后，您可以安装Docker和Docker compose:</p><pre><code class="language-bash">apt-get install docker-ce docker-ce-cli containerd.io docker-compose -y</code></pre><p>当您确保安装了以上所有软件后，您可以通过运行以下命令来验证Docker的状态:</p><pre><code class="language-bash">systemctl status docker</code></pre><p>此外，您还可以查看已安装的Docker和Docker compose版本:</p><pre><code class="language-bash">docker -v</code></pre><pre><code class="language-bash">docker-compose -v</code></pre><h3 id="install-opennms"><span class="ez-toc-section" id="Step_4_How_To_Download_And_Install_OpenNMS"/>第四步:如何下载和安装OpenNMS <span class="ez-toc-section-end"/></h3><p>使用以下命令安装OpenNMS软件包。该命令将安装所有依赖项，例如(<strong> opennms-core </strong>和<strong> opennms-webapp-jetty </strong>)以及所有内置依赖项(<strong> jicmp6 </strong>和<strong> jicmp </strong>、<strong> postgresql </strong>和<strong> postgresql-libs </strong>)。</p><pre><code class="language-bash">mkdir opennms</code></pre><p>然后，要安装opennms，您需要创建一个新的docker-compose.yml fil，并将目录更改为OpenNMS。</p><pre><code class="language-bash">cd opennms</code></pre><pre><code class="language-bash">nano docker-compose.yml</code></pre><p>如果您希望停止允许OpenNMS Horizon apt存储库在运行时升级，您应该通过键入以下命令来禁用它:</p><pre><code class="language-bash">sudo apt-mark hold libopennms-java libopennmsdeps-java opennms-common opennms-db</code></pre><p>现在，您可以保存并关闭该文件，并运行以下命令为OpenNMS准备一个容器:</p><pre><code class="language-bash">docker-compose up -d</code></pre><p>当您确保下载OpenNMs容器时，请使用以下命令来验证正在运行的容器:</p><pre><code class="language-bash">docker ps -a</code></pre><h3><span class="ez-toc-section" id="Step_5_How_To_Initialize_and_Setup_PostgreSQL"/>第五步:如何初始化和设置PostgreSQL <span class="ez-toc-section-end"/></h3><p>因为你是在一个Ubuntu服务器上设置的，你需要知道一旦安装完成，安装程序就会初始化<strong> Postgres </strong>数据库，并使它在系统启动时自动启动。因此，您可以轻松地检查服务的运行状态:</p><p>要检查服务是否已启动并正在运行，请运行以下命令:</p><pre><code class="language-bash">sudo systemctl status postgresql</code></pre><p>现在，您已经准备好通过切换到<strong> postgres </strong>用户帐户来创建一个带有<a href="https://blog.eldernode.com/how-to-create-strong-password/" target="_blank" rel="noopener noreferrer">密码</a>的opennms数据库用户:</p><pre><code class="language-bash">sudo su - postgres</code></pre><pre><code class="language-bash">createuser -P opennms</code></pre><pre><code class="language-bash">createdb -O opennms opennms</code></pre><p>正如我们提到的，您需要考虑一个密码，使用下面的命令和</p><p>通过设置合适的密码来保护<strong> postgres </strong>默认/超级用户帐户:</p><pre><code class="language-bash">psql -c "ALTER USER postgres WITH PASSWORD 'YOUR-POSTGRES-PASSWORD';"</code></pre><p>运行以下命令，在<strong> OpenNMS Horizon </strong>配置文件中设置数据库访问:</p><pre><code class="language-bash">sudo vim /usr/share/opennms/etc/opennms-datasources.xml</code></pre><h3><span class="ez-toc-section" id="Step_6_How_To_Initialize_And_Start_OpenNMS_Horizon"/>步骤6:如何初始化和启动OpenNMS Horizon <span class="ez-toc-section-end"/></h3><p>初始化OpenNMS需要与Java集成，因此要检测Java环境并保存在<strong>/usr/share/OpenNMS/etc/Java . conf</strong>配置文件中，您需要运行下面的命令:</p><pre><code class="language-bash">sudo /usr/share/opennms/bin/runjava -s</code></pre><p>一旦初始化了OpenNMS，就需要对数据库重复这一步，并检测保存在<strong>/opt/OpenNMS/etc/libraries . properties/opt/OpenNMS/etc/libraries . properties</strong>中的系统库。为此，请作为OpenNMS安装程序运行以下命令:</p><pre><code class="language-bash">sudo /usr/share/opennms/bin/install -dis  </code></pre><p>您可以使用systemd来启动OpenNMS服务，并让它使用自动启动模式，您需要在系统启动时启用它，并通过运行以下命令来检查其状态:</p><pre><code class="language-bash">sudo systemctl start opennms</code></pre><pre><code class="language-bash">sudo systemctl enable opennms</code></pre><pre><code class="language-bash">sudo systemctl status opennms</code></pre><p>最后，对于这一步，如果您的系统上运行了<a href="https://blog.eldernode.com/setup-firewall-ufw-ubuntu-20/" target="_blank" rel="noopener noreferrer"> UFW防火墙</a>，请打开防火墙中的端口8980:</p><pre><code class="language-bash">sudo ufw allow 8980/tcp</code></pre><pre><code class="language-bash">sudo ufw reload</code></pre><h3><span class="ez-toc-section" id="Step_7_How_To_Access_OpenNMS_Web_Console_and_login"/>步骤7:如何访问OpenNMS Web控制台并登录<span class="ez-toc-section-end"/></h3><p>在最后一步，您会看到访问OpenNMS web控制台是多么容易。你只需要打开一个网页浏览器，指向以下网址。</p><pre><code class="language-bash">http://SERVER_IP:8980/opennms  </code></pre><p>运筹学</p><pre><code class="language-bash">http://FDQN-OF-YOUR-SERVER:8980/opennms</code></pre><p>登录界面显示后，使用默认登录凭据并输入用户名和密码。将他们两人都视为管理员</p><p><img data-lazyloaded="1" src="../Images/fe596edb936b05334c0ddf6406f3bf6f.png" decoding="async" loading="lazy" class="aligncenter wp-image-19506 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2020/12/opennmsd.jpg" alt="OpenNMS Web Console" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/12/opennmsd.jpg 504w, https://blog.eldernode.com/wp-content/uploads/2020/12/opennmsd-300x270.jpg 300w" data-sizes="(max-width: 504px) 100vw, 504px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/12/opennmsd.jpg"/></p><p> </p><p>第一次成功登录后，您就可以访问管理控制面板了。</p><p><img data-lazyloaded="1" src="../Images/42556be75ba48b0e1c676d29703a70f5.png" decoding="async" loading="lazy" class="wp-image-19504 size-full aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2020/12/opennms-default-admin-dashboard.png" alt="OpenNMS Admin Dashboard" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/12/opennms-default-admin-dashboard.png 800w, https://blog.eldernode.com/wp-content/uploads/2020/12/opennms-default-admin-dashboard-300x219.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/12/opennms-default-admin-dashboard-768x562.png 768w" data-sizes="(max-width: 800px) 100vw, 800px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/12/opennms-default-admin-dashboard.png"/></p><p> </p><p>正如您所猜测的，在使用OpenNMS的后续步骤中，您将需要更改默认的管理员密码。</p><p> </p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在这篇文章中。你已经学会了如何在Ubuntu 20.04上安装OpenNMS Monitoring。使用此软件，您可以提供一个不需要操作员来管理和配置网络设备的环境。</p></div></div>    
</body>
</html>