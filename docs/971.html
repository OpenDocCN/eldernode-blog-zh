<html>
<head>
<title>How To Install Squid Proxy Server On Ubuntu 20.04 LTS - [Video]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在Ubuntu 20.04 LTS上安装Squid代理服务器-[视频]</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-squid-proxy-server-on-ubuntu-20-04/#0001-01-01">https://blog.eldernode.com/install-squid-proxy-server-on-ubuntu-20-04/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/6436585fb638bbe2cbf8353959ad53c5.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="How To Install Squid Proxy Server On Ubuntu 20.04 LTS" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/How-To-Install-Squid-Proxy-Server-On-Ubuntu-20.04-LTS.png"/><p>Squid是一个代理服务器，或者充当代理和缓存服务器。捕捉和转发HTTP web浏览器是Squid做的事情。当它将请求转发到所需的目的地时，它还可以保存它们的内容。感觉你的web服务器速度更高，缓存web，DNS是使用Squid的第一个特性。加入我们这篇文章，学习如何在Ubuntu 20.04 LTS版上安装Squid代理服务器。squid最初被设计为在类Unix系统上作为守护程序运行。要购买你的<a href="https://eldernode.com/linux-vps/" target="_blank" rel="noopener"> Linux VPS </a>，看看<a href="https://eldernode.com/" target="_blank" rel="noopener"> Eldernode </a>上提供的软件包。</p><h2><span class="ez-toc-section" id="Tutorial_Install_Squid_Proxy_Server_On_Ubuntu_2004_LTS"/> <strong>教程在Ubuntu 20.04上安装Squid代理服务器LTS</strong>T3】</h2><p> </p><p>为了让本教程更好地发挥作用，请考虑以下<strong>先决条件</strong>:</p><p>拥有sudo权限的非root用户。</p><p>要进行设置，请遵循我们在Ubuntu 20.04 上的<a href="https://blog.eldernode.com/initial-server-setup-on-ubuntu-20/" target="_blank" rel="noopener">初始服务器设置。</a></p><h2><span class="ez-toc-section" id="Install_Squid_Proxy_Server_On_Ubuntu_2004_Ubuntu_1804"/> <strong>在Ubuntu 20.04 | Ubuntu 18.04 </strong> <span class="ez-toc-section-end"/>上安装Squid代理服务器</h2><p>新版本的Squid可以在Windows上使用。Squid是免费的，在GNU通用公共许可证下发布。让我们通过本指南的步骤来学习如何在<a href="https://blog.eldernode.com/tag/ubuntu/" target="_blank" rel="noopener"> Ubuntu </a>上安装Squid。</p><p>第一步:</p><p>首先，<strong>通过运行以下命令将</strong>您的系统软件包更新到最新版本:</p><pre><code class="language-bash">sudo apt-get update</code></pre><pre><code class="language-bash">sudo apt-get upgrade</code></pre><p>第二步:</p><p>一旦系统更新，您可以轻松快速地安装Squid。因为<strong> Squid包</strong>在Ubuntu 20.04默认库中是可用的。</p><pre><code class="language-bash">sudo apt-cache policy squid</code></pre><p>另外，如果您愿意，您可以使用下面的命令来搜索<strong> Squid包</strong>:</p><pre><code class="language-bash">apt show squid</code></pre><p>第三步:</p><p>使用下面的命令<strong>安装Squid </strong>。一旦“Active: active (running)”显示在输出中，squid就安装好了。</p><pre><code class="language-bash">sudo apt-get install -y squid</code></pre><pre><code class="language-bash">sudo systemctl start squid</code></pre><pre><code class="language-bash">sudo systemctl enable squid</code></pre><pre><code class="language-bash">sudo systemctl status squid</code></pre><p>第四步:</p><p>在这一步，您将<strong>在Ubuntu 20.04上配置Squid代理服务器</strong>。</p><p>默认的Squid代理配置文件位于ar<em>/etc/squide/squide . conf</em>中。nd <em> /etc/squid/conf.d/ </em>目录。配置文件可以由文本编辑器编辑。尽管配置中提供了一些最低设置，但您可以对其进行一些更改。但是在修改它之前，创建一个原始文件的备份。</p><pre><code class="language-bash">sudo cp /etc/squid/squid.conf /etc/squid/squid.conf.orig</code></pre><p>现在，用你最喜欢的文件编辑器打开文件，在<em> /etc/squid/squid/conf </em>中调整你的自定义设置。</p><pre><code class="language-bash">sudo vim /etc/squid/squid.conf</code></pre><p>第五步:</p><p>是时候<strong>改变Squid默认端口</strong>了。它的默认端口是3128。打开squid.conf文件并查找http_port行以向其发出警报。在下面，您可以将其更改为您考虑的端口号，然后保存文件。</p><pre><code class="language-bash">#http_port 3128</code></pre><pre><code class="language-bash">http_port 8080</code></pre><p>要确保允许端口通过防火墙，请键入:</p><pre><code class="language-bash">sudo ufw allow 8080/tcp</code></pre><pre><code class="language-bash">sudo ufw enable</code></pre><p>第六步:</p><p>现在，您应该<strong>设置Squide缓存大小</strong>。使用以下设置来设置您的首选高速缓存。例如，如果256MB就足够了:</p><pre><code class="language-bash">cache_mem 256 MB</code></pre><p>第七步:</p><p>然后，您可以通过<strong>指定要使用的DNS名称服务器</strong>。您需要定义自己的DNS服务器。使用以下命令来完成此操作。</p><pre><code class="language-bash">dns_nameservers 8.8.8.8 8.8.4.4</code></pre><p>第八步:</p><p>在这一部分中，我们将介绍一个访问控制列表<strong>一个访问控制列表<strong>一个控制列表<strong>一个控制列表</strong>。是关于<strong> Squid ACL和http_access </strong>的。您可能需要允许来自特定网络或IP地址的访问，而拒绝其他访问，因为代理服务器对通过它的内容是有选择性的。使用<strong> ACL </strong>帮助您定义什么是允许的，什么是拒绝的。因此，要添加您选择的规则，请编辑<em> squid.conf </em>。</strong></strong></p><p>第九步:</p><p>您可以<strong>为Squid代理服务器</strong>定义ACL。使用ACL，您可以选择允许哪些内容通过代理服务器，不允许哪些内容通过。这些语句定义了这些权限，应该以<em> <strong> acl </strong> </em>开头，后跟规则的名称。名称后是<em> <strong> acltype </strong> </em>和<strong>自变量</strong>或<strong>文件</strong>。文件必须只包含一个项目。</p><pre><code class="language-bash">acl aclname acltype argument..  acl aclname acltpe “file”…</code></pre><p>您可以通过在每行开头添加#来选择禁用。看看下面的例子，看看如何创建新的规则。</p><p>允许局域网通过Squid代理服务器。</p><p>创建了<em> <strong> acl </strong> </em>规则</p><pre><code class="language-bash">acl my_lan src 192.168.100.0/24</code></pre><p>您可以使用<strong> http_access </strong>指令基于定义的规则来允许/拒绝。如果您决定允许:</p><pre><code class="language-bash">http_access allow my_lan</code></pre><p>当您随时创建ACL访问规则时，最新的规则应该是<strong> deny all </strong>。如果您在允许所有必需的站点时不这样做，您可能会阻止自己访问某些必需的站点。</p><pre><code class="language-bash">http_access deny all</code></pre><p>第十步:</p><p>在与许多网站合作时，要在Squide代理服务器中<strong>拒绝对特定网站的访问，请尝试将它们全部放在一个文件中，然后调用它。这有助于你做得更容易，更有条理。如果没有，列出<strong> <em> acl </em> </strong>规则中的引用。让我们看一个例子。要在squide目录中创建一个名为<em> deniedsite.squid </em>的文件，您应该运行:</strong></p><pre><code class="language-bash">sudo vim /etc/squid/deniedsites.squid</code></pre><p>然后添加您希望拒绝的站点。在下文中，我们以网站为例。</p><pre><code class="language-bash">facebook.com</code></pre><pre><code class="language-bash">youtube.com</code></pre><p>当您打开<em> squid.conf </em>时，为您决定拒绝的站点创建一个<em> acl </em>规则，并添加一个拒绝规则。最后，您可以保存文件。</p><pre><code class="language-bash">acl deniedsites dstdomain “/etc/squid/deniedsites.squid”  http_access deny deniedsites</code></pre><p>要列出<em> acl </em>乐途中的站点，运行:</p><pre><code class="language-bash">acl deniedsites dstdomain facebook.com youtubecom  http_access deny deniedsites</code></pre><p>不要忘记在任何时候进行更改时重新启动squid服务器。</p><pre><code class="language-bash">systemctl restart squid</code></pre><p>第十一步:</p><p>您可以使用关键字来<strong>阻止流量。创建一个包含关键字的文件，并创建一个<em> acl </em>规则来拒绝流量，您可以使用文件名。然后添加您的关键字并保存。</strong></p><pre><code class="language-bash">sudo vim /etc/squid/keywords.squid.</code></pre><pre><code class="language-bash">gamble  nudes</code></pre><p>然后，退出<em> squid.conf </em>以创建acl并拒绝规则保存。</p><p><strong>注意</strong>:记得重启squid。</p><p>acl关键字URL _ regex-I "/etc/squid/keywords . squid "<br/>http _ access拒绝关键字</p><p>键入下面的命令以打开Squid代理服务器中的端口。</p><pre><code class="language-bash">acl Safe_ports port &lt;port-number&gt;</code></pre><p>第十二步:</p><p>另外，<strong>可以屏蔽Squid代理服务器</strong>上的输出流量。代理服务器暴露代理的IP地址而不是你自己的地址来隐藏你的身份。当然，它也可以通过HTTP传出流量让它为人所知。您可以通过编辑<strong> <em> squid.conf </em> </strong>文件禁用此功能，并通过头文件禁用<em>。检查上带有<strong> #via的行，然后取消注释，从</strong> </em>上的<em> <strong>变为<em> <strong>关</strong> </em>。</strong></em></p><pre><code class="language-bash"># via on</code></pre><pre><code class="language-bash">via off</code></pre><p>请考虑您应该禁用代理，以便不在已转发的HTTP请求中附加客户端IP地址。为此，修改<strong> squid.conf </strong>文件中的以下行。因此，如果您需要隐藏您的squid代理服务器，请删除Squid代理头。在标记中添加以下行；请求_标题_访问。</p><pre><code class="language-bash">request_header_access From deny all  request_header_access Server deny all  request_header_access WWW-Authenticate deny all  request_header_access Link deny all  request_header_access Cache-Control deny all  request_header_access Proxy-Connection deny all  request_header_access X-Cache deny all  request_header_access X-Cache-Lookup deny all   request_header_access X-Forwarded-For deny all  request_header_access Pragma deny all  request_header_access Keep-Alive deny all</code></pre><p>现在，保存<em> squid.conf </em>，同样不要忘记重启squid。</p><pre><code class="language-bash">systemctl restart squid</code></pre><p>第十三步:</p><p>您可以<strong>检查Squide配置错误</strong>。使用下面的命令查看配置文件中的错误。</p><pre><code class="language-bash">sudo squid -k parse</code></pre><p>第十四步:</p><p>现在，您已经准备好<strong>配置客户端通过Squid代理服务器</strong>进行连接。用户身份验证的配置是您应该首先做的。在squide.conf文件中启用HTTP身份验证，然后安装apache2-utils。</p><pre><code class="language-bash">apt install -y apache2-utils</code></pre><p>为了存储用户，您需要创建一个文件，该文件必须由默认的Squid用户<em>代理</em>拥有。例如，我们将其命名为“passwd”</p><pre><code class="language-bash">touch /etc/squid/passwd  chown proxy: /etc/squid/passwd</code></pre><p>然后，您可以添加用户。在这里，我们称之为noodi。</p><pre><code class="language-bash">htpasswd /etc/squid/passwd noodi  New password:  Re-type new password:  Adding password for user lornahtpasswd /etc/squid/passwd noodi  New password:  Re-type new password:  Adding password for user noodi</code></pre><p>然后，在<strong> squid.conf </strong>文件中添加以下几行。记得保存文件并重启squid。</p><pre><code class="language-bash">auth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwd  auth_param basic children 5  auth_param basic realm Squid Basic Authentication  auth_param basic credentialsttl 2 hours  acl auth_users proxy_auth REQUIRED  http_access allow auth_users</code></pre><p>为了确保使用正确的路径并且不存在错误，您可以通过运行以下命令来检查basic_ncsa_auth的位置:</p><pre><code class="language-bash">dpkg -L squid | grep ncsa_auth</code></pre><p>您可以测试您的Squid代理是否正常工作。转到您的客户端web浏览器并配置手动代理验证。打开你偏好的浏览器，点击三个工具条，然后点击<strong>编辑</strong>下的<strong>偏好</strong>。点击<strong>网络设置</strong>下的<strong>设置</strong>。点击<strong>手动代理配置</strong>单选按钮，并在页面出现时填写您的代理服务器详细信息。此外，在“<strong>无</strong>代理”下，您可以根据需要排除其他IP地址的代理。</p><p><img data-lazyloaded="1" src="../Images/9a141ea0693713ad327b80da330a5b5a.png" decoding="async" loading="lazy" class="size-full wp-image-21848 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5286-1.jpg" alt="Test the proxy server" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5286-1.jpg 769w, https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5286-1-278x300.jpg 278w" data-sizes="(max-width: 769px) 100vw, 769px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5286-1.jpg"/></p><p> </p><p>要确认您的Squid代理设置是否有效，请再次打开浏览器并尝试搜索受限站点，当您看到一个页面说“代理服务器拒绝连接”时，这意味着这一部分的所有操作都已成功完成。</p><p><img data-lazyloaded="1" src="../Images/d27bc56371fda3ad9f65e88fdc9d5f97.png" decoding="async" loading="lazy" class="size-full wp-image-21849 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5287.jpg" alt="Confirm Squid proxy set up" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5287.jpg 1024w, https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5287-300x138.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5287-768x354.jpg 768w" data-sizes="(max-width: 1024px) 100vw, 1024px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5287.jpg"/></p><p> </p><p>若要检查身份验证状态，请打开另一个网站(无限制)。并检查输入用户名和密码后是否会提示您进行身份验证。我的意思是，与上一部分相反，这次你应该可以访问这个网站。</p><h3><span class="ez-toc-section" id="Learn_Setup_Squid_Proxy_Server_On_Ubuntu_Server"/> <strong>学习在Ubuntu服务器上设置Squid代理服务器</strong> <span class="ez-toc-section-end"/></h3><p> </p><p><img data-lazyloaded="1" src="../Images/010bf0f3ba99c8ba5bebf3f13fc07d0c.png" decoding="async" loading="lazy" class="size-full wp-image-21870 aligncenter" data-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5288-1.jpg" alt="how to access the site" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5288-1.jpg 1024w, https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5288-1-300x138.jpg 300w, https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5288-1-768x354.jpg 768w" data-sizes="(max-width: 1024px) 100vw, 1024px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/01/IMG_5288-1.jpg"/></p><p> </p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>在本文中，您了解了如何在Ubuntu 20.04 LTS上安装Squid代理服务器。如果您已经仔细完成了所有步骤，安装应该会成功。因为当另一个服务器请求相同的信息时，Squid会为请求提供相同的内容，所以它可以提高下载速度并节省带宽。如果你有兴趣阅读更多内容，可以找到我们关于如何在Kali Linux上配置Burp套件的文章。</p></div></div>    
</body>
</html>