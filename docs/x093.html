<html>
<head>
<title>5 Steps to Install Moodle on AlmaLinux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在AlmaLinux上安装Moodle的5个步骤</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/install-moodle-on-almalinux/#0001-01-01">https://blog.eldernode.com/install-moodle-on-almalinux/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/30bfff36cc8303685f2ca30f394c7540.png" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux.webp" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="5 Steps to Install Moodle on AlmaLinux" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux.webp 2069w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux-300x164.webp 300w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux-1024x561.webp 1024w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux-768x421.webp 768w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux-1536x842.webp 1536w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux-2048x1122.webp 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Steps-to-Install-Moodle-on-AlmaLinux.webp"/><p>Moodle是第一批在为用户重建在线环境方面做得非常出色的软件公司之一。这家公司通过提供能够调整和增强全球在线教育的软件，在这一领域发挥了重要作用。Moodle能够向其他公司展示教育不仅仅依赖于传统的智力教育方法。本文将教你在AlmaLinux上安装Moodle的5个步骤。如果你打算购买一台<a href="https://eldernode.com/linux-vps/"> Linux VPS </a>服务器，请查看<a href="https://eldernode.com/"> Eldernode </a>网站上提供的软件包。</p><h2><span class="ez-toc-section" id="What_is_Moodle"/> <strong>什么是Moodle？</strong>T3】</h2><p><a href="https://blog.eldernode.com/setup-moodle-on-a-dedicated-server/"> Moodle </a>代表模块化面向对象的动态学习环境，是一个开源免费的学习管理系统。它为电子学习提供了一个平台，并在GNU通用公共许可证下发布。您可以在学校、大学、工作场所和其他部门使用它进行混合学习、远程教育、翻转课堂和其他在线学习项目。事实上，Moodle是最受欢迎的学习管理系统，适合所有的组织类型。</p><h3><span class="ez-toc-section" id="Requirements_to_Install_Moodle_on_AlmaLinux"/> <strong>要求在AlmaLinux上安装Moodle</strong><span class="ez-toc-section-end"/></h3><p>在进行任何操作之前，您需要安装以下要求:</p><p>1-&gt;<a href="https://blog.eldernode.com/install-php-7-4-and-php-8-on-almalinux/">在AlmaLinux上安装PHP 7.4和PHP 8</a></p><p>2-&gt;<a href="https://blog.eldernode.com/install-and-use-sql-server-on-almalinux/">在AlmaLinux上安装SQL Server</a></p><p>3 –&gt;如果尚未安装基本实用程序包，请安装它们:</p><pre><code class="language-bash">sudo dnf install wget curl nano unzip yum-utils -y</code></pre><h3><span class="ez-toc-section" id="1-_Configuring_Firewall_on_AlmaLinux"/> <strong> 1-在AlmaLinux上配置防火墙</strong> <span class="ez-toc-section-end"/></h3><p>第一步，您应该配置防火墙。为此，请使用以下命令检查防火墙的状态:</p><pre><code class="language-bash">sudo firewall-cmd --state</code></pre><p>您可以列出防火墙上的活动服务和端口，如下所示:</p><pre><code class="language-bash">sudo firewall-cmd --permanent --list-services</code></pre><p>现在，您需要通过运行以下命令来打开HTTP和HTTPS端口。因为Moodle需要它们来运行:</p><pre><code class="language-bash">sudo firewall-cmd --add-service=http --permanent</code></pre><pre><code class="language-bash">sudo firewall-cmd --add-service=https --permanent</code></pre><p>最后，重新加载防火墙以应用更改，如下所示:</p><pre><code class="language-bash">sudo firewall-cmd --reload</code></pre><h3><span class="ez-toc-section" id="2-_Installing_Nginx_on_AlmaLinux"/> <strong> 2-在AlmaLinux上安装Nginx</strong><span class="ez-toc-section-end"/></h3><p>在这一步，你可以通过下载官方的Nginx库来安装最新的Nginx版本。</p><p>现在您应该创建官方的Nginx存储库。为此，创建一个用您想要的文本编辑器打开的<strong>/etc/yum . repos . d/nginx . repo</strong>文件:</p><pre><code class="language-bash">sudo nano /etc/yum.repos.d/nginx.repo</code></pre><p>打开文件后，在其中添加以下代码:</p><pre><code class="language-bash">[nginx-stable]  name=nginx stable repo  baseurl=http://nginx.org/packages/centos/$releasever/$basearch/  gpgcheck=1  enabled=1  gpgkey=https://nginx.org/keys/nginx_signing.key  module_hotfixes=true    [nginx-mainline]  name=nginx mainline repo  baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/  gpgcheck=1  enabled=0  gpgkey=https://nginx.org/keys/nginx_signing.key  module_hotfixes=true</code></pre><p>按下<strong> Ctrl+X </strong>到<strong>保存</strong>文件。</p><p>是时候安装Nginx服务器了，如下所示:</p><pre><code class="language-bash">sudo dnf install nginx</code></pre><p>如果您想要验证安装，以下命令可以帮助您:</p><pre><code class="language-bash">nginx -v</code></pre><h2><span class="ez-toc-section" id="3-_Installing_and_Configuring_Moodle_on_AlmaLinux"/> <strong> 3-在AlmaLinux上安装和配置Moodle</strong><span class="ez-toc-section-end"/></h2><p>首先，您需要为Moodle创建公共目录:</p><pre><code class="language-bash">sudo mkdir /var/www/html/moodle</code></pre><p>为了让登录用户能够访问该目录，您必须允许如下内容:</p><pre><code class="language-bash">sudo chown -R $USER:$USER /var/www/html/moodle</code></pre><p>并切换到公共目录:</p><pre><code class="language-bash">cd /var/www/html/moodle</code></pre><p>Moodle需要Git来抓取应用程序文件。为了<strong>安装Git </strong>，运行下面的命令:</p><pre><code class="language-bash">sudo dnf install git</code></pre><p>现在，您应该克隆Moodle Github存储库，如下所示:</p><pre><code class="language-bash">git clone https://github.com/moodle/moodle.git</code></pre><p>如果要检查可用分支列表，请运行以下命令:</p><pre><code class="language-bash">git branch -a</code></pre><p>然后创建一个名为<strong> MOODLE_400_STABLE </strong>的本地分支，并将其设置为跟踪远程分支，如下所示:</p><pre><code class="language-bash">git branch --track MOODLE_400_STABLE origin/MOODLE_400_STABLE</code></pre><p>运行以下命令切换到新创建的本地分支:</p><pre><code class="language-bash">git checkout MOODLE_400_STABLE</code></pre><p>现在，您应该使用以下命令为Moodle创建一个数据目录:</p><pre><code class="language-bash">sudo mkdir /var/moodledata</code></pre><p>接下来，给Moodle数据目录适当的权限，如下所示:</p><pre><code class="language-bash">sudo chown -R nginx /var/moodledata</code></pre><pre><code class="language-bash">sudo chmod -R 775 /var/moodledata</code></pre><p>并授予对Moodle目录的写权限:</p><pre><code class="language-bash">sudo chmod -R 755 /var/www/html/moodle</code></pre><p>是时候配置Moodle了。为此，请导航至Moodle目录:</p><pre><code class="language-bash">cd /var/www/html/moodle</code></pre><p>现在您应该创建Moodle配置文件。为此，请复制示例配置文件:</p><pre><code class="language-bash">cp config-dist.php config.php</code></pre><p>打开配置文件进行编辑:</p><pre><code class="language-bash">nano config.php</code></pre><p>找到数据库配置部分并配置数据库，所有Moodle数据将存储如下:</p><pre><code class="language-bash">CFG-&gt;dbtype = 'mysqli'; // 'pgsql', 'mariadb', 'mysqli', 'auroramysql', 'sqlsrv' or 'oci'  CFG-&gt;dblibrary = 'native'; // 'native' only at the moment  CFG-&gt;dbhost = 'localhost'; // eg 'localhost' or 'db.isp.com' or IP  CFG-&gt;dbname = 'moodledb'; // database name, eg moodle  CFG-&gt;dbuser = 'moodleuser'; // your database username  CFG-&gt;dbpass = 'YourPassword23!'; // your database password  CFG-&gt;prefix = 'mdl_'; // prefix to use for all table names</code></pre><p>现在您需要配置Moodle域名和数据目录的位置:</p><pre><code class="language-bash">CFG-&gt;wwwroot = 'https://moodle.sample.com';</code></pre><pre><code class="language-bash">CFG-&gt;dataroot = '/var/moodledata';</code></pre><p>最后，保存文件并关闭它。</p><h3><span class="ez-toc-section" id="4-_Installing_SSL_and_Configuring_Nginx_on_AlmaLinux"/> <strong> 4-在AlmaLinux上安装SSL和配置Nginx</strong><span class="ez-toc-section-end"/></h3><p>首先，安装Certbot工具，使用下面的命令加密API来生成SSL证书:</p><pre><code class="language-bash">sudo dnf install certbot</code></pre><p>现在生成SSL证书，如下所示。请注意，以下代码会将证书下载到服务器上的<strong>/etc/lets encrypt/live/Moodle . example . com</strong>目录中:</p><pre><code class="language-bash">sudo certbot certonly --standalone --agree-tos --no-eff-email --staple-ocsp --preferred-challenges http -m <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="442a252921043725293428216a272b29">[email protected]</a> -d moodle.sample.com</code></pre><p>运行以下命令生成Diffie-Hellman组证书:</p><pre><code class="language-bash">sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 4096</code></pre><p>然后，您应该为“让我们加密自动续订”创建一个质询web根目录，如下所示:</p><pre><code class="language-bash">sudo mkdir -p /var/lib/letsencrypt</code></pre><p>现在需要创建Cron作业来更新SSL。为此，创建<strong>/etc/cron . daily/cert bot-renew</strong>文件，并使用您想要的文本编辑器打开它:</p><pre><code class="language-bash">sudo nano /etc/cron.daily/certbot-renew</code></pre><p>向其中添加以下代码:</p><pre><code class="language-bash">#!/bin/sh  certbot renew --cert-name moodle.sample.com --webroot -w /var/lib/letsencrypt/ --post-hook "systemctl reload nginx"</code></pre><p><strong>保存</strong>文件并关闭。</p><p>然后，通过更改任务文件的权限使其可执行，如下所示:</p><pre><code class="language-bash">sudo chmod +x /etc/cron.daily/certbot-renew</code></pre><p>是时候配置Nginx了。为此，创建/<strong>etc/nginx/conf . d/Moodle . conf</strong>，并使用您想要的文本编辑器打开它:</p><pre><code class="language-bash">sudo nano /etc/nginx/conf.d/moodle.conf</code></pre><p>并向其中添加以下代码:</p><pre class="command"><code class="language-bash"># Redirect all non-encrypted to encrypted  server {      listen 80;      listen [::]:80;      server_name moodle.example.com;      return 301 https://$host$request_uri;  }    server {      listen 443 ssl http2;      listen [::]:443 ssl http2;            server_name moodle.example.com;      root   /var/www/html/moodle;      index  index.php;        ssl_certificate     /etc/letsencrypt/live/moodle.example.com/fullchain.pem;      ssl_certificate_key /etc/letsencrypt/live/moodle.example.com/privkey.pem;      ssl_trusted_certificate /etc/letsencrypt/live/moodle.example.com/chain.pem;      ssl_session_timeout 1d;      ssl_session_cache shared:MozSSL:10m;      ssl_session_tickets off;      ssl_stapling on;      ssl_stapling_verify on;      ssl_dhparam /etc/ssl/certs/dhparam.pem;            ssl_protocols TLSv1.2 TLSv1.3;      ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;        access_log /var/log/nginx/moodle.access.log main;      error_log  /var/log/nginx/moodle.error.log;            client_max_body_size 25M;        location / {          try_files $uri $uri/ /index.php?$query_string;      }            location ~ ^(.+\.php)(.*)$ {          fastcgi_split_path_info ^(.+\.php)(.*)$;          fastcgi_index index.php;          fastcgi_pass unix:/run/php-fpm/www.sock;          include /etc/nginx/mime.types;          include fastcgi_params;          fastcgi_param  PATH_INFO  $fastcgi_path_info;          fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;      }            # Hide all dot files but allow "Well-Known URIs" as per RFC 5785  	location ~ /\.(?!well-known).* {      	return 404;  	}     	# This should be after the php fpm rule and very close to the last nginx ruleset.  	# Don't allow direct access to various internal files. See MDL-69333  	location ~ (/vendor/|/node_modules/|composer\.json|/readme|/README|readme\.txt|/upgrade\.txt|db/install\.xml|/fixtures/|/behat/|phpunit\.xml|\.lock|environment\.xml) {       	deny all;  	    return 404;  	}  }</code></pre><p><strong>保存</strong>文件并关闭。</p><p>在这种情况下，用您想要的文本编辑器打开<strong> /etc/nginx/nginx.conf </strong>文件:</p><pre><code class="language-bash">sudo nano /etc/nginx/nginx.conf</code></pre><p>并在/etc/nginx/conf.d/*之前添加下面一行。conf线路:</p><pre><code class="language-bash">server_names_hash_bucket_size 64;</code></pre><p>记得保存文件。</p><p>您应该验证Nginx配置文件的语法，如下所示:</p><pre><code class="language-bash">sudo nginx -t  nginx: the configuration file /etc/nginx/nginx.conf syntax is ok  nginx: configuration file /etc/nginx/nginx.conf test is successful</code></pre><p>接下来，通过使用以下命令启动Nginx服务来启用新配置:</p><pre><code class="language-bash">sudo systemctl enable nginx --now</code></pre><p><em> <strong>注意:</strong> </em>如果得到“nginx:[emerg]open()"/var/run/Nginx . PID " failed(13:Permission denied)”错误，输入以下命令修复，并再次启动Nginx:</p><pre><code class="language-bash">sudo ausearch -c 'nginx' --raw | audit2allow -M my-nginx  </code></pre><pre><code class="language-bash">sudo semodule -X 300 -i my-nginx.pp</code></pre><p>您应该更改Moodle的web和数据目录的文件安全上下文，如下所示:</p><pre><code class="language-bash">sudo semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/moodle'</code></pre><pre><code class="language-bash">sudo semanage fcontext -a -t httpd_sys_rw_content_t '/var/moodledata'</code></pre><pre><code class="language-bash">sudo restorecon -Rv '/var/www/html/moodle'</code></pre><pre><code class="language-bash">sudo restorecon -Rv '/var/moodledata'</code></pre><p>最后，您需要通过运行以下命令来配置SELinux，以允许来自Moodle的网络连接:</p><pre><code class="language-bash">sudo setsebool -P httpd_can_network_connect on</code></pre><h3><span class="ez-toc-section" id="5-_Accessing_Moodle"/> <strong> 5-访问Moodle </strong> <span class="ez-toc-section-end"/></h3><p>首先，导航到以下URL:</p><pre><code class="language-bash">https://moodle.sample.com</code></pre><p>您应该会看到欢迎屏幕。点击<strong>继续</strong>:</p><p> </p><p><img data-lazyloaded="1" src="../Images/d5df1388632121229e0bfe49347488b0.png" decoding="async" loading="lazy" class="aligncenter wp-image-41810 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/1-Moodle-welcome-page.webp" alt="welcome-page" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/1-Moodle-welcome-page.webp 750w, https://blog.eldernode.com/wp-content/uploads/2022/12/1-Moodle-welcome-page-300x152.webp 300w" data-sizes="(max-width: 750px) 100vw, 750px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/1-Moodle-welcome-page.webp"/></p><p> </p><p>现在安装人员检查系统要求，按<strong>继续</strong>继续:</p><p> </p><p><img data-lazyloaded="1" src="../Images/88a68c500eb4542c1b8db0f60c8b4bc0.png" decoding="async" loading="lazy" class="aligncenter wp-image-41811 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/2-Moodle-system-requirements.webp" alt="system-requirements" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/2-Moodle-system-requirements.webp 603w, https://blog.eldernode.com/wp-content/uploads/2022/12/2-Moodle-system-requirements-241x300.webp 241w" data-sizes="(max-width: 603px) 100vw, 603px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/2-Moodle-system-requirements.webp"/></p><p> </p><p>接下来按<strong>继续</strong>安装文件并设置数据库:</p><p> </p><p><img data-lazyloaded="1" src="../Images/ee5a2575c7715926396c7f37dca0f7fd.png" decoding="async" loading="lazy" class="aligncenter wp-image-41813 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/3-Moodle-install-page.webp" alt="Moodle-install-page" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/3-Moodle-install-page.webp 750w, https://blog.eldernode.com/wp-content/uploads/2022/12/3-Moodle-install-page-300x239.webp 300w" data-sizes="(max-width: 750px) 100vw, 750px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/3-Moodle-install-page.webp"/></p><p> </p><p>在这一步中，您应该创建一个管理员帐户。为此，填写账户详情，完成后，按<strong>更新档案</strong>:</p><p> </p><p><img data-lazyloaded="1" src="../Images/da762235587b04b5c38afdff6a12e17d.png" decoding="async" loading="lazy" class="aligncenter wp-image-41814 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/4-Moodle_admin_account_setup.webp" alt="Moodle_admin_account_setup" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/4-Moodle_admin_account_setup.webp 750w, https://blog.eldernode.com/wp-content/uploads/2022/12/4-Moodle_admin_account_setup-300x196.webp 300w" data-sizes="(max-width: 750px) 100vw, 750px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/4-Moodle_admin_account_setup.webp"/></p><p>***</p><p><img data-lazyloaded="1" src="../Images/ae2661a3319c84907f9b6b78b144ff1d.png" decoding="async" loading="lazy" class="aligncenter wp-image-41816 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Moodle-admin-account-update.webp" alt="Moodle-admin-account-update" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Moodle-admin-account-update.webp 750w, https://blog.eldernode.com/wp-content/uploads/2022/12/5-Moodle-admin-account-update-300x217.webp 300w" data-sizes="(max-width: 750px) 100vw, 750px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/5-Moodle-admin-account-update.webp"/></p><p> </p><p>现在你应该配置Moodle的首页设置了。配置完成后，点击<strong>保存更改</strong>:</p><p> </p><p><img data-lazyloaded="1" src="../Images/34cda78918ce1dbfc8bf36de25ca9064.png" decoding="async" loading="lazy" class="aligncenter wp-image-41817 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/6-Moodle-site-home-settings.webp" alt="Install Moodle on AlmaLinux" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/6-Moodle-site-home-settings.webp 715w, https://blog.eldernode.com/wp-content/uploads/2022/12/6-Moodle-site-home-settings-286x300.webp 286w" data-sizes="(max-width: 715px) 100vw, 715px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/6-Moodle-site-home-settings.webp"/></p><p> </p><p>您将进入Moodle仪表板，要求您向公司注册您的Moodle网站。如果您不想注册，可以点击跳过:</p><p> </p><p><img data-lazyloaded="1" src="../Images/23560627eb0e934249f4664a73df87df.png" decoding="async" loading="lazy" class="aligncenter wp-image-41818 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2022/12/7-Moodle-dashboard.webp" alt="Moodle-dashboard" data-srcset="https://blog.eldernode.com/wp-content/uploads/2022/12/7-Moodle-dashboard.webp 750w, https://blog.eldernode.com/wp-content/uploads/2022/12/7-Moodle-dashboard-300x222.webp 300w" data-sizes="(max-width: 750px) 100vw, 750px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2022/12/7-Moodle-dashboard.webp"/></p><p>就是这样！</p><p><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></p><h2>在本文中，我们向您介绍了Moodle，并教您在AlmaLinux上安装Moodle的5个步骤。我希望这篇教程对你有用，并能帮助你在AlmaLinux上安装Moodle。如果你面临任何问题或有任何疑问，可以在评论区联系我们。</h2><p>In this article, we introduced you to Moodle and taught you 5 steps to install Moodle on AlmaLinux. I hope you found this tutorial useful and that it helps you to install Moodle on your AlmaLinux. You can contact us in the Comments section if you face any problems or have any questions.</p></div></div>    
</body>
</html>