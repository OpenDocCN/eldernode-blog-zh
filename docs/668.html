<html>
<head>
<title>Monitor Network Traffic with vnStat on Centos 7 - Eldernode Blog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>在Centos 7 - Eldernode博客上使用vnStat监控网络流量</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/monitor-network-traffic-with-vnstat-on-centos/#0001-01-01">https://blog.eldernode.com/monitor-network-traffic-with-vnstat-on-centos/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/bb3ff2087c304143df433f140143d954.png" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Monitor Network Traffic with vnStat on Centos 7" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7.png 2069w, https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/Monitor-Network-Traffic-with-vnStat-on-Centos-7.png"/><p>许多服务器管理员需要一个工具来监控下载或上传到服务器的总带宽。服务器管理员可以使用DirectAdmin、cPanel、Plesk、WebSitePanel或Kloxo等控制面板来更好地管理服务器，具体取决于服务器操作系统。在本文中，我们将教您如何在Centos 7 上使用vnStat监控网络流量。需要注意的是，你可以访问<a href="https://eldernode.com/"> Eldernode </a>中的套装来购买一台<strong> <a href="https://eldernode.com/centos-vps/" target="_blank" rel="noopener"> CentOS VPS </a> </strong>服务器。</p><h2><span class="ez-toc-section" id="Tutorial_Monitor_Network_Traffic_with_vnStat_on_CentOS_7"/> <strong>教程在CentOS 7上用vnStat监控网络流量</strong> <span class="ez-toc-section-end"/></h2><p>对<a href="https://eldernode.com/vps/" target="_blank" rel="noopener"> VPS服务器</a>的流量监控是检查服务器性能的重要内容之一。您可以使用vnStat工具来完成这项工作。关注本文，教你如何在<a href="https://blog.eldernode.com/tag/centos/"> CentOS </a> 7上使用vnStat监控网络流量。</p><h3><span class="ez-toc-section" id="vnStat_Features"/> <strong> vnStat特性:</strong> <span class="ez-toc-section-end"/></h3><p>在本节中，我们将介绍14项vnStat功能:</p><p>1-统计数据即使在系统重新启动后仍然可用</p><p>2-同时监控多个网络接口</p><p>3-多种输出选项</p><p>4-按小时、天、月、周或前10天对数据进行排序</p><p>5-生成png图形的输出</p><p>6-配置“月”,以跟进您可能有的不同计费周期</p><p>7-非常轻-消耗很少一部分系统资源</p><p>8-无论产生多少流量，CPU使用率都很低</p><p>9-你不必是根用户就可以使用它</p><p>10-动态选择单位(KB、MB等)</p><p>11-您可以为生成的输出图像添加图例</p><p>12-内容定位和图像背景颜色的可定制选项到<strong> vnStat.cgi </strong>。</p><p>13-将自动检测接口带宽。</p><p>14-使用JSON进行输出</p><h2><span class="ez-toc-section" id="How_to_Install_vnStat_on_CentOS_7_Centos_8"/> <strong>如何在CentOS 7 | Centos 8 </strong> <span class="ez-toc-section-end"/>上安装vnStat</h2><p>一旦您熟悉了vnStat的功能，在这一步中，我们将教您如何在CentOS 7上安装vnStat。安装vnStat后，在下一步中，我们将教您如何使用该工具监控网络流量。请加入我们。安装vnStat的第一步是启用EPEL存储库包。然后，您需要依次执行以下命令:</p><pre><code class="language-bash">yum -y install vnstat</code></pre><pre><code class="language-bash">systemctl start vnstat</code></pre><pre><code class="language-bash">systemctl enable vnstat</code></pre><pre><code class="language-bash">chkconfig vnstat on</code></pre><pre><code class="language-bash">service vnstat status</code></pre><p>重要的一点是，如果在安装程序后，您注意到程序没有更新或没有显示任何输出，您应该按如下方式设置权限:</p><pre><code class="language-bash">chown -R vnstat:vnstat /var/lib/vnstat</code></pre><h3><span class="ez-toc-section" id="How_to_Configure_vnStat_on_CentOS_7"/> <strong>如何在CentOS 7上配置vnStat</strong><span class="ez-toc-section-end"/></h3><p>在本节中，我们将配置vnStat，然后介绍如何创建数据库。请加入我们。第一步是编辑<strong> /etc/vnstat.conf </strong>配置文件:</p><pre><code class="language-bash">vi /etc/sysconfig/vnstat</code></pre><p>示例输出如下所示:</p><pre><code class="language-bash">VNSTAT_OPTIONS="-u -i eth0"</code></pre><p>现在您需要输入以下命令来编辑<strong> /etc/vnstat.conf </strong>:</p><pre><code class="language-bash">vi /etc/vnstat.conf</code></pre><p>将默认接口设置为<strong> eth1 </strong>，如以下命令所示:</p><pre><code class="language-bash">Interface "eth1"</code></pre><p>现在<strong>保存</strong>配置文件并退出。</p><p>要创建一个数据库，首先必须使用chsh命令将vnStat shell设置为<strong> /bin/bash </strong>。然后使用以下命令创建一个数据库:</p><pre><code class="language-bash">chsh -s /bin/bash vnstat</code></pre><pre><code class="language-bash">grep --color vnstat /etc/passwd</code></pre><pre><code class="language-bash">id vnstat</code></pre><p>请注意，这通常是新安装后使用的第一个命令。您可以使用runuser命令为<strong> eth0 </strong>接口创建一个数据库:</p><pre><code class="language-bash">runuser -l vnstat -g vnstat -c '/usr/bin/vnstat -u -i eth0'</code></pre><p>您也可以运行以下命令为<strong> eth1 </strong>接口创建一个数据库:</p><pre><code class="language-bash">runuser -l vnstat -g vnstat -c '/usr/bin/vnstat -u -i eth1'</code></pre><p>使用以下命令确保vnStat用户无法登录:</p><pre><code class="language-bash">chsh -s /sbin/nologin vnstat</code></pre><pre><code class="language-bash">grep --color vnstat /etc/passwd</code></pre><pre><code class="language-bash">id vnstat</code></pre><h3><span class="ez-toc-section" id="How_to_Monitor_Network_Traffic_with_vnStat_on_CentOS_Linux"/> <strong>如何在CentOS Linux上用vnStat监控网络流量</strong> <span class="ez-toc-section-end"/></h3><p>要在引导时启动vnStat服务，请键入以下命令:</p><pre><code class="language-bash">chkconfig vnstat on</code></pre><p>您还可以运行以下命令来分别<strong>启动</strong> / <strong>停止</strong> / <strong>重启</strong>和<strong>控制</strong>VN start服务:</p><pre><code class="language-bash">sudo systemctl start vnstat</code></pre><pre><code class="language-bash">sudo systemctl stop vnstat</code></pre><pre><code class="language-bash">sudo systemctl restart vnstat</code></pre><pre><code class="language-bash">sudo systemctl status vnstat</code></pre><p>如何查看统计数据将如下。语法是:</p><pre><code class="language-bash">vnstat</code></pre><p>您可以在下图中看到示例输出:</p><p> </p><p><img data-lazyloaded="1" src="../Images/3fd47a2359439030a0040c2344d962bc.png" decoding="async" loading="lazy" class="aligncenter wp-image-26821 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-status.png" alt="sample output for traffic status" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-status.png 589w, https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-status-300x132.png 300w" data-sizes="(max-width: 589px) 100vw, 589px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-status.png"/></p><p> </p><p>您可以输入以下命令来查看<strong> eth0统计数据</strong>:</p><pre><code class="language-bash">vnstat -i eth0</code></pre><p>注意，要查看<strong> eth0 </strong>的<strong>每日统计数据</strong>，可以输入以下命令:</p><pre><code class="language-bash">vnstat -i eth0 -d</code></pre><p>您也可以输入以下命令来查看<strong>每小时统计数据</strong>:</p><pre><code class="language-bash">vnstat -i eth0 -h</code></pre><p>要查看<strong>月统计数据</strong>，运行以下命令:</p><pre><code class="language-bash">vnstat -i eth0 -m</code></pre><p>最后，要查看<strong>周统计数据</strong>，运行以下命令:</p><pre><code class="language-bash">vnstat -i eth0 -w</code></pre><p>请注意，您可以使用以下命令来计算流量:</p><pre><code class="language-bash">vnstat -i eth0 -tr</code></pre><p>上述命令的输出如下所示:</p><p> </p><p><img data-lazyloaded="1" src="../Images/2525a9ae17bb5289cb5ecee20d7d87bc.png" decoding="async" loading="lazy" class="aligncenter wp-image-26822 size-full" data-src="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-calculate.png" alt="sample output for traffic calculate" data-srcset="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-calculate.png 463w, https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-calculate-300x78.png 300w" data-sizes="(max-width: 463px) 100vw, 463px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2021/03/sample-output-for-traffic-calculate.png"/></p><p> </p><h2><span class="ez-toc-section" id="Conclusion"/>结论<span class="ez-toc-section-end"/></h2><p>vnStat的一个优点是它很轻便，不会给服务器带来特殊的负载。该软件声称可以计算服务网络上传输的所有流量，无论是web服务器流量还是ICMP数据包的数量。消费者流量也将在每小时、每天和每月的基础上可见。在本文中，我们试图教您如何在CentOS 7上安装vnStat并监控网络流量。</p></div></div>    
</body>
</html>