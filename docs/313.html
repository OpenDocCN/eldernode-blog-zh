<html>
<head>
<title>Tutorial set up SSH Keys on CentOS 8 - generate ssh key on centos 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>教程在centos 8上设置ssh密钥-在CentOS 8上生成SSH密钥</h1>
<blockquote>原文：<a href="https://blog.eldernode.com/set-up-ssh-keys-on-centos-8/#0001-01-01">https://blog.eldernode.com/set-up-ssh-keys-on-centos-8/#0001-01-01</a></blockquote><div><div class="blog-details">                                  <img data-lazyloaded="1" src="../Images/b4b7dac77ebbeeae4003377d18a3e950.png" data-src="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282.png" class="img-fluid mb-3 shadow-sm round-10 wp-post-image" alt="Tutorial set up SSH Keys on CentOS 8" decoding="async" data-srcset="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282.png 2069w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282-300x164.png 300w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282-1024x561.png 1024w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282-768x421.png 768w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282-1536x842.png 1536w, https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282-2048x1122.png 2048w" data-sizes="(max-width: 2069px) 100vw, 2069px" data-original-src="https://blog.eldernode.com/wp-content/uploads/2020/07/IMG_2282.png"/><p>最近，您读到了Linux上的SSH。在本文中，您将熟悉<strong>教程在CentOS 8 </strong>上设置SSH密钥。这是登录服务器的安全方法，建议所有用户使用。<a href="https://en.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener noreferrer"> SSH </a>是一种加密协议，用于管理服务器并与之通信。</p><p> </p><h2><span class="ez-toc-section" id="Tutorial_set_up_SSH_Keys_on_CentOS_8"/> <span>教程在CentOS 8上设置SSH按键</span> <span class="ez-toc-section-end"/></h2><p id="step-1-—-creating-the-rsa-key-pair"><span> <strong>第一步</strong></span>–<strong>创建RSA密钥对</strong></p><pre>ssh-keygen  </pre><p>对于大多数情况来说，ssh-keygen 创建一个2048位的密钥对是足够安全的。输入命令后，您将看到下面的结果。</p><p><span>输出</span></p><pre>Generating public/private rsa key pair.  Enter file in which to save the key (/<span>your_home</span>/.ssh/id_rsa):    </pre><p>将密钥对保存到<span>中。ssh/ </span>子目录在你的主目录下，按<span>回车</span></p><p>通过创建一个生成的SSH密钥对，将显示下面的结果。</p><p title="Output"><span>输出</span></p><pre>Enter passphrase (empty for no passphrase):</pre><p>强烈建议您输入安全密码。为您的钥匙增加一层安全保护。密码可以防止未经授权的用户登录。</p><p>您将看到以下输出:</p><p><span>输出</span></p><pre class="code-pre local-environment">Your identification has been saved in /your_home/.ssh/id_rsa.  Your public key has been saved in /your_home/.ssh/id_rsa.pub.  The key fingerprint is:  a9:49:2e:2a:5e:33:3e:a9:de:4e:77:11:58:b6:90:26 <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e0959385928e818d85a092858d8f9485">[email protected]</a>_host  The key's randomart image is:  +--[ RSA 2048]----+  |     ..o         |  |   E o= .        |  |    o. o         |  |        ..       |  |      ..S        |  |     o o.        |  |   =o.+.         |  |. =++..          |  |o=++.            |  +-----------------+</pre><p>因为您有一个公钥和私钥来进行身份验证，所以您必须将公钥放在您的服务器上，以便能够使用基于SSH密钥的身份验证来登录。</p><p> </p><p><span> <a href="https://eldernode.com/linux-vps/" target="_blank" rel="noopener noreferrer">购买Linux虚拟私有服务器</a> </span></p><p> </p><p id="step-2-—-copying-the-public-key-to-your-centos-server"><strong> <span>第二步</span></strong>–<strong>将公钥复制到您的CentOS服务器</strong></p><p class="code-pre local-environment">如果您想使用最快的方式将您的公钥复制到CentOS主机，请使用名为<span> ssh-copy-id <span>的实用程序。如果您的客户机上没有可用的<span> ssh-copy-id <span>，您需要使用下面两种方法中的一种。</span> </span> </span> </span></p><p> </p><h3 id="copying-your-public-key-using-ssh-copy-id"><span class="ez-toc-section" id="Copying_your_Public_Key_Using_ssh-copy-id"/> <span> <strong>使用</strong> ssh-copy-id </span> <span class="ez-toc-section-end"/>复制您的公钥</h3><p>在大多数操作系统中，默认情况下包含了<span> ssh-copy-id <span>工具。因此它可能在您的本地系统上可用，但是，您需要对您的服务器进行基于密码的SSH访问。</span>T3】</span></p><p>指定要连接的远程主机和您拥有SSH访问密码的用户帐户。将复制您的公共SSH密钥的帐户是:</p><pre><span>ssh-copy-id <span class="highlight">username</span>@<span class="highlight">remote_host</span></span></pre><p>您将看到如下结果:</p><p title="Output"><span>输出</span></p><pre>The authenticity of host '<span>203.0.113.1</span> (<span>203.0.113.1</span>)' can't be established.  ECDSA key fingerprint is fd:fd:d4:f9:77:fe:73:84:e1:55:00:ad:d6:6d:22:fe.  Are you sure you want to continue connecting (yes/no)? <span>yes             </span></pre><p>如果是第一次连接到新主机，本地计算机将无法识别远程主机。键入Yes并按ENTER键继续。</p><p>然后，该工具将扫描您的帐户，查找您已经创建的id_rsa.pub密钥。它会提示您输入远程用户帐户的密码:</p><p title="Output"><span>输出</span></p><pre>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed  /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys  <span>username</span>@<span>203.0.113.1</span>'s password:</pre><p>输入密码并按下<span>键进入</span>。该实用程序将使用您选择的密码连接到远程主机上的帐户。它会复制你的<span> ~/的内容。ssh/id_rsa。pub </span>键进入远程账号的<span> ~/。ssh/authorized_keys <span>文件</span> </span>。</p><p>输出将如下所示:</p><p><span>输出</span></p><div><pre>Number of key(s) added: 1  Now try logging into the machine, with:   "ssh '<span><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fb8e889e89959a969ebbc9cbc8d5cbd5cacac8d5ca">[email protected]</a></span>'"  and check to make sure that only the key(s) you wanted were added.    </pre><h3 id="copying-public-key-using-ssh"><span class="ez-toc-section" id="Copying_Public_Key_Using_SSH"/> <span>使用SSH复制公钥</span> <span class="ez-toc-section-end"/></h3></div><p>如果<span> ssh-copy-id </span>不可用，并且您可以通过基于密码的ssh访问服务器上的帐户，请使用更传统的SSH方法上传您的密钥。</p><p>您可以使用<span> cat </span>命令读取本地计算机上的公共SSH密钥的内容，并通过SSH连接连接到远程服务器。</p><p>你还可以确保<span> ~/。ssh <span>目录存在并且具有正确的权限。</span>T3】</span></p><p>在这个目录中，您通过管道将内容作为<span> authorized_keys <span>传送到一个文件中。你</span> </span>可以看到下面完整的命令。</p><pre>cat ~/.ssh/id_rsa.pub | ssh <span>usernam</span><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c6a386">[email protected]</a><span>remote_host</span> "mkdir -p ~/.ssh &amp;&amp; touch ~/.ssh/authorized_keys &amp;&amp; chmod -R go= ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys"  </pre><p/><p>此外，您可能会看到以下消息。</p><p><span>输出</span></p><p>如果您的本地计算机无法识别远程主机，您将会看到此消息。所以你需要输入<span> yes </span>然后按<span>回车</span>继续。</p><div><pre class="code-pre local-environment">The authenticity of host '<span>203.0.113.1</span> (<span>203.0.113.1</span>)' can't be established.  ECDSA key fingerprint is fd:fd:d4:f9:77:fe:73:84:e1:55:00:ad:d6:6d:22:fe.  Are you sure you want to continue connecting (yes/no)? <span>yes</span></pre></div><p>然后，会要求您输入远程用户帐户密码:</p><p><span>输出</span></p><p><span class="ez-toc-section" id="Copying_Public_Key_Manually"/> <span>手动复制公钥</span> <span class="ez-toc-section-end"/></p><p>如果对服务器的基于密码的SSH访问不可用，您需要手动完成上述过程。</p><div><p title="Output">追加您的<span> id-rsa-的内容。pub </span>文件到<span> ~/。ssh/authorized_keys <span>文件。</span> </span></p><pre class="code-pre local-environment"><span>username</span>@<span>203.0.113.1</span>'s password:    </pre><h3 id="copying-public-key-manually">如果你想显示你的身份。pub，把这个输入你的本地计算机:</h3></div><p>猫~/。ssh/id_rsa.pub</p><p>如下所示，您将看到密钥的内容。</p><p><span>输出</span></p><pre/><p>使用您可用的方法登录并访问您在远程服务器上的帐户后，检查该目录是否存在。因此，如果它不存在，输入下面的命令来创建目录。</p><p>然后，在该目录下创建或修改<span>authorized _ key</span>文件。</p><pre/><p title="Output">用来自<span> cat ~/的输出替换<span>公共密钥字符串</span>。ssh/id_rsa.pub <span>命令。从</span> ssh-rsa AAAA开始…</span></p><pre>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCqql6MzstZYh1TmWWv11q5O3pISj2ZFl9HgH1JLknLLx44+tXfJ7mIrKNxOOwxIxvcBF8PXSYvobFYEZjGIVCEAjrUzLiIxbyCoxVyle7Q+bqgZ8SeeM8wzytsY+dVGcBxF6N4JS+zVk5eMcV385gG3Y6ON3EG112n6d+SMXY0OEBIcO6x+PnUSGHrSgpBgX7Ks1r7xqFa7heJLLt2wWwkARptX7udSq05paBhcpB0pHtA1Rfz3K2B+ZVIpSDfki9UVKzT8JUmwW6NNzSgxUfQHGwnW7kj4jp4AT0VZk3ADw497M2G/12N0PPB5CnhHf7ovgy6nL1ikrygTKRFmNZISvAcywB9GVqNAVE+ZHDSCuURNsAInVzgYo9xgJDW8wUw2o8U77+xiFxgI5QSZX3Iq7YLMgeksaO4rBJEa54k8m5wEiEE1nUhLuJ0X/vh2xPff6SQ1BL/zkOhvJCACK6Vb15mDOeCSq54Cr7kvS46itMosi/uS66+PujOO+xt/2FWYepz6ZlN70bRly57Q06J+ZJoc9FfBCbCyYH7U/ASsmY095ywPsBo1XQ9PqhnN1/YOorJ068foQDNVpm146mUpILVxmq41Cj55YKHEazXGsdBIbXWhcrRf4G2fJLRcGUr9q8/lERo9oxRm5JFX6TCmj6kmiFqv+Ow9gI0x8GvaQ== <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="37595858535e775f584443">[email protected]</a>    </pre><p>最后，确保<span> ~/。ssh </span>目录和<span> authorized_keys </span>文件有适当的权限设置:</p><pre>mkdir -p ~/.ssh</pre><p>为了使用root帐户，请查看<span> ~/。ssh </span>目录属于用户，不属于<span>根目录</span>:</p><pre>echo <span class="highlight">public_key_string</span> &gt;&gt; ~/.ssh/authorized_keys</pre><p>您的用户名是<span> noodi </span>，您应该将适当的用户名替换到上面的命令中。现在，您可以使用CentOS服务器尝试基于密钥的身份验证。</p><p> </p><pre>chmod -R go= ~/.ssh</pre><p><span> <strong>第三步</strong></span>–<strong>使用SSH键登录CentOS服务器</strong></p><pre>chown -R <span class="highlight">noodi</span>:<span class="highlight">noodi</span> ~/.ssh</pre><p>成功处理后，您现在应该能够登录到远程主机，而无需远程帐户的密码。</p><p>在第一次连接到该主机的情况下，您可能会看到如下内容:</p><p id="step-3-—-logging-in-to-your-centos-server-using-ssh-keys"><span>输出</span></p><p><span> <strong>第四步</strong></span>–<strong>在你的服务器上禁用密码认证</strong></p><pre>ssh <span>username</span>@<span>remote</span>_host  </pre><p>当您确认您的远程帐户拥有管理权限时，您将能够使用SSH密钥(作为<strong> root </strong>或拥有<span> sudo </span>权限的帐户)登录您的远程服务器。</p><p title="Output">现在您可以搜索名为<span> PasswordAuthentication <span>的指令。要放置<span> vi </span>，按下<span> i </span>，取消对该行的注释，并将值设置为</span> no <span>。因此，使用帐户密码通过SSH登录将被禁用。</span>T9】</span></p><pre>The authenticity of host '<span>203.0.113.1</span> (<span>203.0.113.1</span>)' can't be established.  ECDSA key fingerprint is fd:fd:d4:f9:77:fe:73:84:e1:55:00:ad:d6:6d:22:fe.  Are you sure you want to continue connecting (yes/no)? <span>yes</span></pre><p id="step-4-—-disabling-password-authentication-on-your-server"> </p><p> </p><pre>sudo vi /etc/ssh/sshd_config</pre><p>完成所有更改后，按<span> ESC </span>，然后按<span> :wq </span>。要实现这些更改，请重启<span> sshd </span>服务:</p><p>在关闭当前会话之前，测试SSH服务的功能是否正确。</p><pre>...  PasswordAuthentication no  ...</pre><p>当SSH服务正常工作时，您可以关闭所有服务器会话。现在，CentOS服务器上的SSH守护程序会响应SSH密钥。</p><p> </p><pre/><pre>sudo <span>systemctl</span> restart <span>sshd  </span></pre><p>亲爱的用户，我们希望这篇教程能对你有所帮助，如果你有任何问题或想查看我们的用户关于这篇文章的对话，请访问<a href="https://eldernode.com/ask" target="_blank" rel="noopener noreferrer">提问页面</a>。也为了提高你的知识，有这么多有用的教程为<a href="https://eldernode.com/blog/">老年节点培训</a>准备。</p><pre>ssh <span class="highlight">username</span>@<span class="highlight">remote_host</span></pre><p> </p><p> </p><p><span class="ez-toc-section" id="Do_not_miss"/> <span> <strong>不要错过</strong> </span> <span class="ez-toc-section-end"/></p><p><span> <a href="https://eldernode.com/initial-set-up-centos-8/" target="_blank" rel="noopener noreferrer">初始设置centos 8 </a> </span></p><p> </p><h5><span class="ez-toc-section" id="Do_not_miss"/><span><strong>Do not miss</strong></span><span class="ez-toc-section-end"/></h5><p class="fjpost-title px-0"><span><a href="https://eldernode.com/initial-set-up-centos-8/" target="_blank" rel="noopener noreferrer">initial set up centos 8</a></span></p><pre class="code-pre local-environment"><code/></pre></div></div>    
</body>
</html>